import{h as $}from"./chunk-KEANVB3E.js";import{i as E,j as m}from"./chunk-MF7YEODA.js";E();m();E();m();var O=new Map;function k(n,...a){let u=JSON.stringify(n.raw),e=O.get(u);e==null&&(e=P(n.raw),O.set(u,e));let{element:l,targets:h}=e;for(let p=0;p<a.length;p++){let t=a[p],s=h[p];if(s){if(s.type==="error")throw new SyntaxError(s.message.replace("${}",_(t)));s.value=t}}return I(l)}var M=k,v=/((?:\r|\n|\r\n)\s*)|(<!--[\S\s]*?(?:-->|$))|(<\s*(\/{0,2})\s*([-_$\w]*))/g,b=/\s*(?:(\/?\s*>)|(\.\.\.\s*)|(?:([-_$\w]+)\s*(=)?\s*(?:("(\\"|[\S\s])*?(?:"|$)|'(?:\\'|[\S\s])*?(?:'|$)))?))/g,R=/>/g,S=/[^\\]?'/g,C=/[^\\]?"/g,U=/-->/g;function P(n){let a=v,u=[],e={type:"element",open:{type:"tag",slash:"",value:""},close:null,props:[],children:[]},l=[],h=!0;for(let p=0;p<n.length;p++){let t=n[p],s=p<n.length-1,g=null;for(let r=0,c=r;r<t.length;r=c){a.lastIndex=r;let i=a.exec(t);switch(c=i?i.index+i[0].length:t.length,a){case v:{if(i){let[,f,d,y,w,x]=i;if(r<i.index){let o=t.slice(r,i.index);h&&(o=o.replace(/^\s*/,"")),f&&(t[Math.max(0,i.index-1)]==="\\"?o=o.slice(0,-1):o=o.replace(/\s*$/,"")),o&&e.children.push({type:"value",value:o})}if(h=!!f,d)c===t.length&&(a=U);else if(y)if(w)if(e.close={type:"tag",slash:w,value:x},u.length)c===t.length&&(g=e.close),e=u.pop(),a=R;else{if(c!==t.length)throw new SyntaxError(`Unmatched closing tag "${x}"`);g={type:"error",message:"Unmatched closing tag ${}",value:null}}else{let o={type:"element",open:{type:"tag",slash:"",value:x},close:null,props:[],children:[]};e.children.push(o),u.push(e),e=o,a=b,c===t.length&&(g=e.open)}}else if(r<t.length){let f=t.slice(r);s||(f=f.replace(/\s*$/,"")),f&&e.children.push({type:"value",value:f})}break}case b:{if(i){let[,f,d,y,w,x]=i;if(r<i.index)throw new SyntaxError(`Unexpected text \`${t.slice(r,i.index).trim()}\``);if(f)f[0]==="/"&&(e=u.pop()),a=v;else if(d){let o={type:"value",value:null};if(e.props.push(o),g=o,!(s&&c===t.length))throw new SyntaxError('Expression expected after "..."')}else if(y){let o;if(x==null)if(!w)o={type:"value",value:!0};else{if(c<t.length)throw new SyntaxError(`Unexpected text \`${t.slice(c,c+20)}\``);if(o={type:"value",value:null},g=o,!(s&&c===t.length))throw new SyntaxError(`Expression expected for prop "${y}"`)}else{let L=x[0];o={type:"propString",parts:[]},o.parts.push(x),c===t.length&&(a=L==="'"?S:C)}let N={type:"prop",name:y,value:o};e.props.push(N)}}else if(!s)throw r===t.length?new SyntaxError("Expected props but reached end of document"):new SyntaxError(`Unexpected text \`${t.slice(r,r+20).trim()}\``);break}case R:{if(i){if(r<i.index)throw new SyntaxError(`Unexpected text \`${t.slice(r,i.index).trim()}\``);a=v}else if(!s)throw new SyntaxError(`Unexpected text \`${t.slice(r,r+20).trim()}\``);break}case S:case C:{let f=t.slice(r,c);if(e.props[e.props.length-1].value.parts.push(f),i)a=b;else if(!s)throw new SyntaxError(`Missing \`${a===S?"'":'"'}\``);break}case U:{if(i)a=v;else if(!s)throw new SyntaxError("Expected `-->` but reached end of template");break}}}if(s){if(g){if(l.push(g),g.type==="error")break;continue}switch(a){case v:{let r={type:"value",value:null};e.children.push(r),l.push(r);break}case S:case C:{let r=e.props[e.props.length-1],c={type:"value",value:null};r.value.parts.push(c),l.push(c);break}case U:l.push(null);break;default:throw new SyntaxError("Unexpected expression")}}else if(g)throw new SyntaxError("Expression expected");h=!1}if(u.length){let p=l.indexOf(e.open);if(p===-1)throw new SyntaxError(`Unmatched opening tag "${e.open.value}"`);l[p]={type:"error",message:"Unmatched opening tag ${}",value:null}}return e.children.length===1&&e.children[0].type==="element"&&(e=e.children[0]),{element:e,targets:l}}function I(n){if(n.close!==null&&n.close.slash!=="//"&&n.open.value!==n.close.value)throw new SyntaxError(`Unmatched closing tag ${_(n.close.value)}, expected ${_(n.open.value)}`);let a=[];for(let e=0;e<n.children.length;e++){let l=n.children[e];a.push(l.type==="element"?I(l):l.value)}let u=n.props.length?{}:null;for(let e=0;e<n.props.length;e++){let l=n.props[e];if(l.type==="prop"){let h;if(l.value.type==="value")h=l.value.value;else{let p="";for(let t=0;t<l.value.parts.length;t++){let s=l.value.parts[t];typeof s=="string"?p+=s:typeof s.value!="boolean"&&s.value!=null&&(p+=typeof s.value=="string"?s.value:String(s.value))}h=p.slice(1,-1).replace(/\\x[0-9a-f]{2}|\\u[0-9a-f]{4}|\\u\{[0-9a-f]+\}|\\./gi,t=>{switch(t[1]){case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";case"v":return"\v";case"x":return String.fromCharCode(parseInt(t.slice(2),16));case"u":return t[2]==="{"?String.fromCodePoint(parseInt(t.slice(3,-1),16)):String.fromCharCode(parseInt(t.slice(2),16));case"0":return"\0";default:return t.slice(1)}})}u[l.name]=h}else u={...u,...l.value}}return $(n.open.value,u,...a)}function _(n){return typeof n=="function"?n.name+"()":typeof n=="string"?`"${n}"`:JSON.stringify(n)}export{k as a,M as b};
