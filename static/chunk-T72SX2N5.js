import{b as O,h as k,j as R,l as I,m as L}from"./chunk-3YAZV633.js";import{h as d,i as v}from"./chunk-Z4NPT5MU.js";d();v();d();v();var j=new Map;function G(t,...r){let s=JSON.stringify(t.raw),e=j.get(s);e==null&&(e=B(t.raw),j.set(s,e));let{element:l,targets:p}=e;for(let c=0;c<r.length;c++){let n=r[c],i=p[c];if(i){if(i.type==="error")throw new SyntaxError(i.message.replace("${}",U(n)));i.value=n}}return P(l)}var F=G,w=/((?:\r|\n|\r\n)\s*)|(<!--[\S\s]*?(?:-->|$))|(<\s*(\/{0,2})\s*([-_$\w]*))/g,_=/\s*(?:(\/?\s*>)|(\.\.\.\s*)|(?:([-_$\w]+)\s*(=)?\s*(?:("(\\"|[\S\s])*?(?:"|$)|'(?:\\'|[\S\s])*?(?:'|$)))?))/g,M=/>/g,E=/[^\\]?'/g,C=/[^\\]?"/g,T=/-->/g;function B(t){let r=w,s=[],e={type:"element",open:{type:"tag",slash:"",value:""},close:null,props:[],children:[]},l=[],p=!0;for(let c=0;c<t.length;c++){let n=t[c],i=c<t.length-1,g=null;for(let o=0,f=o;o<n.length;o=f){r.lastIndex=o;let u=r.exec(n);switch(f=u?u.index+u[0].length:n.length,r){case w:{if(u){let[,h,S,m,$,x]=u;if(o<u.index){let a=n.slice(o,u.index);p&&(a=a.replace(/^\s*/,"")),h&&(n[Math.max(0,u.index-1)]==="\\"?a=a.slice(0,-1):a=a.replace(/\s*$/,"")),a&&e.children.push({type:"value",value:a})}if(p=!!h,S)f===n.length&&(r=T);else if(m)if($)if(e.close={type:"tag",slash:$,value:x},s.length)f===n.length&&(g=e.close),e=s.pop(),r=M;else{if(f!==n.length)throw new SyntaxError(`Unmatched closing tag "${x}"`);g={type:"error",message:"Unmatched closing tag ${}",value:null}}else{let a={type:"element",open:{type:"tag",slash:"",value:x},close:null,props:[],children:[]};e.children.push(a),s.push(e),e=a,r=_,f===n.length&&(g=e.open)}}else if(o<n.length){let h=n.slice(o);i||(h=h.replace(/\s*$/,"")),h&&e.children.push({type:"value",value:h})}break}case _:{if(u){let[,h,S,m,$,x]=u;if(o<u.index)throw new SyntaxError(`Unexpected text \`${n.slice(o,u.index).trim()}\``);if(h)h[0]==="/"&&(e=s.pop()),r=w;else if(S){let a={type:"value",value:null};if(e.props.push(a),g=a,!(i&&f===n.length))throw new SyntaxError('Expression expected after "..."')}else if(m){let a;if(x==null)if(!$)a={type:"value",value:!0};else{if(f<n.length)throw new SyntaxError(`Unexpected text \`${n.slice(f,f+20)}\``);if(a={type:"value",value:null},g=a,!(i&&f===n.length))throw new SyntaxError(`Expression expected for prop "${m}"`)}else{let D=x[0];a={type:"propString",parts:[]},a.parts.push(x),f===n.length&&(r=D==="'"?E:C)}let q={type:"prop",name:m,value:a};e.props.push(q)}}else if(!i)throw o===n.length?new SyntaxError("Expected props but reached end of document"):new SyntaxError(`Unexpected text \`${n.slice(o,o+20).trim()}\``);break}case M:{if(u){if(o<u.index)throw new SyntaxError(`Unexpected text \`${n.slice(o,u.index).trim()}\``);r=w}else if(!i)throw new SyntaxError(`Unexpected text \`${n.slice(o,o+20).trim()}\``);break}case E:case C:{let h=n.slice(o,f);if(e.props[e.props.length-1].value.parts.push(h),u)r=_;else if(!i)throw new SyntaxError(`Missing \`${r===E?"'":'"'}\``);break}case T:{if(u)r=w;else if(!i)throw new SyntaxError("Expected `-->` but reached end of template");break}}}if(i){if(g){if(l.push(g),g.type==="error")break;continue}switch(r){case w:{let o={type:"value",value:null};e.children.push(o),l.push(o);break}case E:case C:{let o=e.props[e.props.length-1],f={type:"value",value:null};o.value.parts.push(f),l.push(f);break}case T:l.push(null);break;default:throw new SyntaxError("Unexpected expression")}}else if(g)throw new SyntaxError("Expression expected");p=!1}if(s.length){let c=l.indexOf(e.open);if(c===-1)throw new SyntaxError(`Unmatched opening tag "${e.open.value}"`);l[c]={type:"error",message:"Unmatched opening tag ${}",value:null}}return e.children.length===1&&e.children[0].type==="element"&&(e=e.children[0]),{element:e,targets:l}}function P(t){if(t.close!==null&&t.close.slash!=="//"&&t.open.value!==t.close.value)throw new SyntaxError(`Unmatched closing tag ${U(t.close.value)}, expected ${U(t.open.value)}`);let r=[];for(let e=0;e<t.children.length;e++){let l=t.children[e];r.push(l.type==="element"?P(l):l.value)}let s=t.props.length?{}:null;for(let e=0;e<t.props.length;e++){let l=t.props[e];if(l.type==="prop"){let p;if(l.value.type==="value")p=l.value.value;else{let c="";for(let n=0;n<l.value.parts.length;n++){let i=l.value.parts[n];typeof i=="string"?c+=i:typeof i.value!="boolean"&&i.value!=null&&(c+=typeof i.value=="string"?i.value:String(i.value))}p=c.slice(1,-1).replace(/\\x[0-9a-f]{2}|\\u[0-9a-f]{4}|\\u\{[0-9a-f]+\}|\\./gi,n=>{switch(n[1]){case"b":return"\b";case"f":return"\f";case"n":return`
`;case"r":return"\r";case"t":return"	";case"v":return"\v";case"x":return String.fromCharCode(parseInt(n.slice(2),16));case"u":return n[2]==="{"?String.fromCodePoint(parseInt(n.slice(3,-1),16)):String.fromCharCode(parseInt(n.slice(2),16));case"0":return"\0";default:return n.slice(1)}})}s[l.name]=p}else s={...s,...l.value}}return k(t.open.value,s,...r)}function U(t){return typeof t=="function"?t.name+"()":typeof t=="string"?`"${t}"`:JSON.stringify(t)}d();v();var J=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]);function y(t){return t.replace(/[&<>"']/g,r=>{switch(r){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#039;";default:return""}})}function K(t){let r=[];for(let[s,e]of Object.entries(t))if(e!=null){let l=I(s),p=L(l,e);r.push(`${l}:${p};`)}return r.join("")}function Q(t){let r=[];for(let[s,e]of Object.entries(t))if(!(s==="innerHTML"||s==="dangerouslySetInnerHTML"||s.startsWith("prop:")))if(s==="htmlFor"){if("for"in t||typeof e!="string")continue;r.push(`for="${y(e)}"`)}else if(s==="style")typeof e=="string"?r.push(`style="${y(e)}"`):typeof e=="object"&&e!==null&&r.push(`style="${y(K(e))}"`);else if(s==="className"){if("class"in t||typeof e!="string")continue;r.push(`class="${y(e)}"`)}else if(s==="class"){if(typeof e=="string")r.push(`class="${y(e)}"`);else if(typeof e=="object"&&e!==null){let l=Object.keys(e).filter(p=>e[p]).join(" ");l&&r.push(`class="${y(l)}"`)}}else s.startsWith("attr:")&&(s=s.slice(5)),typeof e=="string"?r.push(`${y(s)}="${y(e)}"`):typeof e=="number"?r.push(`${y(s)}="${e}"`):e===!0&&r.push(`${y(s)}`);return r.join(" ")}function A(t){let r="";for(let s=0;s<t.length;s++){let e=t[s];r+=typeof e=="string"?e:e.value}return r}var V={create(){return{value:""}},text({value:t}){return{value:y(t)}},read(t){return Array.isArray(t)?A(t):typeof t>"u"?"":typeof t=="string"?t:t.value||""},arrange({tag:t,tagName:r,node:s,props:e,children:l}){var i;if(t===O)return;if(typeof t!="string")throw new Error(`Unknown tag: ${r}`);let p=Q(e),c=`<${t}${p.length?" ":""}${p}>`,n;if(J.has(t))n=c;else{let g=`</${t}>`,o="innerHTML"in e?e.innerHTML:"dangerouslySetInnerHTML"in e?((i=e.dangerouslySetInnerHTML)==null?void 0:i.__html)??"":A(l);n=`${c}${o}${g}`}s.value=n}},b=class extends R{constructor(){super(V)}},W=new b;export{G as a,F as b,b as c,W as d};
