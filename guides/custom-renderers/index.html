<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Crank.js | Custom Renderers</title><link rel="shortcut icon" href="/static/favicon.ico"><style>.css-1l1hcps{position:fixed;top:0;left:0;right:0;height:50px;z-index:999;gap:1em;}.css-1n0j5y9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:1em;}.css-1xmwt0h{border-bottom:1px solid var(--text-color);overflow-x:auto;background-color:inherit;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;gap:1em;}.css-1xmwt0h a{-webkit-text-decoration:none;text-decoration:none;font-weight:bold;}@media screen and (min-width: 800px){.css-1xmwt0h{padding:0 2em;}}.css-1m42aok{overflow-x:auto;max-width:100%;}.css-artqa7{position:relative;min-height:100%;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-84ojsb{display:contents;}.css-1ashatc{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;word-break:break-all;overflow-wrap:anywhere;line-break:anywhere;white-space:pre-wrap;white-space:break-spaces;font-size:16px;}.css-1flouoi{border-bottom:1px dotted #333;}.color-scheme-light .css-1flouoi{border-bottom:1px dotted #ddd;}.css-w1ljn4{margin:10px 0;}.css-1l0nd7p{-webkit-text-decoration:none;text-decoration:none;}.css-1wkb9s8{background-color:var(--bg-color);margin-top:50px;padding:2rem 0.4rem;color:var(--text-color);border-right:1px solid currentcolor;border-bottom:1px solid currentcolor;}@media screen and (min-width: 800px){.css-1wkb9s8{position:fixed;top:50px;bottom:0;overflow-x:hidden;overflow-y:auto;width:15rem;margin:0;padding:2rem 1rem;text-align:right;}}@media screen and (min-width: 1100px){.css-1wkb9s8{padding:3rem 2rem;width:20rem;}}.css-1wkb9s8 &gt;:first-child{margin-top:0;}.css-ep9szm{color:var(--highlight-color);margin-top:0;}.css-1mkiuoh{margin:0 auto;padding:2rem 0.4rem;}@media screen and (min-width: 800px){.css-1mkiuoh{margin-left:240px;padding:2rem 1rem;margin-top:50px;}}@media screen and (min-width: 1100px){.css-1mkiuoh{margin-left:20rem;padding:3rem 2rem;}}.css-1mkiuoh p{max-width:800px;}.css-1vm8pxc{max-width:min(100%, 1000px);}.css-1s1lac9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;font-size:16px;}@media (min-width: 1300px){.css-1s1lac9{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-18sfz2f{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;width:100%;border:1px solid var(--text-color);margin-top:-1px;margin-right:-1px;}</style><link href="/static/client-HDSPLS5O.css" rel="stylesheet" type="text/css"><meta property="og:title" content="Crank.js | Custom Renderers"><meta property="og:url" content="https:/crank.js.org/guides/custom-renderers"><meta property="og:description" content=""></head><body><script>
	(() => {
		const colorScheme = sessionStorage.getItem("color-scheme") ||
			(window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches
				? "dark" : "light"
			);
		if (colorScheme === "dark") {
			document.body.classList.remove("color-scheme-light");
		} else {
			document.body.classList.add("color-scheme-light");
		}
	})()</script><div id="navbar-root"><nav class="
				blur-background
				css-1l1hcps
				css-1xmwt0h
			"><div class="css-1n0j5y9"><div><a class="css-1n0j5y9" style="gap: 0.3em" href="/"><svg style="flex: none;" fill="none" viewBox="-200 -200 400 400" width="1.9em" height="1.9em" xmlns="http://www.w3.org/2000/svg"><defs><mask id="wedge-mask"><rect x="-200" y="-200" width="400" height="400" fill="white"></rect><path stroke="none" fill="black" d="
							M 0 0
							L 245.74561328669753 172.07293090531383
							L 245.74561328669753 -172.07293090531383
							z
						"></path></mask></defs><g stroke="none" fill="var(--highlight-color)"><path transform="rotate(0)" d="M 149.39 -16.97 M 149.62 -16.98 M 150.29 -17 M 151.42 -16.97 M 153 -16.85 M 155.02 -16.57 M 157.46 -16.1 M 160.32 -15.39 M 163.56 -14.39 M 167.17 -13.06 M 171.11 -11.35 M 175.36 -9.23 M 179.88 -6.66 M 179.88 6.66 M 175.36 9.23 M 171.11 11.35 M 167.17 13.06 M 163.56 14.39 M 160.32 15.39 M 157.46 16.1 M 155.02 16.57 M 153 16.85 M 151.42 16.97 M 150.29 17 M 149.62 16.98 M 149.39 16.97 A 8 8 0 0 0 144.51 41.5 L 144.73 41.57 L 145.36 41.81 L 146.39 42.27 L 147.8 42.99 L 149.56 44.01 L 151.64 45.38 L 154 47.13 L 156.62 49.29 L 159.44 51.9 L 162.43 54.99 L 165.54 58.58 L 168.73 62.69 L 163.64 74.98 L 158.48 75.64 L 153.74 75.97 L 149.44 76.04 L 145.6 75.89 L 142.22 75.57 L 139.31 75.14 L 136.88 74.63 L 134.91 74.11 L 133.4 73.63 L 132.35 73.22 L 131.73 72.95 L 131.53 72.84 A 8 8 0 0 0 117.63 93.64 L 117.8 93.79 L 118.3 94.25 L 119.07 95.07 L 120.1 96.28 L 121.33 97.9 L 122.73 99.96 L 124.24 102.48 L 125.83 105.48 L 127.44 108.97 L 129.02 112.96 L 130.52 117.47 L 131.9 122.49 L 122.49 131.9 L 117.47 130.52 L 112.96 129.02 L 108.97 127.44 L 105.48 125.83 L 102.48 124.24 L 99.96 122.73 L 97.9 121.33 L 96.28 120.1 L 95.07 119.07 L 94.25 118.3 L 93.79 117.8 L 93.64 117.63 A 8 8 0 0 0 72.84 131.53 L 72.95 131.73 L 73.22 132.35 L 73.63 133.4 L 74.11 134.91 L 74.63 136.88 L 75.14 139.31 L 75.57 142.22 L 75.89 145.6 L 76.04 149.44 L 75.97 153.74 L 75.64 158.48 L 74.98 163.64 L 62.69 168.73 L 58.58 165.54 L 54.99 162.43 L 51.9 159.44 L 49.29 156.62 L 47.13 154 L 45.38 151.64 L 44.01 149.56 L 42.99 147.8 L 42.27 146.39 L 41.81 145.36 L 41.57 144.73 L 41.5 144.51 A 8 8 0 0 0 16.97 149.39 L 16.98 149.62 L 17 150.29 L 16.97 151.42 L 16.85 153 L 16.57 155.02 L 16.1 157.46 L 15.39 160.32 L 14.39 163.56 L 13.06 167.17 L 11.35 171.11 L 9.23 175.36 L 6.66 179.88 L -6.66 179.88 L -9.23 175.36 L -11.35 171.11 L -13.06 167.17 L -14.39 163.56 L -15.39 160.32 L -16.1 157.46 L -16.57 155.02 L -16.85 153 L -16.97 151.42 L -17 150.29 L -16.98 149.62 L -16.97 149.39 A 8 8 0 0 0 -41.5 144.51 L -41.57 144.73 L -41.81 145.36 L -42.27 146.39 L -42.99 147.8 L -44.01 149.56 L -45.38 151.64 L -47.13 154 L -49.29 156.62 L -51.9 159.44 L -54.99 162.43 L -58.58 165.54 L -62.69 168.73 L -74.98 163.64 L -75.64 158.48 L -75.97 153.74 L -76.04 149.44 L -75.89 145.6 L -75.57 142.22 L -75.14 139.31 L -74.63 136.88 L -74.11 134.91 L -73.63 133.4 L -73.22 132.35 L -72.95 131.73 L -72.84 131.53 A 8 8 0 0 0 -93.64 117.63 L -93.79 117.8 L -94.25 118.3 L -95.07 119.07 L -96.28 120.1 L -97.9 121.33 L -99.96 122.73 L -102.48 124.24 L -105.48 125.83 L -108.97 127.44 L -112.96 129.02 L -117.47 130.52 L -122.49 131.9 L -131.9 122.49 L -130.52 117.47 L -129.02 112.96 L -127.44 108.97 L -125.83 105.48 L -124.24 102.48 L -122.73 99.96 L -121.33 97.9 L -120.1 96.28 L -119.07 95.07 L -118.3 94.25 L -117.8 93.79 L -117.63 93.64 A 8 8 0 0 0 -131.53 72.84 L -131.73 72.95 L -132.35 73.22 L -133.4 73.63 L -134.91 74.11 L -136.88 74.63 L -139.31 75.14 L -142.22 75.57 L -145.6 75.89 L -149.44 76.04 L -153.74 75.97 L -158.48 75.64 L -163.64 74.98 L -168.73 62.69 L -165.54 58.58 L -162.43 54.99 L -159.44 51.9 L -156.62 49.29 L -154 47.13 L -151.64 45.38 L -149.56 44.01 L -147.8 42.99 L -146.39 42.27 L -145.36 41.81 L -144.73 41.57 L -144.51 41.5 A 8 8 0 0 0 -149.39 16.97 L -149.62 16.98 L -150.29 17 L -151.42 16.97 L -153 16.85 L -155.02 16.57 L -157.46 16.1 L -160.32 15.39 L -163.56 14.39 L -167.17 13.06 L -171.11 11.35 L -175.36 9.23 L -179.88 6.66 L -179.88 -6.66 L -175.36 -9.23 L -171.11 -11.35 L -167.17 -13.06 L -163.56 -14.39 L -160.32 -15.39 L -157.46 -16.1 L -155.02 -16.57 L -153 -16.85 L -151.42 -16.97 L -150.29 -17 L -149.62 -16.98 L -149.39 -16.97 A 8 8 0 0 0 -144.51 -41.5 L -144.73 -41.57 L -145.36 -41.81 L -146.39 -42.27 L -147.8 -42.99 L -149.56 -44.01 L -151.64 -45.38 L -154 -47.13 L -156.62 -49.29 L -159.44 -51.9 L -162.43 -54.99 L -165.54 -58.58 L -168.73 -62.69 L -163.64 -74.98 L -158.48 -75.64 L -153.74 -75.97 L -149.44 -76.04 L -145.6 -75.89 L -142.22 -75.57 L -139.31 -75.14 L -136.88 -74.63 L -134.91 -74.11 L -133.4 -73.63 L -132.35 -73.22 L -131.73 -72.95 L -131.53 -72.84 A 8 8 0 0 0 -117.63 -93.64 L -117.8 -93.79 L -118.3 -94.25 L -119.07 -95.07 L -120.1 -96.28 L -121.33 -97.9 L -122.73 -99.96 L -124.24 -102.48 L -125.83 -105.48 L -127.44 -108.97 L -129.02 -112.96 L -130.52 -117.47 L -131.9 -122.49 L -122.49 -131.9 L -117.47 -130.52 L -112.96 -129.02 L -108.97 -127.44 L -105.48 -125.83 L -102.48 -124.24 L -99.96 -122.73 L -97.9 -121.33 L -96.28 -120.1 L -95.07 -119.07 L -94.25 -118.3 L -93.79 -117.8 L -93.64 -117.63 A 8 8 0 0 0 -72.84 -131.53 L -72.95 -131.73 L -73.22 -132.35 L -73.63 -133.4 L -74.11 -134.91 L -74.63 -136.88 L -75.14 -139.31 L -75.57 -142.22 L -75.89 -145.6 L -76.04 -149.44 L -75.97 -153.74 L -75.64 -158.48 L -74.98 -163.64 L -62.69 -168.73 L -58.58 -165.54 L -54.99 -162.43 L -51.9 -159.44 L -49.29 -156.62 L -47.13 -154 L -45.38 -151.64 L -44.01 -149.56 L -42.99 -147.8 L -42.27 -146.39 L -41.81 -145.36 L -41.57 -144.73 L -41.5 -144.51 A 8 8 0 0 0 -16.97 -149.39 L -16.98 -149.62 L -17 -150.29 L -16.97 -151.42 L -16.85 -153 L -16.57 -155.02 L -16.1 -157.46 L -15.39 -160.32 L -14.39 -163.56 L -13.06 -167.17 L -11.35 -171.11 L -9.23 -175.36 L -6.66 -179.88 L 6.66 -179.88 L 9.23 -175.36 L 11.35 -171.11 L 13.06 -167.17 L 14.39 -163.56 L 15.39 -160.32 L 16.1 -157.46 L 16.57 -155.02 L 16.85 -153 L 16.97 -151.42 L 17 -150.29 L 16.98 -149.62 L 16.97 -149.39 A 8 8 0 0 0 41.5 -144.51 L 41.57 -144.73 L 41.81 -145.36 L 42.27 -146.39 L 42.99 -147.8 L 44.01 -149.56 L 45.38 -151.64 L 47.13 -154 L 49.29 -156.62 L 51.9 -159.44 L 54.99 -162.43 L 58.58 -165.54 L 62.69 -168.73 L 74.98 -163.64 L 75.64 -158.48 L 75.97 -153.74 L 76.04 -149.44 L 75.89 -145.6 L 75.57 -142.22 L 75.14 -139.31 L 74.63 -136.88 L 74.11 -134.91 L 73.63 -133.4 L 73.22 -132.35 L 72.95 -131.73 L 72.84 -131.53 A 8 8 0 0 0 93.64 -117.63 L 93.79 -117.8 L 94.25 -118.3 L 95.07 -119.07 L 96.28 -120.1 L 97.9 -121.33 L 99.96 -122.73 L 102.48 -124.24 L 105.48 -125.83 L 108.97 -127.44 L 112.96 -129.02 L 117.47 -130.52 L 122.49 -131.9 L 131.9 -122.49 L 130.52 -117.47 L 129.02 -112.96 L 127.44 -108.97 L 125.83 -105.48 L 124.24 -102.48 L 122.73 -99.96 L 121.33 -97.9 L 120.1 -96.28 L 119.07 -95.07 L 118.3 -94.25 L 117.8 -93.79 L 117.63 -93.64 A 8 8 0 0 0 131.53 -72.84 L 131.73 -72.95 L 132.35 -73.22 L 133.4 -73.63 L 134.91 -74.11 L 136.88 -74.63 L 139.31 -75.14 L 142.22 -75.57 L 145.6 -75.89 L 149.44 -76.04 L 153.74 -75.97 L 158.48 -75.64 L 163.64 -74.98 L 168.73 -62.69 L 165.54 -58.58 L 162.43 -54.99 L 159.44 -51.9 L 156.62 -49.29 L 154 -47.13 L 151.64 -45.38 L 149.56 -44.01 L 147.8 -42.99 L 146.39 -42.27 L 145.36 -41.81 L 144.73 -41.57 L 144.51 -41.5 A 8 8 0 0 0 149.39 -16.97 L 149.62 -16.98 L 150.29 -17 L 151.42 -16.97 L 153 -16.85 L 155.02 -16.57 L 157.46 -16.1 L 160.32 -15.39 L 163.56 -14.39 L 167.17 -13.06 L 171.11 -11.35 L 175.36 -9.23 L 179.88 -6.66 L 179.88 6.66 L 175.36 9.23 L 171.11 11.35 L 167.17 13.06 L 163.56 14.39 L 160.32 15.39 L 157.46 16.1 L 155.02 16.57 L 153 16.85 L 151.42 16.97 L 150.29 17 L 149.62 16.98 L 149.39 16.97
			  M -110 0
				a 110 110 0 1 0 220 0
				a 110 110 0 1 0 -220 0
			" mask="url(#wedge-mask)" stroke="none" stroke-width="4"></path><circle cx="0" cy="0" r="60" stroke="none"></circle><path d="
						M 0 -28
						L 160 -14
						L 160 14
						L 0 28
						Z
					"></path></g></svg>Crank.js</a></div><div><a href="/guides/getting-started" aria-current="page">Guides</a></div><div><a href="/blog/">Blog</a></div><div><a href="/playground/">Playground</a></div></div><div class="css-1n0j5y9"><div><a href="https://github.com/bikeshaving/crank">GitHub</a></div><div><a href="http://npm.im/@b9g/crank">NPM</a></div><button role="switch" aria-label="set dark mode" aria-checked="false">⬜</button></div></nav></div><div id="sidebar" class="css-1wkb9s8"><h2 class="css-ep9szm">Guides</h2><div class="css-w1ljn4"><a href="/guides/getting-started" class="css-1l0nd7p">Getting Started</a></div><div class="css-w1ljn4"><a href="/guides/elements" class="css-1l0nd7p">Elements and Renderers</a></div><div class="css-w1ljn4"><a href="/guides/components" class="css-1l0nd7p">Components</a></div><div class="css-w1ljn4"><a href="/guides/handling-events" class="css-1l0nd7p">Handling Events</a></div><div class="css-w1ljn4"><a href="/guides/async-components" class="css-1l0nd7p">Async Components</a></div><div class="css-w1ljn4"><a href="/guides/special-props-and-tags" class="css-1l0nd7p">Special Props and Tags</a></div><div class="css-w1ljn4"><a href="/guides/lifecycles" class="css-1l0nd7p">Lifecycles</a></div><div class="css-w1ljn4"><a href="/guides/hydration" class="css-1l0nd7p">Hydration</a></div><div class="css-w1ljn4"><a href="/guides/reusable-logic" class="css-1l0nd7p">Reusable Logic</a></div><div class="css-w1ljn4"><a href="/guides/working-with-typescript" class="css-1l0nd7p">Working with TypeScript</a></div><div class="css-w1ljn4"><a href="/guides/reference-for-react-developers" class="css-1l0nd7p">React to Crank Migration Guide</a></div><div class="css-w1ljn4"><a href="/guides/jsx-template-tag" class="css-1l0nd7p">JSX Template Tag</a></div></div><main class="css-1mkiuoh"><h1>Custom Renderers</h1><p>The core Crank module provides an abstract <code class="inline">Renderer</code> class which can be extended to target any environment - not just the DOM. You can create renderers for WebGL libraries like Three.js or Pixi.js, terminals, canvas, native mobile platforms, or any other target that can display content.</p><p>Starting in Crank 0.7, the custom renderer API has been <strong>stabilized</strong> and documented for public use. Several custom renderers are actively in development, including a terminal renderer and WebGL renderers for Three.js and Pixi.js. This guide covers the concepts and methods you&#039;ll need to build your own renderer.</p><h2>Why Custom Renderers?</h2><p>Custom renderers enable Crank to work anywhere you can display content:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token comment">// Same component code works with any renderer</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  <span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token keyword">const</span> <span class="token function-variable function">increment</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> count<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>    <span class="token keyword">yield</span> <span class="token punctuation">(</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>      <span class="token operator">&lt;</span>view<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>        <span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>Count<span class="token operator">:</span> <span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>        <span class="token operator">&lt;</span>button onclick<span class="token operator">=</span><span class="token punctuation">{</span>increment<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>      <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>    <span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><code><span class="token comment">// Render to DOM</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="16"><code>domRenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Counter <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="17"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="18"><code><span class="token comment">// Render to terminal</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="19"><code>terminalRenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Counter <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> process<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="20"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="21"><code><span class="token comment">// Render to Three.js scene</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="22"><code>threeRenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Counter <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> scene<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-210" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-210'] = {"code":"\u002F\u002F Same component code works with any renderer\nfunction *Counter() {\n  let count = 0;\n  const increment = () =\u003E this.refresh(() =\u003E count++);\n\n  for ({} of this) {\n    yield (\n      \u003Cview\u003E\n        \u003Ctext\u003ECount: {count}\u003C\u002Ftext\u003E\n        \u003Cbutton onclick={increment}\u003E+1\u003C\u002Fbutton\u003E\n      \u003C\u002Fview\u003E\n    );\n  }\n}\n\n\u002F\u002F Render to DOM\ndomRenderer.render(\u003CCounter \u002F\u003E, document.body);\n\n\u002F\u002F Render to terminal\nterminalRenderer.render(\u003CCounter \u002F\u003E, process.stdout);\n\n\u002F\u002F Render to Three.js scene\nthreeRenderer.render(\u003CCounter \u002F\u003E, scene);","lang":"jsx"};
		</script></div><h2>Understanding the Rendering Process</h2><p>Crank&#039;s rendering follows a predictable lifecycle:</p><h3>1. <strong>Pre-order traversal</strong>: Components execute top-to-bottom</h3><p>Components run first to determine what elements to render.</p><h3>2. <strong>Post-order traversal</strong>: Host elements commit bottom-to-top</h3><p>DOM nodes are created and connected after their children are ready.</p><h3>3. <strong>Batched mutations</strong>: All changes happen at once</h3><p>This prevents visual inconsistencies, especially with async components.</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code>App Component</code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>├── Header Component</code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>│   └── <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span> <span class="token punctuation">(</span>commits after Header executes<span class="token punctuation">)</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>└── Counter Component</code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>    ├── <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span> <span class="token punctuation">(</span>commits after button commits<span class="token punctuation">)</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>    └── <span class="token operator">&lt;</span>button<span class="token operator">&gt;</span> <span class="token punctuation">(</span>commits first<span class="token punctuation">)</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-211" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-211'] = {"code":"App Component\n├── Header Component\n│   └── \u003Ch1\u003E (commits after Header executes)\n└── Counter Component\n    ├── \u003Cdiv\u003E (commits after button commits)\n    └── \u003Cbutton\u003E (commits first)","lang":""};
		</script></div><h2>Basic Renderer Implementation</h2><p>Here&#039;s a minimal custom renderer that outputs text:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Renderer<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@b9g/crank&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code><span class="token keyword">class</span> <span class="token class-name">TextRenderer</span> <span class="token keyword">extends</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>string<span class="token punctuation">,</span> never<span class="token punctuation">,</span> string<span class="token punctuation">,</span> string<span class="token operator">&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token comment">// Create a node for each host element</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>    <span class="token keyword">const</span> <span class="token punctuation">{</span>tag<span class="token punctuation">,</span> props<span class="token punctuation">}</span> <span class="token operator">=</span> element<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>      <span class="token keyword">return</span> props<span class="token punctuation">.</span>children <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><code>  <span class="token comment">// Connect children to their parent</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><code>  <span class="token function">arrange</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="16"><code>    <span class="token keyword">const</span> <span class="token punctuation">{</span>tag<span class="token punctuation">}</span> <span class="token operator">=</span> element<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="17"><code>    <span class="token keyword">const</span> content <span class="token operator">=</span> children<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="18"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="19"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>tag <span class="token operator">===</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="20"><code>      <span class="token keyword">return</span> content<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="21"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="22"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="23"><code>    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="24"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="25"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="26"><code>  <span class="token comment">// Process text nodes</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="27"><code>  <span class="token function">text</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="28"><code>    <span class="token keyword">return</span> text<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="29"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="30"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="31"><code>  <span class="token comment">// Return final result</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="32"><code>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="33"><code>    <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">?</span> value<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token operator">:</span> value <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="34"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="35"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="36"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="37"><code><span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TextRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="38"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="39"><code><span class="token comment">// Usage</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="40"><code><span class="token keyword">function</span> <span class="token function">Greeting</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="41"><code>  <span class="token keyword">return</span> <span class="token punctuation">(</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="42"><code>    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="43"><code>      <span class="token operator">&lt;</span>text<span class="token operator">&gt;</span>Hello <span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="44"><code>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="45"><code>  <span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="46"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="47"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="48"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Greeting name<span class="token operator">=</span><span class="token string">&quot;World&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="49"><code><span class="token comment">// Output: &quot;&lt;div&gt;Hello World!&lt;/div&gt;&quot;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-212" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-212'] = {"code":"import {Renderer} from \"@b9g\u002Fcrank\";\n\nclass TextRenderer extends Renderer\u003Cstring, never, string, string\u003E {\n  \u002F\u002F Create a node for each host element\n  create(element) {\n    const {tag, props} = element;\n\n    if (tag === \"text\") {\n      return props.children || \"\";\n    }\n\n    return `\u003C${tag}\u003E`;\n  }\n\n  \u002F\u002F Connect children to their parent\n  arrange(element, parent, children) {\n    const {tag} = element;\n    const content = children.join(\"\");\n\n    if (tag === \"text\") {\n      return content;\n    }\n\n    return `\u003C${tag}\u003E${content}\u003C\u002F${tag}\u003E`;\n  }\n\n  \u002F\u002F Process text nodes\n  text(text) {\n    return text;\n  }\n\n  \u002F\u002F Return final result\n  read(value) {\n    return Array.isArray(value) ? value.join(\"\") : value || \"\";\n  }\n}\n\nconst renderer = new TextRenderer();\n\n\u002F\u002F Usage\nfunction Greeting({name}) {\n  return (\n    \u003Cdiv\u003E\n      \u003Ctext\u003EHello {name}!\u003C\u002Ftext\u003E\n    \u003C\u002Fdiv\u003E\n  );\n}\n\nconsole.log(renderer.render(\u003CGreeting name=\"World\" \u002F\u003E));\n\u002F\u002F Output: \"\u003Cdiv\u003EHello World!\u003C\u002Fdiv\u003E\"","lang":"typescript"};
		</script></div><h2>Renderer Type Parameters</h2><p>The <code class="inline">Renderer</code> class takes four type parameters:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">class</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>TNode<span class="token punctuation">,</span> TScope<span class="token punctuation">,</span> TRoot<span class="token punctuation">,</span> TResult<span class="token operator">&gt;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-213" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-213'] = {"code":"class Renderer\u003CTNode, TScope, TRoot, TResult\u003E","lang":"typescript"};
		</script></div><h3>Internal Node Type: <code class="inline">TNode</code></h3><p>The type of nodes your renderer creates internally:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token comment">// DOM renderer uses actual DOM nodes</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code><span class="token keyword">class</span> <span class="token class-name">DOMRenderer</span> <span class="token keyword">extends</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>Node<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>    <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code><span class="token comment">// String renderer uses strings as nodes</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code><span class="token keyword">class</span> <span class="token class-name">StringRenderer</span> <span class="token keyword">extends</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>string<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>element<span class="token punctuation">.</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&gt;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-214" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-214'] = {"code":"\u002F\u002F DOM renderer uses actual DOM nodes\nclass DOMRenderer extends Renderer\u003CNode, ...\u003E {\n  create(element) {\n    return document.createElement(element.tag);\n  }\n}\n\n\u002F\u002F String renderer uses strings as nodes\nclass StringRenderer extends Renderer\u003Cstring, ...\u003E {\n  create(element) {\n    return `\u003C${element.tag}\u003E`;\n  }\n}","lang":"typescript"};
		</script></div><h3>Context Information: <code class="inline">TScope</code></h3><p>Data passed down the element tree for context:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">interface</span> <span class="token class-name">SVGScope</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token literal-property property">inSVG</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  namespace<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code><span class="token keyword">class</span> <span class="token class-name">DOMRenderer</span> <span class="token keyword">extends</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>Node<span class="token punctuation">,</span> SVGScope<span class="token punctuation">,</span> <span class="token operator">...</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>  <span class="token function">scope</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> scope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">&quot;svg&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token literal-property property">inSVG</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">namespace</span><span class="token operator">:</span> <span class="token string">&quot;http://www.w3.org/2000/svg&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>    <span class="token keyword">return</span> scope <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token literal-property property">inSVG</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code>  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> scope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>scope<span class="token punctuation">.</span>inSVG<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><code>      <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">createElementNS</span><span class="token punctuation">(</span>scope<span class="token punctuation">.</span>namespace<span class="token punctuation">,</span> element<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="16"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="17"><code>    <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="18"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="19"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-215" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-215'] = {"code":"interface SVGScope {\n  inSVG: boolean;\n  namespace?: string;\n}\n\nclass DOMRenderer extends Renderer\u003CNode, SVGScope, ...\u003E {\n  scope(element, scope) {\n    if (element.tag === \"svg\") {\n      return {inSVG: true, namespace: \"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\"};\n    }\n    return scope || {inSVG: false};\n  }\n\n  create(element, scope) {\n    if (scope.inSVG) {\n      return document.createElementNS(scope.namespace, element.tag);\n    }\n    return document.createElement(element.tag);\n  }\n}","lang":"typescript"};
		</script></div><h3>Root Container: <code class="inline">TRoot</code></h3><p>The type of the root container (usually same as <code class="inline">TNode</code>):</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token comment">// DOM: root is a DOM element</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code><span class="token comment">// Terminal: root might be a writable stream</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>terminalRenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> process<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-216" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-216'] = {"code":"\u002F\u002F DOM: root is a DOM element\nrenderer.render(\u003CApp \u002F\u003E, document.getElementById(\"root\"));\n\n\u002F\u002F Terminal: root might be a writable stream\nterminalRenderer.render(\u003CApp \u002F\u003E, process.stdout);","lang":"typescript"};
		</script></div><h3>Public Result: <code class="inline">TResult</code></h3><p>What users see when accessing rendered values:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token comment">// HTML renderer returns strings publicly, but uses objects internally</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code><span class="token keyword">class</span> <span class="token class-name">HTMLRenderer</span> <span class="token keyword">extends</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>InternalNode<span class="token punctuation">,</span> never<span class="token punctuation">,</span> Element<span class="token punctuation">,</span> string<span class="token operator">&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>    <span class="token comment">// Convert internal representation to HTML string</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-217" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-217'] = {"code":"\u002F\u002F HTML renderer returns strings publicly, but uses objects internally\nclass HTMLRenderer extends Renderer\u003CInternalNode, never, Element, string\u003E {\n  read(value) {\n    \u002F\u002F Convert internal representation to HTML string\n    return this.stringify(value);\n  }\n}","lang":"typescript"};
		</script></div><h2>Core Renderer Methods</h2><h3>Create Nodes: <code class="inline">create()</code></h3><p><strong><code class="inline">create(element, scope): TNode</code></strong> - Create new nodes from elements.
<strong>Required.</strong> Creates a node for each host element:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> scope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">const</span> <span class="token punctuation">{</span>tag<span class="token punctuation">,</span> props<span class="token punctuation">}</span> <span class="token operator">=</span> element<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>tag<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>    <span class="token keyword">case</span> <span class="token string">&quot;view&quot;</span><span class="token operator">:</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ViewNode</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>    <span class="token keyword">case</span> <span class="token string">&quot;text&quot;</span><span class="token operator">:</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">TextNode</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>    <span class="token keyword">case</span> <span class="token string">&quot;button&quot;</span><span class="token operator">:</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ButtonNode</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>    <span class="token keyword">default</span><span class="token operator">:</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Unknown element: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-218" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-218'] = {"code":"create(element, scope) {\n  const {tag, props} = element;\n\n  switch (tag) {\n    case \"view\":\n      return new ViewNode(props);\n    case \"text\":\n      return new TextNode(props.children || \"\");\n    case \"button\":\n      return new ButtonNode(props);\n    default:\n      throw new Error(`Unknown element: ${tag}`);\n  }\n}","lang":"typescript"};
		</script></div><h3>Arrange Children: <code class="inline">arrange()</code></h3><p><strong><code class="inline">arrange(element, parent, children): unknown</code></strong> - Place child nodes into parents.
<strong>Required.</strong> Connects child nodes to their parent:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">arrange</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token comment">// Clear existing children</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  parent<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>  <span class="token comment">// Add new children</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> child <span class="token keyword">of</span> children<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>    parent<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-219" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-219'] = {"code":"arrange(element, parent, children) {\n  \u002F\u002F Clear existing children\n  parent.clear();\n\n  \u002F\u002F Add new children\n  for (const child of children) {\n    parent.appendChild(child);\n  }\n}","lang":"typescript"};
		</script></div><h3>Update Properties: <code class="inline">patch()</code></h3><p><strong><code class="inline">patch(element, node): unknown</code></strong> - Update node properties and attributes.
Updates node properties when element props change:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">const</span> <span class="token punctuation">{</span>props<span class="token punctuation">}</span> <span class="token operator">=</span> element<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token comment">// Update node properties based on element props</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>  <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>style<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>    node<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>  <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>onclick<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>    node<span class="token punctuation">.</span><span class="token function">setEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> props<span class="token punctuation">.</span>onclick<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>  <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>visible <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code>    node<span class="token punctuation">.</span><span class="token function">setVisible</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>visible<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-220" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-220'] = {"code":"patch(element, node) {\n  const {props} = element;\n\n  \u002F\u002F Update node properties based on element props\n  if (props.style) {\n    node.setStyle(props.style);\n  }\n\n  if (props.onclick) {\n    node.setEventListener(\"click\", props.onclick);\n  }\n\n  if (props.visible !== undefined) {\n    node.setVisible(props.visible);\n  }\n}","lang":"typescript"};
		</script></div><h3>Handle Text: <code class="inline">text()</code></h3><p><strong><code class="inline">text(text, scope): TResult</code></strong> - Create text nodes from strings.
Processes text content:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">text</span><span class="token punctuation">(</span><span class="token parameter">text<span class="token punctuation">,</span> scope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token comment">// Escape HTML in text content</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  <span class="token keyword">return</span> text<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[&lt;&gt;&amp;&quot;]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">match</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>match<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>      <span class="token keyword">case</span> <span class="token string">&quot;&lt;&quot;</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">&quot;&amp;lt;&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>      <span class="token keyword">case</span> <span class="token string">&quot;&gt;&quot;</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">&quot;&amp;gt;&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>      <span class="token keyword">case</span> <span class="token string">&quot;&amp;&quot;</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">&quot;&amp;amp;&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>      <span class="token keyword">case</span> <span class="token string">&#039;&quot;&#039;</span><span class="token operator">:</span> <span class="token keyword">return</span> <span class="token string">&quot;&amp;quot;&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">return</span> match<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-221" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-221'] = {"code":"text(text, scope) {\n  \u002F\u002F Escape HTML in text content\n  return text.replace(\u002F[\u003C\u003E&\"]\u002Fg, (match) =\u003E {\n    switch (match) {\n      case \"\u003C\": return \"&lt;\";\n      case \"\u003E\": return \"&gt;\";\n      case \"&\": return \"&amp;\";\n      case '\"': return \"&quot;\";\n      default: return match;\n    }\n  });\n}","lang":"typescript"};
		</script></div><h3>Raw Content: <code class="inline">raw()</code></h3><p><strong><code class="inline">raw(value, scope): TNode | string</code></strong> - Handle Raw element content.
Handles <code class="inline">&lt;Raw&gt;</code> element content:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">raw</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> scope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>    <span class="token comment">// Parse HTML string into nodes</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">parseHTML</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>  <span class="token comment">// Return nodes as-is</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>  <span class="token keyword">return</span> value<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-222" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-222'] = {"code":"raw(value, scope) {\n  if (typeof value === \"string\") {\n    \u002F\u002F Parse HTML string into nodes\n    return this.parseHTML(value);\n  }\n\n  \u002F\u002F Return nodes as-is\n  return value;\n}","lang":"typescript"};
		</script></div><h2>Advanced Patterns</h2><h3>Event Handling</h3><p>Many renderers need to bridge their event systems to Crank&#039;s:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">class</span> <span class="token class-name">CanvasRenderer</span> <span class="token keyword">extends</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>CanvasNode<span class="token punctuation">,</span> never<span class="token punctuation">,</span> HTMLCanvasElement<span class="token punctuation">,</span> CanvasNode<span class="token operator">&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>    <span class="token keyword">const</span> <span class="token punctuation">{</span>props<span class="token punctuation">}</span> <span class="token operator">=</span> element<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>    <span class="token comment">// Set up event delegation</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>onclick <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>node<span class="token punctuation">.</span>hasClickListener<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>      node<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>offsetX<span class="token punctuation">,</span> event<span class="token punctuation">.</span>offsetY<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>          props<span class="token punctuation">.</span><span class="token function">onclick</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>        <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>      node<span class="token punctuation">.</span>hasClickListener <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-223" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-223'] = {"code":"class CanvasRenderer extends Renderer\u003CCanvasNode, never, HTMLCanvasElement, CanvasNode\u003E {\n  patch(element, node) {\n    const {props} = element;\n\n    \u002F\u002F Set up event delegation\n    if (props.onclick && !node.hasClickListener) {\n      node.canvas.addEventListener(\"click\", (event) =\u003E {\n        if (node.contains(event.offsetX, event.offsetY)) {\n          props.onclick(event);\n        }\n      });\n      node.hasClickListener = true;\n    }\n  }\n}","lang":"typescript"};
		</script></div><h3>Async Rendering Support</h3><p>Renderers can support async operations during rendering:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">class</span> <span class="token class-name">AsyncRenderer</span> <span class="token keyword">extends</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>AsyncNode<span class="token punctuation">,</span> never<span class="token punctuation">,</span> AsyncRoot<span class="token punctuation">,</span> AsyncNode<span class="token operator">&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">async</span> <span class="token function">arrange</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>    <span class="token comment">// Wait for all children to be ready</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>    <span class="token keyword">const</span> resolvedChildren <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>      children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> child<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>    <span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>    <span class="token comment">// Then arrange them</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>    parent<span class="token punctuation">.</span><span class="token function">setChildren</span><span class="token punctuation">(</span>resolvedChildren<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-224" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-224'] = {"code":"class AsyncRenderer extends Renderer\u003CAsyncNode, never, AsyncRoot, AsyncNode\u003E {\n  async arrange(element, parent, children) {\n    \u002F\u002F Wait for all children to be ready\n    const resolvedChildren = await Promise.all(\n      children.map(child =\u003E child.ready())\n    );\n\n    \u002F\u002F Then arrange them\n    parent.setChildren(resolvedChildren);\n  }\n}","lang":"typescript"};
		</script></div><h3>Resource Management</h3><p>Clean up resources when elements unmount:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">class</span> <span class="token class-name">ResourceRenderer</span> <span class="token keyword">extends</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>ResourceNode<span class="token punctuation">,</span> never<span class="token punctuation">,</span> Container<span class="token punctuation">,</span> ResourceNode<span class="token operator">&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>    <span class="token comment">// Clean up resources</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>    node<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>    <span class="token comment">// Remove event listeners</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>    node<span class="token punctuation">.</span><span class="token function">removeAllListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>    <span class="token comment">// Release memory</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>    node<span class="token punctuation">.</span>texture<span class="token operator">?.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-225" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-225'] = {"code":"class ResourceRenderer extends Renderer\u003CResourceNode, never, Container, ResourceNode\u003E {\n  dispose(element, node) {\n    \u002F\u002F Clean up resources\n    node.dispose();\n\n    \u002F\u002F Remove event listeners\n    node.removeAllListeners();\n\n    \u002F\u002F Release memory\n    node.texture?.destroy();\n  }\n}","lang":"typescript"};
		</script></div><h2>Real-world Example: Terminal Renderer</h2><p>Here&#039;s a more complete example that renders to a terminal:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Renderer<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@b9g/crank&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code><span class="token keyword">interface</span> <span class="token class-name">TerminalNode</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token literal-property property">tag</span><span class="token operator">:</span> string<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>  <span class="token literal-property property">props</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> any<span class="token operator">&gt;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>  <span class="token literal-property property">content</span><span class="token operator">:</span> string<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>  <span class="token literal-property property">children</span><span class="token operator">:</span> TerminalNode<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code><span class="token keyword">class</span> <span class="token class-name">TerminalRenderer</span> <span class="token keyword">extends</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>TerminalNode<span class="token punctuation">,</span> never<span class="token punctuation">,</span> NodeJS<span class="token punctuation">.</span>WriteStream<span class="token punctuation">,</span> string<span class="token operator">&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>    <span class="token keyword">return</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>      <span class="token literal-property property">tag</span><span class="token operator">:</span> element<span class="token punctuation">.</span>tag<span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code>      <span class="token literal-property property">props</span><span class="token operator">:</span> element<span class="token punctuation">.</span>props<span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><code>      <span class="token literal-property property">content</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><code>      <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="16"><code>    <span class="token punctuation">}</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="17"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="18"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="19"><code>  <span class="token function">arrange</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="20"><code>    <span class="token keyword">const</span> node <span class="token operator">=</span> parent <span class="token keyword">as</span> TerminalNode<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="21"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="22"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> parent <span class="token operator">!==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="23"><code>      <span class="token comment">// Root-level render</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="24"><code>      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderToStream</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="25"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="26"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="27"><code>    node<span class="token punctuation">.</span>children <span class="token operator">=</span> children<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token keyword">typeof</span> child <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="28"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="29"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="30"><code>  <span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="31"><code>    <span class="token keyword">const</span> <span class="token punctuation">{</span>props<span class="token punctuation">}</span> <span class="token operator">=</span> element<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="32"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="33"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="34"><code>      node<span class="token punctuation">.</span>content <span class="token operator">=</span> props<span class="token punctuation">.</span>children <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="35"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="36"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="37"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="38"><code>  <span class="token function">text</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="39"><code>    <span class="token keyword">return</span> text<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="40"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="41"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="42"><code>  <span class="token function">read</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="43"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="44"><code>      <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">nodeToString</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="45"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="46"><code>    <span class="token keyword">return</span> <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">nodeToString</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="47"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="48"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="49"><code>  <span class="token keyword">private</span> <span class="token function">nodeToString</span><span class="token punctuation">(</span>node<span class="token operator">:</span> TerminalNode<span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="50"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="51"><code>      <span class="token keyword">return</span> node<span class="token punctuation">.</span>content<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="52"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="53"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="54"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">&quot;bold&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="55"><code>      <span class="token keyword">const</span> content <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">nodeToString</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="56"><code>      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\x1b[1m</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\x1b[0m</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="57"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="58"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="59"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>tag <span class="token operator">===</span> <span class="token string">&quot;color&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="60"><code>      <span class="token keyword">const</span> color <span class="token operator">=</span> node<span class="token punctuation">.</span>props<span class="token punctuation">.</span>value <span class="token operator">||</span> <span class="token string">&quot;white&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="61"><code>      <span class="token keyword">const</span> colorCode <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getColorCode</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="62"><code>      <span class="token keyword">const</span> content <span class="token operator">=</span> node<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">nodeToString</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="63"><code>      <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\x1b[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>colorCode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">m</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\x1b[0m</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="64"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="65"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="66"><code>    <span class="token keyword">return</span> node<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">nodeToString</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="67"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="68"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="69"><code>  <span class="token keyword">private</span> <span class="token function">getColorCode</span><span class="token punctuation">(</span>color<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="70"><code>    <span class="token keyword">const</span> colors <span class="token operator">=</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="71"><code>      <span class="token literal-property property">red</span><span class="token operator">:</span> <span class="token string">&quot;31&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">green</span><span class="token operator">:</span> <span class="token string">&quot;32&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">yellow</span><span class="token operator">:</span> <span class="token string">&quot;33&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">blue</span><span class="token operator">:</span> <span class="token string">&quot;34&quot;</span><span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="72"><code>      <span class="token literal-property property">magenta</span><span class="token operator">:</span> <span class="token string">&quot;35&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">cyan</span><span class="token operator">:</span> <span class="token string">&quot;36&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">white</span><span class="token operator">:</span> <span class="token string">&quot;37&quot;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="73"><code>    <span class="token punctuation">}</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="74"><code>    <span class="token keyword">return</span> colors<span class="token punctuation">[</span>color<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">&quot;37&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="75"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="76"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="77"><code>  <span class="token keyword">private</span> <span class="token function">renderToStream</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">children</span><span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">stream</span><span class="token operator">:</span> NodeJS<span class="token punctuation">.</span>WriteStream</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="78"><code>    <span class="token keyword">const</span> output <span class="token operator">=</span> children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="79"><code>      <span class="token keyword">typeof</span> child <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">nodeToString</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="80"><code>    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="81"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="82"><code>    stream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="83"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="84"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="85"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="86"><code><span class="token comment">// Usage</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="87"><code><span class="token keyword">const</span> terminalRenderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TerminalRenderer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="88"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="89"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">ProgressBar</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>progress<span class="token punctuation">,</span> total<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="90"><code>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>progress<span class="token punctuation">,</span> total<span class="token punctuation">}</span> <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="91"><code>    <span class="token keyword">const</span> percentage <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>progress <span class="token operator">/</span> total<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="92"><code>    <span class="token keyword">const</span> filled <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span><span class="token punctuation">(</span>progress <span class="token operator">/</span> total<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="93"><code>    <span class="token keyword">const</span> empty <span class="token operator">=</span> <span class="token number">20</span> <span class="token operator">-</span> filled<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="94"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="95"><code>    <span class="token keyword">yield</span> <span class="token punctuation">(</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="96"><code>      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="97"><code>        <span class="token operator">&lt;</span>bold<span class="token operator">&gt;</span>Progress<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token operator">/</span>bold<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="98"><code>        <span class="token operator">&lt;</span>color value<span class="token operator">=</span><span class="token string">&quot;green&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token string">&quot;█&quot;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>filled<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>color<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="99"><code>        <span class="token operator">&lt;</span>color value<span class="token operator">=</span><span class="token string">&quot;gray&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token string">&quot;░&quot;</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span>empty<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>color<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="100"><code>        <span class="token operator">&lt;</span>text<span class="token operator">&gt;</span> <span class="token punctuation">{</span>percentage<span class="token punctuation">}</span><span class="token operator">%</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="101"><code>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="102"><code>    <span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="103"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="104"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="105"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="106"><code>terminalRenderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>ProgressBar progress<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">7</span><span class="token punctuation">}</span> total<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> process<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="107"><code><span class="token comment">// Output: Progress: ██████████████░░░░░░ 70%</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-226" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-226'] = {"code":"import {Renderer} from \"@b9g\u002Fcrank\";\n\ninterface TerminalNode {\n  tag: string;\n  props: Record\u003Cstring, any\u003E;\n  content: string;\n  children: TerminalNode[];\n}\n\nclass TerminalRenderer extends Renderer\u003CTerminalNode, never, NodeJS.WriteStream, string\u003E {\n  create(element) {\n    return {\n      tag: element.tag,\n      props: element.props,\n      content: \"\",\n      children: []\n    };\n  }\n\n  arrange(element, parent, children) {\n    const node = parent as TerminalNode;\n\n    if (typeof parent !== \"object\") {\n      \u002F\u002F Root-level render\n      return this.renderToStream(children, parent);\n    }\n\n    node.children = children.filter(child =\u003E typeof child === \"object\");\n  }\n\n  patch(element, node) {\n    const {props} = element;\n\n    if (element.tag === \"text\") {\n      node.content = props.children || \"\";\n    }\n  }\n\n  text(text) {\n    return text;\n  }\n\n  read(value) {\n    if (Array.isArray(value)) {\n      return value.map(v =\u003E this.nodeToString(v)).join(\"\");\n    }\n    return typeof value === \"object\" ? this.nodeToString(value) : String(value);\n  }\n\n  private nodeToString(node: TerminalNode): string {\n    if (node.tag === \"text\") {\n      return node.content;\n    }\n\n    if (node.tag === \"bold\") {\n      const content = node.children.map(child =\u003E this.nodeToString(child)).join(\"\");\n      return `\\x1b[1m${content}\\x1b[0m`;\n    }\n\n    if (node.tag === \"color\") {\n      const color = node.props.value || \"white\";\n      const colorCode = this.getColorCode(color);\n      const content = node.children.map(child =\u003E this.nodeToString(child)).join(\"\");\n      return `\\x1b[${colorCode}m${content}\\x1b[0m`;\n    }\n\n    return node.children.map(child =\u003E this.nodeToString(child)).join(\"\");\n  }\n\n  private getColorCode(color: string): string {\n    const colors = {\n      red: \"31\", green: \"32\", yellow: \"33\", blue: \"34\",\n      magenta: \"35\", cyan: \"36\", white: \"37\"\n    };\n    return colors[color] || \"37\";\n  }\n\n  private renderToStream(children: any[], stream: NodeJS.WriteStream) {\n    const output = children.map(child =\u003E\n      typeof child === \"object\" ? this.nodeToString(child) : String(child)\n    ).join(\"\");\n\n    stream.write(output);\n  }\n}\n\n\u002F\u002F Usage\nconst terminalRenderer = new TerminalRenderer();\n\nfunction *ProgressBar({progress, total}) {\n  for ({progress, total} of this) {\n    const percentage = Math.round((progress \u002F total) * 100);\n    const filled = Math.round((progress \u002F total) * 20);\n    const empty = 20 - filled;\n\n    yield (\n      \u003Cdiv\u003E\n        \u003Cbold\u003EProgress: \u003C\u002Fbold\u003E\n        \u003Ccolor value=\"green\"\u003E{\"█\".repeat(filled)}\u003C\u002Fcolor\u003E\n        \u003Ccolor value=\"gray\"\u003E{\"░\".repeat(empty)}\u003C\u002Fcolor\u003E\n        \u003Ctext\u003E {percentage}%\u003C\u002Ftext\u003E\n      \u003C\u002Fdiv\u003E\n    );\n  }\n}\n\nterminalRenderer.render(\u003CProgressBar progress={7} total={10} \u002F\u003E, process.stdout);\n\u002F\u002F Output: Progress: ██████████████░░░░░░ 70%","lang":"typescript"};
		</script></div><h2>Using the EventTarget Module</h2><p>Crank 0.7 extracted the <code class="inline">EventTarget</code> class into a separate module that&#039;s useful for custom renderers:</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>EventTarget<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@b9g/crank/event-target&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code><span class="token keyword">class</span> <span class="token class-name">CustomNode</span> <span class="token keyword">extends</span> <span class="token class-name">EventTarget</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">tag</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>    <span class="token keyword">this</span><span class="token punctuation">.</span>tag <span class="token operator">=</span> tag<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>  <span class="token comment">// Your custom node implementation can dispatch events</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>  <span class="token function">handleUserInteraction</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CustomEvent</span><span class="token punctuation">(</span><span class="token string">&quot;interaction&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>      <span class="token literal-property property">detail</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">timestamp</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="16"><code><span class="token keyword">class</span> <span class="token class-name">CustomRenderer</span> <span class="token keyword">extends</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span>CustomNode<span class="token punctuation">,</span> never<span class="token punctuation">,</span> CustomNode<span class="token punctuation">,</span> CustomNode<span class="token operator">&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="17"><code>  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="18"><code>    <span class="token keyword">const</span> node <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CustomNode</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="19"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="20"><code>    <span class="token comment">// Set up event forwarding</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="21"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>props<span class="token punctuation">.</span>oninteraction<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="22"><code>      node<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;interaction&quot;</span><span class="token punctuation">,</span> element<span class="token punctuation">.</span>props<span class="token punctuation">.</span>oninteraction<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="23"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="24"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="25"><code>    <span class="token keyword">return</span> node<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="26"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="27"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-227" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-227'] = {"code":"import {EventTarget} from \"@b9g\u002Fcrank\u002Fevent-target\";\n\nclass CustomNode extends EventTarget {\n  constructor(tag: string) {\n    super();\n    this.tag = tag;\n  }\n\n  \u002F\u002F Your custom node implementation can dispatch events\n  handleUserInteraction() {\n    this.dispatchEvent(new CustomEvent(\"interaction\", {\n      detail: {timestamp: Date.now()}\n    }));\n  }\n}\n\nclass CustomRenderer extends Renderer\u003CCustomNode, never, CustomNode, CustomNode\u003E {\n  create(element) {\n    const node = new CustomNode(element.tag);\n\n    \u002F\u002F Set up event forwarding\n    if (element.props.oninteraction) {\n      node.addEventListener(\"interaction\", element.props.oninteraction);\n    }\n\n    return node;\n  }\n}","lang":"typescript"};
		</script></div><h2>Best Practices</h2><h3>1. Handle Edge Cases</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">arrange</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> children</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token comment">// Handle empty children</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  <span class="token keyword">const</span> validChildren <span class="token operator">=</span> children<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> child <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>  <span class="token comment">// Handle mixed content types</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>  <span class="token keyword">const</span> processedChildren <span class="token operator">=</span> validChildren<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">child</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>    <span class="token keyword">return</span> <span class="token keyword">typeof</span> child <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token operator">:</span> child<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>  parent<span class="token punctuation">.</span><span class="token function">setChildren</span><span class="token punctuation">(</span>processedChildren<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-228" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-228'] = {"code":"arrange(element, parent, children) {\n  \u002F\u002F Handle empty children\n  const validChildren = children.filter(child =\u003E child != null);\n\n  \u002F\u002F Handle mixed content types\n  const processedChildren = validChildren.map(child =\u003E {\n    return typeof child === \"string\" ? this.createTextNode(child) : child;\n  });\n\n  parent.setChildren(processedChildren);\n}","lang":"typescript"};
		</script></div><h3>2. Optimize for Performance</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">patch</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">const</span> <span class="token punctuation">{</span>props<span class="token punctuation">}</span> <span class="token operator">=</span> element<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token comment">// Only update changed properties</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>  <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>style <span class="token operator">!==</span> node<span class="token punctuation">.</span>lastStyle<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>    node<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>    node<span class="token punctuation">.</span>lastStyle <span class="token operator">=</span> props<span class="token punctuation">.</span>style<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-229" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-229'] = {"code":"patch(element, node) {\n  const {props} = element;\n\n  \u002F\u002F Only update changed properties\n  if (props.style !== node.lastStyle) {\n    node.setStyle(props.style);\n    node.lastStyle = props.style;\n  }\n}","lang":"typescript"};
		</script></div><h3>3. Provide Helpful Debugging</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> scope</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">try</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createNode</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>tag<span class="token punctuation">,</span> element<span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Failed to create </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>element<span class="token punctuation">.</span>tag<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token punctuation">.</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>    <span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-230" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-230'] = {"code":"create(element, scope) {\n  try {\n    return this.createNode(element.tag, element.props);\n  } catch (error) {\n    throw new Error(\n      `Failed to create ${element.tag}: ${error.message}`\n    );\n  }\n}","lang":"typescript"};
		</script></div><p>With a stable API and powerful abstractions, Crank&#039;s custom renderer system enables you to bring declarative, component-based development to any platform or environment. The key is understanding the rendering lifecycle and implementing the core methods to bridge Crank&#039;s elements to your target platform&#039;s capabilities.</p></main><script data-name="static-urls-231" id="static-urls">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['static-urls-231'] = {"@b9g\u002Fcrank":"\u002Fstatic\u002Fcrank-ESBVX7GV.js","@b9g\u002Fcrank.js":"\u002Fstatic\u002Fcrank-ESBVX7GV.js","@b9g\u002Fcrank\u002Fasync":"\u002Fstatic\u002Fasync-CGDMGMUQ.js","@b9g\u002Fcrank\u002Fasync.js":"\u002Fstatic\u002Fasync-CGDMGMUQ.js","@b9g\u002Fcrank\u002Fcrank":"\u002Fstatic\u002Fcrank-ESBVX7GV.js","@b9g\u002Fcrank\u002Fcrank.js":"\u002Fstatic\u002Fcrank-ESBVX7GV.js","@b9g\u002Fcrank\u002Fdom":"\u002Fstatic\u002Fdom-2ZE6YNF6.js","@b9g\u002Fcrank\u002Fdom.js":"\u002Fstatic\u002Fdom-2ZE6YNF6.js","@b9g\u002Fcrank\u002Fevent-target":"\u002Fstatic\u002Fevent-target-K6L2AQDD.js","@b9g\u002Fcrank\u002Fevent-target.js":"\u002Fstatic\u002Fevent-target-K6L2AQDD.js","@b9g\u002Fcrank\u002Fhtml":"\u002Fstatic\u002Fhtml-4XAEMDNI.js","@b9g\u002Fcrank\u002Fhtml.js":"\u002Fstatic\u002Fhtml-4XAEMDNI.js","@b9g\u002Fcrank\u002Fjsx-dev-runtime":"\u002Fstatic\u002Fjsx-runtime-VTCZGTQU.js","@b9g\u002Fcrank\u002Fjsx-dev-runtime.js":"\u002Fstatic\u002Fjsx-runtime-VTCZGTQU.js","@b9g\u002Fcrank\u002Fjsx-runtime":"\u002Fstatic\u002Fjsx-runtime-VTCZGTQU.js","@b9g\u002Fcrank\u002Fjsx-runtime.js":"\u002Fstatic\u002Fjsx-runtime-VTCZGTQU.js","@b9g\u002Fcrank\u002Fjsx-tag":"\u002Fstatic\u002Fjsx-tag-VPNOE4JP.js","@b9g\u002Fcrank\u002Fjsx-tag.js":"\u002Fstatic\u002Fjsx-tag-VPNOE4JP.js","@b9g\u002Fcrank\u002Fstandalone":"\u002Fstatic\u002Fstandalone-FJ3E2LNJ.js","@b9g\u002Fcrank\u002Fstandalone.js":"\u002Fstatic\u002Fstandalone-FJ3E2LNJ.js","client.css":"\u002Fstatic\u002Fclient-HDSPLS5O.css"};
		</script><script src="/static/navbar-MBN6NLBG.js"></script><script src="/static/code-blocks-VAVPFCJ2.js"></script></body></html>