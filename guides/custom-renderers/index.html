<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Crank.js | Custom Renderers</title><link href="/static/client-MPMYQO26.css" rel="stylesheet" type="text/css"><link rel="shortcut icon" href="/static/favicon.ico"></head><body><script>
	(() => {
		const colorScheme = sessionStorage.getItem("color-scheme") ||
			(window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches
				? "dark" : "light"
			);
		if (colorScheme === "dark") {
			document.body.classList.remove("color-scheme-light");
		} else {
			document.body.classList.add("color-scheme-light");
		}
	})()</script><div id="navbar-root"><style data-emotion="css 1l1hcps 1xmwt0h">.css-1l1hcps{position:fixed;top:0;left:0;right:0;height:50px;z-index:999;gap:1em;}.css-1xmwt0h{border-bottom:1px solid var(--text-color);overflow-x:auto;background-color:inherit;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;gap:1em;}.css-1xmwt0h a{-webkit-text-decoration:none;text-decoration:none;font-weight:bold;}@media screen and (min-width: 800px){.css-1xmwt0h{padding:0 2em;}}</style><nav class="
				blur-background
				css-1l1hcps
				css-1xmwt0h
			"><style data-emotion="css 1n0j5y9">.css-1n0j5y9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:1em;}</style><div class="css-1n0j5y9"><div><a class="css-1n0j5y9" style="gap: 0.3em" href="/"><svg style="flex: none;" fill="none" viewBox="-200 -200 400 400" width="1.9em" height="1.9em"><defs><mask id="wedge-mask"><rect x="-200" y="-200" width="400" height="400" fill="white"></rect><path stroke="none" fill="black" d="
							M 0 0
							L 245.74561328669753 172.07293090531383
							L 245.74561328669753 -172.07293090531383
							z
						"></path></mask></defs><g stroke="none" fill="#dbb368"><path transform="rotate(0)" d="M 149.39 -16.97 M 149.62 -16.98 M 150.29 -17 M 151.42 -16.97 M 153 -16.85 M 155.02 -16.57 M 157.46 -16.1 M 160.32 -15.39 M 163.56 -14.39 M 167.17 -13.06 M 171.11 -11.35 M 175.36 -9.23 M 179.88 -6.66 M 179.88 6.66 M 175.36 9.23 M 171.11 11.35 M 167.17 13.06 M 163.56 14.39 M 160.32 15.39 M 157.46 16.1 M 155.02 16.57 M 153 16.85 M 151.42 16.97 M 150.29 17 M 149.62 16.98 M 149.39 16.97 A 8 8 0 0 0 144.51 41.5 L 144.73 41.57 L 145.36 41.81 L 146.39 42.27 L 147.8 42.99 L 149.56 44.01 L 151.64 45.38 L 154 47.13 L 156.62 49.29 L 159.44 51.9 L 162.43 54.99 L 165.54 58.58 L 168.73 62.69 L 163.64 74.98 L 158.48 75.64 L 153.74 75.97 L 149.44 76.04 L 145.6 75.89 L 142.22 75.57 L 139.31 75.14 L 136.88 74.63 L 134.91 74.11 L 133.4 73.63 L 132.35 73.22 L 131.73 72.95 L 131.53 72.84 A 8 8 0 0 0 117.63 93.64 L 117.8 93.79 L 118.3 94.25 L 119.07 95.07 L 120.1 96.28 L 121.33 97.9 L 122.73 99.96 L 124.24 102.48 L 125.83 105.48 L 127.44 108.97 L 129.02 112.96 L 130.52 117.47 L 131.9 122.49 L 122.49 131.9 L 117.47 130.52 L 112.96 129.02 L 108.97 127.44 L 105.48 125.83 L 102.48 124.24 L 99.96 122.73 L 97.9 121.33 L 96.28 120.1 L 95.07 119.07 L 94.25 118.3 L 93.79 117.8 L 93.64 117.63 A 8 8 0 0 0 72.84 131.53 L 72.95 131.73 L 73.22 132.35 L 73.63 133.4 L 74.11 134.91 L 74.63 136.88 L 75.14 139.31 L 75.57 142.22 L 75.89 145.6 L 76.04 149.44 L 75.97 153.74 L 75.64 158.48 L 74.98 163.64 L 62.69 168.73 L 58.58 165.54 L 54.99 162.43 L 51.9 159.44 L 49.29 156.62 L 47.13 154 L 45.38 151.64 L 44.01 149.56 L 42.99 147.8 L 42.27 146.39 L 41.81 145.36 L 41.57 144.73 L 41.5 144.51 A 8 8 0 0 0 16.97 149.39 L 16.98 149.62 L 17 150.29 L 16.97 151.42 L 16.85 153 L 16.57 155.02 L 16.1 157.46 L 15.39 160.32 L 14.39 163.56 L 13.06 167.17 L 11.35 171.11 L 9.23 175.36 L 6.66 179.88 L -6.66 179.88 L -9.23 175.36 L -11.35 171.11 L -13.06 167.17 L -14.39 163.56 L -15.39 160.32 L -16.1 157.46 L -16.57 155.02 L -16.85 153 L -16.97 151.42 L -17 150.29 L -16.98 149.62 L -16.97 149.39 A 8 8 0 0 0 -41.5 144.51 L -41.57 144.73 L -41.81 145.36 L -42.27 146.39 L -42.99 147.8 L -44.01 149.56 L -45.38 151.64 L -47.13 154 L -49.29 156.62 L -51.9 159.44 L -54.99 162.43 L -58.58 165.54 L -62.69 168.73 L -74.98 163.64 L -75.64 158.48 L -75.97 153.74 L -76.04 149.44 L -75.89 145.6 L -75.57 142.22 L -75.14 139.31 L -74.63 136.88 L -74.11 134.91 L -73.63 133.4 L -73.22 132.35 L -72.95 131.73 L -72.84 131.53 A 8 8 0 0 0 -93.64 117.63 L -93.79 117.8 L -94.25 118.3 L -95.07 119.07 L -96.28 120.1 L -97.9 121.33 L -99.96 122.73 L -102.48 124.24 L -105.48 125.83 L -108.97 127.44 L -112.96 129.02 L -117.47 130.52 L -122.49 131.9 L -131.9 122.49 L -130.52 117.47 L -129.02 112.96 L -127.44 108.97 L -125.83 105.48 L -124.24 102.48 L -122.73 99.96 L -121.33 97.9 L -120.1 96.28 L -119.07 95.07 L -118.3 94.25 L -117.8 93.79 L -117.63 93.64 A 8 8 0 0 0 -131.53 72.84 L -131.73 72.95 L -132.35 73.22 L -133.4 73.63 L -134.91 74.11 L -136.88 74.63 L -139.31 75.14 L -142.22 75.57 L -145.6 75.89 L -149.44 76.04 L -153.74 75.97 L -158.48 75.64 L -163.64 74.98 L -168.73 62.69 L -165.54 58.58 L -162.43 54.99 L -159.44 51.9 L -156.62 49.29 L -154 47.13 L -151.64 45.38 L -149.56 44.01 L -147.8 42.99 L -146.39 42.27 L -145.36 41.81 L -144.73 41.57 L -144.51 41.5 A 8 8 0 0 0 -149.39 16.97 L -149.62 16.98 L -150.29 17 L -151.42 16.97 L -153 16.85 L -155.02 16.57 L -157.46 16.1 L -160.32 15.39 L -163.56 14.39 L -167.17 13.06 L -171.11 11.35 L -175.36 9.23 L -179.88 6.66 L -179.88 -6.66 L -175.36 -9.23 L -171.11 -11.35 L -167.17 -13.06 L -163.56 -14.39 L -160.32 -15.39 L -157.46 -16.1 L -155.02 -16.57 L -153 -16.85 L -151.42 -16.97 L -150.29 -17 L -149.62 -16.98 L -149.39 -16.97 A 8 8 0 0 0 -144.51 -41.5 L -144.73 -41.57 L -145.36 -41.81 L -146.39 -42.27 L -147.8 -42.99 L -149.56 -44.01 L -151.64 -45.38 L -154 -47.13 L -156.62 -49.29 L -159.44 -51.9 L -162.43 -54.99 L -165.54 -58.58 L -168.73 -62.69 L -163.64 -74.98 L -158.48 -75.64 L -153.74 -75.97 L -149.44 -76.04 L -145.6 -75.89 L -142.22 -75.57 L -139.31 -75.14 L -136.88 -74.63 L -134.91 -74.11 L -133.4 -73.63 L -132.35 -73.22 L -131.73 -72.95 L -131.53 -72.84 A 8 8 0 0 0 -117.63 -93.64 L -117.8 -93.79 L -118.3 -94.25 L -119.07 -95.07 L -120.1 -96.28 L -121.33 -97.9 L -122.73 -99.96 L -124.24 -102.48 L -125.83 -105.48 L -127.44 -108.97 L -129.02 -112.96 L -130.52 -117.47 L -131.9 -122.49 L -122.49 -131.9 L -117.47 -130.52 L -112.96 -129.02 L -108.97 -127.44 L -105.48 -125.83 L -102.48 -124.24 L -99.96 -122.73 L -97.9 -121.33 L -96.28 -120.1 L -95.07 -119.07 L -94.25 -118.3 L -93.79 -117.8 L -93.64 -117.63 A 8 8 0 0 0 -72.84 -131.53 L -72.95 -131.73 L -73.22 -132.35 L -73.63 -133.4 L -74.11 -134.91 L -74.63 -136.88 L -75.14 -139.31 L -75.57 -142.22 L -75.89 -145.6 L -76.04 -149.44 L -75.97 -153.74 L -75.64 -158.48 L -74.98 -163.64 L -62.69 -168.73 L -58.58 -165.54 L -54.99 -162.43 L -51.9 -159.44 L -49.29 -156.62 L -47.13 -154 L -45.38 -151.64 L -44.01 -149.56 L -42.99 -147.8 L -42.27 -146.39 L -41.81 -145.36 L -41.57 -144.73 L -41.5 -144.51 A 8 8 0 0 0 -16.97 -149.39 L -16.98 -149.62 L -17 -150.29 L -16.97 -151.42 L -16.85 -153 L -16.57 -155.02 L -16.1 -157.46 L -15.39 -160.32 L -14.39 -163.56 L -13.06 -167.17 L -11.35 -171.11 L -9.23 -175.36 L -6.66 -179.88 L 6.66 -179.88 L 9.23 -175.36 L 11.35 -171.11 L 13.06 -167.17 L 14.39 -163.56 L 15.39 -160.32 L 16.1 -157.46 L 16.57 -155.02 L 16.85 -153 L 16.97 -151.42 L 17 -150.29 L 16.98 -149.62 L 16.97 -149.39 A 8 8 0 0 0 41.5 -144.51 L 41.57 -144.73 L 41.81 -145.36 L 42.27 -146.39 L 42.99 -147.8 L 44.01 -149.56 L 45.38 -151.64 L 47.13 -154 L 49.29 -156.62 L 51.9 -159.44 L 54.99 -162.43 L 58.58 -165.54 L 62.69 -168.73 L 74.98 -163.64 L 75.64 -158.48 L 75.97 -153.74 L 76.04 -149.44 L 75.89 -145.6 L 75.57 -142.22 L 75.14 -139.31 L 74.63 -136.88 L 74.11 -134.91 L 73.63 -133.4 L 73.22 -132.35 L 72.95 -131.73 L 72.84 -131.53 A 8 8 0 0 0 93.64 -117.63 L 93.79 -117.8 L 94.25 -118.3 L 95.07 -119.07 L 96.28 -120.1 L 97.9 -121.33 L 99.96 -122.73 L 102.48 -124.24 L 105.48 -125.83 L 108.97 -127.44 L 112.96 -129.02 L 117.47 -130.52 L 122.49 -131.9 L 131.9 -122.49 L 130.52 -117.47 L 129.02 -112.96 L 127.44 -108.97 L 125.83 -105.48 L 124.24 -102.48 L 122.73 -99.96 L 121.33 -97.9 L 120.1 -96.28 L 119.07 -95.07 L 118.3 -94.25 L 117.8 -93.79 L 117.63 -93.64 A 8 8 0 0 0 131.53 -72.84 L 131.73 -72.95 L 132.35 -73.22 L 133.4 -73.63 L 134.91 -74.11 L 136.88 -74.63 L 139.31 -75.14 L 142.22 -75.57 L 145.6 -75.89 L 149.44 -76.04 L 153.74 -75.97 L 158.48 -75.64 L 163.64 -74.98 L 168.73 -62.69 L 165.54 -58.58 L 162.43 -54.99 L 159.44 -51.9 L 156.62 -49.29 L 154 -47.13 L 151.64 -45.38 L 149.56 -44.01 L 147.8 -42.99 L 146.39 -42.27 L 145.36 -41.81 L 144.73 -41.57 L 144.51 -41.5 A 8 8 0 0 0 149.39 -16.97 L 149.62 -16.98 L 150.29 -17 L 151.42 -16.97 L 153 -16.85 L 155.02 -16.57 L 157.46 -16.1 L 160.32 -15.39 L 163.56 -14.39 L 167.17 -13.06 L 171.11 -11.35 L 175.36 -9.23 L 179.88 -6.66 L 179.88 6.66 L 175.36 9.23 L 171.11 11.35 L 167.17 13.06 L 163.56 14.39 L 160.32 15.39 L 157.46 16.1 L 155.02 16.57 L 153 16.85 L 151.42 16.97 L 150.29 17 L 149.62 16.98 L 149.39 16.97
			  M -110 0
				a 110 110 0 1 0 220 0
				a 110 110 0 1 0 -220 0
			" mask="url(#wedge-mask)" stroke="none" stroke-width="4"></path><circle cx="0" cy="0" r="60" stroke="none"></circle><path d="
						M 0 0
						L 0 40
						L 160 20
						A 0.2 1 0 0 0 160 -20
						L 0 -40
						z
					"></path></g></svg>Crank.js</a></div><div><a href="/guides/getting-started" aria-current="page">Guides</a></div><div><a href="/blog/">Blog</a></div><div><a href="/playground/">Playground</a></div></div><div class="css-1n0j5y9"><div><a href="https://github.com/bikeshaving/crank">GitHub</a></div><div><a href="http://npm.im/@b9g/crank">NPM</a></div><button role="switch" aria-label="set dark mode" aria-checked="false">⬜</button></div></nav></div><style data-emotion="css 1wkb9s8">.css-1wkb9s8{background-color:var(--bg-color);margin-top:50px;padding:2rem 0.4rem;color:var(--text-color);border-right:1px solid currentcolor;border-bottom:1px solid currentcolor;}@media screen and (min-width: 800px){.css-1wkb9s8{position:fixed;top:50px;bottom:0;overflow-x:hidden;overflow-y:auto;width:15rem;margin:0;padding:2rem 1rem;text-align:right;}}@media screen and (min-width: 1100px){.css-1wkb9s8{padding:3rem 2rem;width:20rem;}}.css-1wkb9s8 >:first-child{margin-top:0;}</style><div id="sidebar" class="css-1wkb9s8"><style data-emotion="css ep9szm">.css-ep9szm{color:var(--highlight-color);margin-top:0;}</style><h3 class="css-ep9szm">Guides</h3><style data-emotion="css w1ljn4">.css-w1ljn4{margin:10px 0;}</style><div class="css-w1ljn4"><style data-emotion="css 1l0nd7p">.css-1l0nd7p{-webkit-text-decoration:none;text-decoration:none;}</style><a href="/guides/getting-started" class="css-1l0nd7p">Getting Started</a></div><div class="css-w1ljn4"><a href="/guides/elements" class="css-1l0nd7p">Elements and Renderers</a></div><div class="css-w1ljn4"><a href="/guides/components" class="css-1l0nd7p">Components</a></div><div class="css-w1ljn4"><a href="/guides/handling-events" class="css-1l0nd7p">Handling Events</a></div><div class="css-w1ljn4"><a href="/guides/async-components" class="css-1l0nd7p">Async Components</a></div><div class="css-w1ljn4"><a href="/guides/special-props-and-tags" class="css-1l0nd7p">Special Props and Tags</a></div><div class="css-w1ljn4"><a href="/guides/lifecycles" class="css-1l0nd7p">Lifecycles</a></div><div class="css-w1ljn4"><a href="/guides/reusable-logic" class="css-1l0nd7p">Reusable Logic</a></div><div class="css-w1ljn4"><a href="/guides/working-with-typescript" class="css-1l0nd7p">Working with TypeScript</a></div><div class="css-w1ljn4"><a href="/guides/reference-for-react-developers" class="css-1l0nd7p">Reference for React Developers</a></div><div class="css-w1ljn4"><a href="/guides/jsx-template-tag" class="css-1l0nd7p">JSX Template Tag</a></div><div class="css-w1ljn4"><a href="/guides/xx-performance" class="css-1l0nd7p"></a></div></div><style data-emotion="css sjfxen">.css-sjfxen{margin:0 auto;padding:2rem 0.4rem;}@media screen and (min-width: 800px){.css-sjfxen{margin-left:240px;padding:2rem 1rem;margin-top:50px;}}@media screen and (min-width: 1100px){.css-sjfxen{margin-left:320px;padding:3rem 2rem;}}.css-sjfxen p{max-width:800px;}</style><main class="css-sjfxen"><marquee behavior="alternate">👷👷👷The Crank documentation website is under construction to match the latest API. Please pardon the appearance.👷👷👷</marquee><h1>Custom Renderers</h1><h2>THIS INFORMATION IS OUT OF DATE</h2><p>The core Crank module provides an abstract <code class="inline">Renderer</code> class which can be extended to produce more than just DOM nodes or HTML strings, allowing you to target alternative environments such as WebGL libraries like Three.js or Pixi.js, terminals, smartphones or smart TVs. This guide provides an overview of the concepts and internal methods which you will need to know when implementing a custom renderer yourself. Alternatively, you can read through the <a href="https://github.com/bikeshaving/crank/blob/master/src/dom.ts?ts=2">DOM</a> and <a href="https://github.com/bikeshaving/crank/blob/master/src/html.ts?ts=2">HTML</a> renderer implementations to learn by example.</p><p><strong>Warning:</strong> The custom renderer API is currently unstable both because of its performance-sensitive nature and because the exact complications of rendering to a wide variety of environments are not yet fully known. If you maintain a Crank renderer, you <em>will</em> have to deal with breaking changes as Crank is optimized and as new renderer requirements are discovered.</p><h2>The Lifecycle of an Element</h2><p>Crank does not provide lifecycle methods or hooks as part of its public interface, instead opting to rely on the natural lifecycle of generator functions. However, we use common lifecycle terms like <em>mounting</em>, <em>updating</em>, <em>unmounting</em> and <em>committing</em> internally to conceptualize the process of rendering.</p><p>Rendering is essentially a depth-first walk of an element tree, where we recursively compare new elements to what was previously rendered. When elements are new to the tree, we <em>mount</em> the element, when elements have been seen before, we <em>update</em> the element, and when elements no longer exist in the tree, they are <em>unmounted.</em></p><p><em>Committing</em> is the part of the rendering process where we actually perform the operations which create, mutate and dispose of nodes. Elements are committed in a <em>post-order traversal</em> of the tree, meaning that by the time a specific element is committed, all of its children will already have been committed as well. This is done so that rendering side-effects happen all at once, even if there are async components in the tree, leading to a more consistent and performant user experience. By contrast, components can be thought of as executing in a <em>pre-order traversal</em> of the tree, because the only way to get the children of a component element is to execute the component.</p><h2>Renderer Type Parameters</h2><p><strong>Note:</strong> Renderer development is considerably more abstract than application development, and using the TypeScript types provided by Crank can make this process much easier to understand. Therefore, this guide both assumes familiarity with TypeScript and uses TypeScript syntax in its examples.</p><p>The <code class="inline">Renderer</code> class takes four type parameters which describe the types of values as they flow in and out of the custom renderer methods.</p><div style="margin: 30px auto;" class="code-block-container"><style data-emotion="css 1vm8pxc">.css-1vm8pxc{max-width:min(100%, 1000px);}</style><div class="css-1vm8pxc"><style data-emotion="css ceqexx">.css-ceqexx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;font-size:16px;}@media (min-width: 800px){.css-ceqexx{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}</style><div class="css-ceqexx"><style data-emotion="css ueqiyu">.css-ueqiyu{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;width:100%;border:1px solid var(--text-color);margin-top:-1px;}</style><div class="css-ueqiyu"><style data-emotion="css 1m42aok">.css-1m42aok{overflow-x:auto;max-width:100%;}</style><div class="css-1m42aok"><style data-emotion="css artqa7">.css-artqa7{position:relative;min-height:100%;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-artqa7"><style data-emotion="css 84ojsb">.css-84ojsb{display:contents;}</style><content-area class="css-84ojsb"><style data-emotion="css 1ashatc">.css-1ashatc{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;word-break:break-all;overflow-wrap:anywhere;line-break:anywhere;white-space:pre-wrap;white-space:break-spaces;font-size:16px;}</style><pre autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="
							language-
							css-1ashatc
						"><style data-emotion="css 1flouoi">.css-1flouoi{border-bottom:1px dotted #333;}.color-scheme-light .css-1flouoi{border-bottom:1px dotted #ddd;}</style><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">class</span> <span class="token class-name">Renderer</span><span class="token operator">&lt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  TNode<span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  TScope <span class="token operator">=</span> unknown<span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  TRoot <span class="token operator">=</span> TNode<span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>  TResult <span class="token operator">=</span> ElementValue<span class="token operator">&lt;</span>TNode<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code><span class="token operator">&gt;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-92" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-92'] = {"code":"class Renderer\u003C\n  TNode,\n  TScope = unknown,\n  TRoot = TNode,\n  TResult = ElementValue\u003CTNode\u003E\n\u003E","lang":"ts"};
		</script></div><h3>TNode</h3><p><code class="inline">TNode</code> is the most important type: it is the type of the node associated with each host element. For instance, for the basic DOM renderer, TNode is the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Node">DOM Node interface</a>.</p><h3>TScope</h3><p><code class="inline">TScope</code> is the type of the <em>scope</em>, a renderer-specific concept for arbitrary data which is passed down the tree between host elements. Scopes are useful for passing contextual information down the tree to be used when nodes are created; for instance, the DOM renderer uses the scope to pass down information about whether we’re currently rendering in an SVG element.</p><h3>TRoot</h3><p><code class="inline">TRoot</code> is the type of the root node. This is the type of the second parameter passed to the <code class="inline">Renderer.render</code> method, and the <code class="inline">root</code> prop passed to <code class="inline">Portal</code> elements. It is usually the same type as <code class="inline">TNode</code> but can vary according to renderer requirements.</p><h3>TResult</h3><p><code class="inline">TResult</code> describes the type of values made visible to renderer consumers. Any time Crank exposes an internal node, for instance, via the <code class="inline">crank-ref</code> callback, or as the result of yield expressions in generator components, the renderer can intercept this access and provide something other than the internal nodes, allowing renderers to hide implementation details and provide results which make more sense for a specific environment.</p><p>For example, the HTML string renderer has an internal node representation, but converts these nodes to strings before they’re exposed to consumers. This is because the internal nodes must be a referentially unique object which is mutated during rendering, while JavaScript strings are referentially transparent and immutable. Therefore, the <code class="inline">TResult</code> type of the HTML renderer is <code class="inline">string</code>.</p><h2>Methods</h2><p>The following is a description of the signatures of internal renderer methods and when they’re executed. When creating a custom renderer, you are expected to override these methods via inheritance.</p><h3>Renderer.prototype.create</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-ceqexx"><div class="css-ueqiyu"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">create</span><span class="token punctuation">(</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token literal-property property">el</span><span class="token operator">:</span> Element<span class="token operator">&lt;</span>string <span class="token operator">|</span> symbol<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token literal-property property">scope</span><span class="token operator">:</span> TScope</code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code><span class="token punctuation">)</span><span class="token operator">:</span> TNode<span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-93" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-93'] = {"code":"create(\n  el: Element\u003Cstring | symbol\u003E, scope: TScope\n): TNode;","lang":"ts"};
		</script></div><p>The <code class="inline">create</code> method is called for each host element the first time the element is committed. This method is passed the current host element and scope, and should return the node which will be associated with the host element. This node will remain constant for an element for as long as the element is rendered.</p><p>By default, this method will throw a <code class="inline">Not Implemented</code> error, so custom renderers should always implement this method.</p><h3>Renderer.prototype.read</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-ceqexx"><div class="css-ueqiyu"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">read</span><span class="token punctuation">(</span>value<span class="token operator">:</span> Array<span class="token operator">&lt;</span>TNode <span class="token operator">|</span> string<span class="token operator">&gt;</span> <span class="token operator">|</span> TNode <span class="token operator">|</span> string <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token operator">:</span> TResult<span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-94" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-94'] = {"code":"read(value: Array\u003CTNode | string\u003E | TNode | string | undefined): TResult;","lang":"ts"};
		</script></div><p>The renderer exposes rendered values in the following places:</p><ul><li>As the return value of the renderer’s <code class="inline">render</code> method.</li><li>As the return value of the context’s <code class="inline">refresh</code> method.</li><li>As the argument passed to <code class="inline">crank-ref</code> props</li><li>As the argument passed to the context’s <code class="inline">schedule</code> and <code class="inline">cleanup</code> callbacks</li><li>Via the context’s <code class="inline">value</code> getter method</li><li>As the yield value of generator components</li></ul><p>When an element or elements are read in this way, we call the <code class="inline">read</code> method to give renderers a final chance to manipulate what is exposed, so as to hide internal implementation details and return something which makes sense for the target environment. The parameter passed to the <code class="inline">read</code> method can be a node, a string, an array of nodes and strings, or <code class="inline">undefined</code>. The return value is what is actually exposed.</p><p>This method is optional. By default, read is an identity function which returns the value passed in.</p><h3>Renderer.prototype.patch</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-ceqexx"><div class="css-ueqiyu"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">patch</span><span class="token punctuation">(</span>el<span class="token operator">:</span> Element<span class="token operator">&lt;</span>string <span class="token operator">|</span> symbol<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token literal-property property">node</span><span class="token operator">:</span> TNode<span class="token punctuation">)</span><span class="token operator">:</span> unknown<span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-95" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-95'] = {"code":"patch(el: Element\u003Cstring | symbol\u003E, node: TNode): unknown;","lang":"ts"};
		</script></div><p>The <code class="inline">patch</code> method is called for each host element whenever it is committed. This method is passed the current host element and its related node, and its return value is ignored. This method is usually where you would mutate the internal node according to the props of the host element.</p><p>Implementation of this method is optional for renderers.</p><h3>Renderer.prototype.arrange</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-ceqexx"><div class="css-ueqiyu"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">arrange</span><span class="token punctuation">(</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token literal-property property">el</span><span class="token operator">:</span> Element<span class="token operator">&lt;</span>string <span class="token operator">|</span> symbol<span class="token operator">&gt;</span><span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  <span class="token literal-property property">parent</span><span class="token operator">:</span> TNode <span class="token operator">|</span> TRoot<span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token literal-property property">children</span><span class="token operator">:</span> Array<span class="token operator">&lt;</span>TNode <span class="token operator">|</span> string<span class="token operator">&gt;</span><span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code><span class="token punctuation">)</span><span class="token operator">:</span> unknown<span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-96" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-96'] = {"code":"arrange(\n  el: Element\u003Cstring | symbol\u003E,\n  parent: TNode | TRoot,\n  children: Array\u003CTNode | string\u003E,\n): unknown;","lang":"ts"};
		</script></div><p>The <code class="inline">arrange</code> method is called whenever an element’s children have changed. It is called with the current host element, the host element’s related node, and the rendered values of all the element’s descendants as an array. In addition to when a host element commits, the <code class="inline">arrange</code> method may also be called when a child refreshes or otherwise causes a host element’s rendered children to change. Because the <code class="inline">arrange</code> method is called for every root/portal element, the parent can be of type <code class="inline">TRoot</code> as well as <code class="inline">TNode</code>.</p><p>This method is where the magic happens, and is where you connect the nodes of your target environment into an internal tree.</p><h3>Renderer.prototype.scope</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-ceqexx"><div class="css-ueqiyu"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">scope</span><span class="token punctuation">(</span>el<span class="token operator">:</span> Element<span class="token operator">&lt;</span>string <span class="token operator">|</span> symbol<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token literal-property property">scope</span><span class="token operator">:</span> TScope <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token operator">:</span> TScope<span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-97" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-97'] = {"code":"scope(el: Element\u003Cstring | symbol\u003E, scope: TScope | undefined): TScope;","lang":"ts"};
		</script></div><p>The <code class="inline">scope</code> method is called for each host or portal element as elements are mounted or updated. Unlike the other custom renderer methods, the <code class="inline">scope</code> method is called during the pre-order traversal of the tree, much as components are. The <code class="inline">scope</code> method is passed the current host element and scope as parameters, and the return value becomes the scope argument passed to the <code class="inline">create</code> and <code class="inline">scope</code> method calls for descendant host elements.</p><p>By default, the <code class="inline">scope</code> method returns <code class="inline">undefined</code>, meaning the scope will be <code class="inline">undefined</code> throughout your application.</p><h3>Renderer.prototype.escape</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-ceqexx"><div class="css-ueqiyu"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">escape</span><span class="token punctuation">(</span>text<span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">scope</span><span class="token operator">:</span> TScope<span class="token punctuation">)</span><span class="token operator">:</span> string<span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-98" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-98'] = {"code":"escape(text: string, scope: TScope): string;","lang":"ts"};
		</script></div><p>The <code class="inline">escape</code> method is called whenever a string is encountered in the element tree. It is mainly useful when creating string-based renderers like an HTML or XML renderer, because most rendering targets like the DOM provide text node interfaces which sanitize inputs by default.</p><p>One important detail is that <code class="inline">escape</code> should not return text nodes or anything besides a string. We defer this step to the <code class="inline">arrange</code> method because this allows the renderer to normalize a host element’s children by concatenating adjacent strings.</p><p>By default, the <code class="inline">escape</code> method returns the string which was passed in.</p><h3>Renderer.prototype.parse</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-ceqexx"><div class="css-ueqiyu"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">parse</span><span class="token punctuation">(</span>text<span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token literal-property property">scope</span><span class="token operator">:</span> TScope<span class="token punctuation">)</span><span class="token operator">:</span> TNode <span class="token operator">|</span> string<span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-99" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-99'] = {"code":"parse(text: string, scope: TScope): TNode | string;","lang":"ts"};
		</script></div><p>When the renderer encounters a <code class="inline">Raw</code> element whose <code class="inline">value</code> prop is a string, it calls the <code class="inline">parse</code> method with that string and the current scope. The return value should be the parsed node, or it can be a string as well, in which case parse will be handled like a string child by parents.</p><p>By default, the <code class="inline">parse</code> method returns the string which was passed in.</p><h3>Renderer.prototype.dispose</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-ceqexx"><div class="css-ueqiyu"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">dispose</span><span class="token punctuation">(</span>el<span class="token operator">:</span> Element<span class="token operator">&lt;</span>string <span class="token operator">|</span> symbol<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token literal-property property">node</span><span class="token operator">:</span> TNode<span class="token punctuation">)</span><span class="token operator">:</span> unknown</code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-100" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-100'] = {"code":"dispose(el: Element\u003Cstring | symbol\u003E, node: TNode): unknown","lang":"ts"};
		</script></div><p>The <code class="inline">dispose</code> method is called whenever a host element is unmounted. It is called with the host element and its related node. You can use this method to manually release a node or clean up event listeners for garbage collection purposes.</p><p>This method is optional and its return value is ignored.</p><h3>Renderer.prototype.complete</h3><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-ceqexx"><div class="css-ueqiyu"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token function">complete</span><span class="token punctuation">(</span>root<span class="token operator">:</span> TRoot<span class="token punctuation">)</span><span class="token operator">:</span> unknown<span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-101" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-101'] = {"code":"complete(root: TRoot): unknown;","lang":"ts"};
		</script></div><p>The <code class="inline">complete</code> method is called at the end of every render execution, when all elements have been committed and all other renderer methods have been called. It is useful, for instance, if your rendering target needs some final code to execute before any mutations take effect.</p><p>This method is optional and its return value is ignored.</p></main><script data-name="static-urls-102" id="static-urls">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['static-urls-102'] = {"@b9g\u002Fcrank":"\u002Fstatic\u002Fcrank-NDXDEUOC.js","@b9g\u002Fcrank\u002Fcrank":"\u002Fstatic\u002Fcrank-NDXDEUOC.js","@b9g\u002Fcrank\u002Fcrank.js":"\u002Fstatic\u002Fcrank-NDXDEUOC.js","@b9g\u002Fcrank\u002Fdom":"\u002Fstatic\u002Fdom-COFNYINC.js","@b9g\u002Fcrank\u002Fdom.js":"\u002Fstatic\u002Fdom-COFNYINC.js","@b9g\u002Fcrank\u002Fhtml":"\u002Fstatic\u002Fhtml-XXFTKZOT.js","@b9g\u002Fcrank\u002Fhtml.js":"\u002Fstatic\u002Fhtml-XXFTKZOT.js","@b9g\u002Fcrank\u002Fjsx-tag":"\u002Fstatic\u002Fjsx-tag-GTGYTP6P.js","@b9g\u002Fcrank\u002Fjsx-tag.js":"\u002Fstatic\u002Fjsx-tag-GTGYTP6P.js","@b9g\u002Fcrank\u002Fjsx-runtime":"\u002Fstatic\u002Fjsx-runtime-7UJITRZ3.js","@b9g\u002Fcrank\u002Fjsx-runtime.js":"\u002Fstatic\u002Fjsx-runtime-7UJITRZ3.js","@b9g\u002Fcrank\u002Fstandalone":"\u002Fstatic\u002Fstandalone-W7CSO6HQ.js","@b9g\u002Fcrank\u002Fstandalone.js":"\u002Fstatic\u002Fstandalone-W7CSO6HQ.js","client.css":"\u002Fstatic\u002Fclient-MPMYQO26.css"};
		</script><script src="/static/code-blocks-WKFXGS3L.js"></script></body></html>