<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Crank.js | Reusable Logic</title><link rel="shortcut icon" href="/static/favicon.ico"><style>.css-1l1hcps{position:fixed;top:0;left:0;right:0;height:50px;z-index:999;gap:1em;}.css-1n0j5y9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:1em;}.css-1xmwt0h{border-bottom:1px solid var(--text-color);overflow-x:auto;background-color:inherit;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;gap:1em;}.css-1xmwt0h a{-webkit-text-decoration:none;text-decoration:none;font-weight:bold;}@media screen and (min-width: 800px){.css-1xmwt0h{padding:0 2em;}}.css-1cvb758{max-width:calc(100% - 1px);}.css-1m42aok{overflow-x:auto;max-width:100%;}.css-artqa7{position:relative;min-height:100%;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.css-84ojsb{display:contents;}.css-1ashatc{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;word-break:break-all;overflow-wrap:anywhere;line-break:anywhere;white-space:pre-wrap;white-space:break-spaces;font-size:16px;}.css-1flouoi{border-bottom:1px dotted #333;}.color-scheme-light .css-1flouoi{border-bottom:1px dotted #ddd;}.css-1nius9d{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100%;}.css-q1dxn8{-webkit-flex:none;-ms-flex:none;flex:none;padding:1em;height:3em;border-bottom:1px solid var(--text-color);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;}.css-j74n8p{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;padding:1em;-webkit-transition:background-color 0.4s ease-out;transition:background-color 0.4s ease-out;background-color:var(--coldark02);width:100%;}.css-hjkbgb{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;border:none;width:100%;background-color:var(--bg-color);}.css-1mkiuoh{margin:0 auto;padding:2rem 0.4rem;}@media screen and (min-width: 800px){.css-1mkiuoh{margin-left:240px;padding:2rem 1rem;margin-top:50px;}}@media screen and (min-width: 1100px){.css-1mkiuoh{margin-left:20rem;padding:3rem 2rem;}}.css-1mkiuoh p{max-width:800px;}.css-1vm8pxc{max-width:min(100%, 1000px);}.css-1s1lac9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;font-size:16px;}@media (min-width: 1300px){.css-1s1lac9{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}.css-18sfz2f{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;width:100%;border:1px solid var(--text-color);margin-top:-1px;margin-right:-1px;}.css-by286k{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;width:100%;border:1px solid var(--text-color);margin-top:-1px;margin-right:-1px;}@media (min-width: 1300px){.css-by286k{max-width:61.8%;}}.css-nuifz8{-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:-webkit-sticky;position:sticky;top:100px;border:1px solid var(--text-color);margin-top:-1px;min-height:50px;width:100%;}@media screen and (min-width: 1300px){.css-nuifz8{width:30%;}}.css-w1ljn4{margin:10px 0;}.css-1l0nd7p{-webkit-text-decoration:none;text-decoration:none;}.css-1wkb9s8{background-color:var(--bg-color);margin-top:50px;padding:2rem 0.4rem;color:var(--text-color);border-right:1px solid currentcolor;border-bottom:1px solid currentcolor;}@media screen and (min-width: 800px){.css-1wkb9s8{position:fixed;top:50px;bottom:0;overflow-x:hidden;overflow-y:auto;width:15rem;margin:0;padding:2rem 1rem;text-align:right;}}@media screen and (min-width: 1100px){.css-1wkb9s8{padding:3rem 2rem;width:20rem;}}.css-1wkb9s8 &gt;:first-child{margin-top:0;}.css-ep9szm{color:var(--highlight-color);margin-top:0;}</style><link href="/static/client-SW6MAMAL.css" rel="stylesheet" type="text/css"><meta name="description" content=""><meta property="og:title" content="Crank.js | Reusable Logic"><meta property="og:url" content="https:/crank.js.org/guides/reusable-logic"><meta property="og:description" content=""><meta property="og:type" content="website"><meta property="og:site_name" content="Crank.js"><meta property="og:image" content="https://crank.js.org/static/logo.svg"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Crank.js | Reusable Logic"><meta name="twitter:description" content=""><meta name="twitter:image" content="https://crank.js.org/static/logo.svg"></head><body><script>
	(() => {
		const colorScheme = sessionStorage.getItem("color-scheme") ||
			(window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches
				? "dark" : "light"
			);
		if (colorScheme === "dark") {
			document.body.classList.remove("color-scheme-light");
		} else {
			document.body.classList.add("color-scheme-light");
		}
	})()</script><div id="navbar-root"><nav class="
				blur-background
				css-1l1hcps
				css-1xmwt0h
			"><div class="css-1n0j5y9"><div><a class="css-1n0j5y9" style="gap: 0.3em" href="/"><svg style="flex: none;" fill="none" viewBox="-200 -200 400 400" width="1.9em" height="1.9em" xmlns="http://www.w3.org/2000/svg"><defs><mask id="wedge-mask"><rect x="-200" y="-200" width="400" height="400" fill="white"></rect><path stroke="none" fill="black" d="
							M 0 0
							L 245.74561328669753 172.07293090531383
							L 245.74561328669753 -172.07293090531383
							z
						"></path></mask></defs><g stroke="none" fill="var(--highlight-color)"><path transform="rotate(0)" d="M 149.39 -16.97 M 149.62 -16.98 M 150.29 -17 M 151.42 -16.97 M 153 -16.85 M 155.02 -16.57 M 157.46 -16.1 M 160.32 -15.39 M 163.56 -14.39 M 167.17 -13.06 M 171.11 -11.35 M 175.36 -9.23 M 179.88 -6.66 M 179.88 6.66 M 175.36 9.23 M 171.11 11.35 M 167.17 13.06 M 163.56 14.39 M 160.32 15.39 M 157.46 16.1 M 155.02 16.57 M 153 16.85 M 151.42 16.97 M 150.29 17 M 149.62 16.98 M 149.39 16.97 A 8 8 0 0 0 144.51 41.5 L 144.73 41.57 L 145.36 41.81 L 146.39 42.27 L 147.8 42.99 L 149.56 44.01 L 151.64 45.38 L 154 47.13 L 156.62 49.29 L 159.44 51.9 L 162.43 54.99 L 165.54 58.58 L 168.73 62.69 L 163.64 74.98 L 158.48 75.64 L 153.74 75.97 L 149.44 76.04 L 145.6 75.89 L 142.22 75.57 L 139.31 75.14 L 136.88 74.63 L 134.91 74.11 L 133.4 73.63 L 132.35 73.22 L 131.73 72.95 L 131.53 72.84 A 8 8 0 0 0 117.63 93.64 L 117.8 93.79 L 118.3 94.25 L 119.07 95.07 L 120.1 96.28 L 121.33 97.9 L 122.73 99.96 L 124.24 102.48 L 125.83 105.48 L 127.44 108.97 L 129.02 112.96 L 130.52 117.47 L 131.9 122.49 L 122.49 131.9 L 117.47 130.52 L 112.96 129.02 L 108.97 127.44 L 105.48 125.83 L 102.48 124.24 L 99.96 122.73 L 97.9 121.33 L 96.28 120.1 L 95.07 119.07 L 94.25 118.3 L 93.79 117.8 L 93.64 117.63 A 8 8 0 0 0 72.84 131.53 L 72.95 131.73 L 73.22 132.35 L 73.63 133.4 L 74.11 134.91 L 74.63 136.88 L 75.14 139.31 L 75.57 142.22 L 75.89 145.6 L 76.04 149.44 L 75.97 153.74 L 75.64 158.48 L 74.98 163.64 L 62.69 168.73 L 58.58 165.54 L 54.99 162.43 L 51.9 159.44 L 49.29 156.62 L 47.13 154 L 45.38 151.64 L 44.01 149.56 L 42.99 147.8 L 42.27 146.39 L 41.81 145.36 L 41.57 144.73 L 41.5 144.51 A 8 8 0 0 0 16.97 149.39 L 16.98 149.62 L 17 150.29 L 16.97 151.42 L 16.85 153 L 16.57 155.02 L 16.1 157.46 L 15.39 160.32 L 14.39 163.56 L 13.06 167.17 L 11.35 171.11 L 9.23 175.36 L 6.66 179.88 L -6.66 179.88 L -9.23 175.36 L -11.35 171.11 L -13.06 167.17 L -14.39 163.56 L -15.39 160.32 L -16.1 157.46 L -16.57 155.02 L -16.85 153 L -16.97 151.42 L -17 150.29 L -16.98 149.62 L -16.97 149.39 A 8 8 0 0 0 -41.5 144.51 L -41.57 144.73 L -41.81 145.36 L -42.27 146.39 L -42.99 147.8 L -44.01 149.56 L -45.38 151.64 L -47.13 154 L -49.29 156.62 L -51.9 159.44 L -54.99 162.43 L -58.58 165.54 L -62.69 168.73 L -74.98 163.64 L -75.64 158.48 L -75.97 153.74 L -76.04 149.44 L -75.89 145.6 L -75.57 142.22 L -75.14 139.31 L -74.63 136.88 L -74.11 134.91 L -73.63 133.4 L -73.22 132.35 L -72.95 131.73 L -72.84 131.53 A 8 8 0 0 0 -93.64 117.63 L -93.79 117.8 L -94.25 118.3 L -95.07 119.07 L -96.28 120.1 L -97.9 121.33 L -99.96 122.73 L -102.48 124.24 L -105.48 125.83 L -108.97 127.44 L -112.96 129.02 L -117.47 130.52 L -122.49 131.9 L -131.9 122.49 L -130.52 117.47 L -129.02 112.96 L -127.44 108.97 L -125.83 105.48 L -124.24 102.48 L -122.73 99.96 L -121.33 97.9 L -120.1 96.28 L -119.07 95.07 L -118.3 94.25 L -117.8 93.79 L -117.63 93.64 A 8 8 0 0 0 -131.53 72.84 L -131.73 72.95 L -132.35 73.22 L -133.4 73.63 L -134.91 74.11 L -136.88 74.63 L -139.31 75.14 L -142.22 75.57 L -145.6 75.89 L -149.44 76.04 L -153.74 75.97 L -158.48 75.64 L -163.64 74.98 L -168.73 62.69 L -165.54 58.58 L -162.43 54.99 L -159.44 51.9 L -156.62 49.29 L -154 47.13 L -151.64 45.38 L -149.56 44.01 L -147.8 42.99 L -146.39 42.27 L -145.36 41.81 L -144.73 41.57 L -144.51 41.5 A 8 8 0 0 0 -149.39 16.97 L -149.62 16.98 L -150.29 17 L -151.42 16.97 L -153 16.85 L -155.02 16.57 L -157.46 16.1 L -160.32 15.39 L -163.56 14.39 L -167.17 13.06 L -171.11 11.35 L -175.36 9.23 L -179.88 6.66 L -179.88 -6.66 L -175.36 -9.23 L -171.11 -11.35 L -167.17 -13.06 L -163.56 -14.39 L -160.32 -15.39 L -157.46 -16.1 L -155.02 -16.57 L -153 -16.85 L -151.42 -16.97 L -150.29 -17 L -149.62 -16.98 L -149.39 -16.97 A 8 8 0 0 0 -144.51 -41.5 L -144.73 -41.57 L -145.36 -41.81 L -146.39 -42.27 L -147.8 -42.99 L -149.56 -44.01 L -151.64 -45.38 L -154 -47.13 L -156.62 -49.29 L -159.44 -51.9 L -162.43 -54.99 L -165.54 -58.58 L -168.73 -62.69 L -163.64 -74.98 L -158.48 -75.64 L -153.74 -75.97 L -149.44 -76.04 L -145.6 -75.89 L -142.22 -75.57 L -139.31 -75.14 L -136.88 -74.63 L -134.91 -74.11 L -133.4 -73.63 L -132.35 -73.22 L -131.73 -72.95 L -131.53 -72.84 A 8 8 0 0 0 -117.63 -93.64 L -117.8 -93.79 L -118.3 -94.25 L -119.07 -95.07 L -120.1 -96.28 L -121.33 -97.9 L -122.73 -99.96 L -124.24 -102.48 L -125.83 -105.48 L -127.44 -108.97 L -129.02 -112.96 L -130.52 -117.47 L -131.9 -122.49 L -122.49 -131.9 L -117.47 -130.52 L -112.96 -129.02 L -108.97 -127.44 L -105.48 -125.83 L -102.48 -124.24 L -99.96 -122.73 L -97.9 -121.33 L -96.28 -120.1 L -95.07 -119.07 L -94.25 -118.3 L -93.79 -117.8 L -93.64 -117.63 A 8 8 0 0 0 -72.84 -131.53 L -72.95 -131.73 L -73.22 -132.35 L -73.63 -133.4 L -74.11 -134.91 L -74.63 -136.88 L -75.14 -139.31 L -75.57 -142.22 L -75.89 -145.6 L -76.04 -149.44 L -75.97 -153.74 L -75.64 -158.48 L -74.98 -163.64 L -62.69 -168.73 L -58.58 -165.54 L -54.99 -162.43 L -51.9 -159.44 L -49.29 -156.62 L -47.13 -154 L -45.38 -151.64 L -44.01 -149.56 L -42.99 -147.8 L -42.27 -146.39 L -41.81 -145.36 L -41.57 -144.73 L -41.5 -144.51 A 8 8 0 0 0 -16.97 -149.39 L -16.98 -149.62 L -17 -150.29 L -16.97 -151.42 L -16.85 -153 L -16.57 -155.02 L -16.1 -157.46 L -15.39 -160.32 L -14.39 -163.56 L -13.06 -167.17 L -11.35 -171.11 L -9.23 -175.36 L -6.66 -179.88 L 6.66 -179.88 L 9.23 -175.36 L 11.35 -171.11 L 13.06 -167.17 L 14.39 -163.56 L 15.39 -160.32 L 16.1 -157.46 L 16.57 -155.02 L 16.85 -153 L 16.97 -151.42 L 17 -150.29 L 16.98 -149.62 L 16.97 -149.39 A 8 8 0 0 0 41.5 -144.51 L 41.57 -144.73 L 41.81 -145.36 L 42.27 -146.39 L 42.99 -147.8 L 44.01 -149.56 L 45.38 -151.64 L 47.13 -154 L 49.29 -156.62 L 51.9 -159.44 L 54.99 -162.43 L 58.58 -165.54 L 62.69 -168.73 L 74.98 -163.64 L 75.64 -158.48 L 75.97 -153.74 L 76.04 -149.44 L 75.89 -145.6 L 75.57 -142.22 L 75.14 -139.31 L 74.63 -136.88 L 74.11 -134.91 L 73.63 -133.4 L 73.22 -132.35 L 72.95 -131.73 L 72.84 -131.53 A 8 8 0 0 0 93.64 -117.63 L 93.79 -117.8 L 94.25 -118.3 L 95.07 -119.07 L 96.28 -120.1 L 97.9 -121.33 L 99.96 -122.73 L 102.48 -124.24 L 105.48 -125.83 L 108.97 -127.44 L 112.96 -129.02 L 117.47 -130.52 L 122.49 -131.9 L 131.9 -122.49 L 130.52 -117.47 L 129.02 -112.96 L 127.44 -108.97 L 125.83 -105.48 L 124.24 -102.48 L 122.73 -99.96 L 121.33 -97.9 L 120.1 -96.28 L 119.07 -95.07 L 118.3 -94.25 L 117.8 -93.79 L 117.63 -93.64 A 8 8 0 0 0 131.53 -72.84 L 131.73 -72.95 L 132.35 -73.22 L 133.4 -73.63 L 134.91 -74.11 L 136.88 -74.63 L 139.31 -75.14 L 142.22 -75.57 L 145.6 -75.89 L 149.44 -76.04 L 153.74 -75.97 L 158.48 -75.64 L 163.64 -74.98 L 168.73 -62.69 L 165.54 -58.58 L 162.43 -54.99 L 159.44 -51.9 L 156.62 -49.29 L 154 -47.13 L 151.64 -45.38 L 149.56 -44.01 L 147.8 -42.99 L 146.39 -42.27 L 145.36 -41.81 L 144.73 -41.57 L 144.51 -41.5 A 8 8 0 0 0 149.39 -16.97 L 149.62 -16.98 L 150.29 -17 L 151.42 -16.97 L 153 -16.85 L 155.02 -16.57 L 157.46 -16.1 L 160.32 -15.39 L 163.56 -14.39 L 167.17 -13.06 L 171.11 -11.35 L 175.36 -9.23 L 179.88 -6.66 L 179.88 6.66 L 175.36 9.23 L 171.11 11.35 L 167.17 13.06 L 163.56 14.39 L 160.32 15.39 L 157.46 16.1 L 155.02 16.57 L 153 16.85 L 151.42 16.97 L 150.29 17 L 149.62 16.98 L 149.39 16.97
			  M -110 0
				a 110 110 0 1 0 220 0
				a 110 110 0 1 0 -220 0
			" mask="url(#wedge-mask)" stroke="none" stroke-width="4"></path><circle cx="0" cy="0" r="60" stroke="none"></circle><path d="
						M 0 -28
						L 160 -14
						L 160 14
						L 0 28
						Z
					"></path></g></svg>Crank.js</a></div><div><a href="/guides/getting-started" aria-current="page">Guides</a></div><div><a href="/blog/">Blog</a></div><div><a href="/playground/">Playground</a></div></div><div class="css-1n0j5y9"><div><a href="https://github.com/bikeshaving/crank">GitHub</a></div><div><a href="http://npm.im/@b9g/crank">NPM</a></div><button role="switch" aria-label="set dark mode" aria-checked="false">⬜</button></div></nav></div><div id="sidebar" class="css-1wkb9s8"><h2 class="css-ep9szm">Guides</h2><div class="css-w1ljn4"><a href="/guides/getting-started" class="css-1l0nd7p">Getting Started</a></div><div class="css-w1ljn4"><a href="/guides/elements" class="css-1l0nd7p">Elements and Renderers</a></div><div class="css-w1ljn4"><a href="/guides/components" class="css-1l0nd7p">Components</a></div><div class="css-w1ljn4"><a href="/guides/handling-events" class="css-1l0nd7p">Handling Events</a></div><div class="css-w1ljn4"><a href="/guides/async-components" class="css-1l0nd7p">Async Components</a></div><div class="css-w1ljn4"><a href="/guides/special-props-and-tags" class="css-1l0nd7p">Special Props and Tags</a></div><div class="css-w1ljn4"><a href="/guides/lifecycles" class="css-1l0nd7p">Lifecycles</a></div><div class="css-w1ljn4"><a href="/guides/hydration" class="css-1l0nd7p">Hydration</a></div><div class="css-w1ljn4"><a href="/guides/reusable-logic" aria-current="page" class="css-1l0nd7p">Reusable Logic</a></div><div class="css-w1ljn4"><a href="/guides/working-with-typescript" class="css-1l0nd7p">Working with TypeScript</a></div><div class="css-w1ljn4"><a href="/guides/custom-renderers" class="css-1l0nd7p">Custom Renderers</a></div><div class="css-w1ljn4"><a href="/guides/reference-for-react-developers" class="css-1l0nd7p">React to Crank Migration Guide</a></div><div class="css-w1ljn4"><a href="/guides/jsx-template-tag" class="css-1l0nd7p">JSX Template Tag</a></div></div><main class="css-1mkiuoh"><h1>Reusable Logic</h1><p>This guide describes additional APIs as well as design patterns for developers who wish to reuse logic between components or write Crank-specific libraries.</p><h2>Additional Context Methods and Properties</h2><p>Crank provides several additional methods and properties via the <code class="inline">Context</code> API to help you share logic between components. Some of the APIs demonstrated here are for library authors and should not be used in the course of typical application development.</p><h3>context.props</h3><p>The current props of a component can be accessed via the readonly context property <code class="inline">props</code>. We recommended that you access props within components via its parameters or context iterators when writing components. The <code class="inline">props</code> property can be useful when you need to access a component’s current props from within an extension or helper function.</p><h3>context.provide and context.consume</h3><p>Crank allows you to provide data to all of a component’s descendants via the methods <code class="inline">provide</code> and <code class="inline">consume</code>. The <code class="inline">provide</code> method sets a “provision” under a specific key, and the <code class="inline">consume</code> method retrieves the value set under a specific key by the nearest ancestor.</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">function</span> <span class="token function">GreetingProvider</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>greeting<span class="token punctuation">,</span> children<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">provide</span><span class="token punctuation">(</span><span class="token string">&quot;greeting&quot;</span><span class="token punctuation">,</span> greeting<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  <span class="token keyword">return</span> children<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code><span class="token keyword">function</span> <span class="token function">Greeting</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>  <span class="token keyword">const</span> greeting <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">consume</span><span class="token punctuation">(</span><span class="token string">&quot;greeting&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span>greeting<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>  <span class="token keyword">return</span> <span class="token punctuation">(</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code>      <span class="token operator">&lt;</span>Greeting name<span class="token operator">=</span><span class="token string">&quot;Brian&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><code>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><code>  <span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="16"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="17"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="18"><code>renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="19"><code>  <span class="token operator">&lt;</span>GreetingProvider greeting<span class="token operator">=</span><span class="token string">&quot;Hello&quot;</span><span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="20"><code>    <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="21"><code>  <span class="token operator">&lt;</span><span class="token operator">/</span>GreetingProvider<span class="token operator">&gt;</span><span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="22"><code>  document<span class="token punctuation">.</span>body<span class="token punctuation">,</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="23"><code><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="24"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="25"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// &quot;&lt;div&gt;&lt;p&gt;Hello, Brian&lt;/p&gt;&lt;/div&gt;&quot;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-208" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-208'] = {"code":"function GreetingProvider({greeting, children}) {\n  this.provide(\"greeting\", greeting);\n  return children;\n}\n\nfunction Greeting({name}) {\n  const greeting = this.consume(\"greeting\");\n  return \u003Cp\u003E{greeting}, {name}\u003C\u002Fp\u003E;\n}\n\nfunction* App() {\n  return (\n    \u003Cdiv\u003E\n      \u003CGreeting name=\"Brian\" \u002F\u003E\n    \u003C\u002Fdiv\u003E\n  );\n}\n\nrenderer.render(\n  \u003CGreetingProvider greeting=\"Hello\"\u003E\n    \u003CApp \u002F\u003E\n  \u003C\u002FGreetingProvider\u003E,\n  document.body,\n);\n\nconsole.log(document.body); \u002F\u002F \"\u003Cdiv\u003E\u003Cp\u003EHello, Brian\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E\"","lang":"ts"};
		</script></div><p>Provisions allow libraries to define components which interact with their descendants without rigidly defined component hierarchies or requiring data to be passed manually between components via props. This makes them useful, for instance, when writing multiple components which communicate with each other, like custom <code class="inline">select</code> and <code class="inline">option</code> form elements, or drag-and-drop components.</p><p>Anything can be passed as a key to the <code class="inline">provide</code> and <code class="inline">consume</code> methods, so you can use a symbol to ensure that the provision you pass between your components are private and do not collide with provisions set by others.</p><p><strong>Note:</strong> Crank does not link “providers” and “consumers” in any way, and doesn’t automatically refresh consumer components when the <code class="inline">provide</code> method is called. It’s up to you to ensure consumers update when providers update.</p><h3>Schedule: Execute After Render</h3><p><strong><code class="inline">context.schedule()</code></strong> - Execute code immediately after component renders.
You can pass a callback to the <code class="inline">schedule()</code> method to listen for when the component renders. Callbacks passed to <code class="inline">schedule</code> fire synchronously after the component renders, with the rendered value of the component as its only argument. Scheduled callbacks fire once per call and callback function per update (think <code class="inline">requestAnimationFrame()</code>, not <code class="inline">setInterval()</code>). This means you have to continuously call the <code class="inline">schedule</code> method for each update if you want to execute some code every time your component commits.</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">Component</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">this</span><span class="token punctuation">,</span> props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span>props <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">schedule</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">div</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>      <span class="token comment">// the div is</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>      div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> props<span class="token punctuation">.</span>innerHTML<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>    <span class="token keyword">yield</span> <span class="token operator">&lt;</span>div <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-209" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-209'] = {"code":"function *Component(this, props) {\n  for await (props of this) {\n    this.schedule((div) =\u003E {\n      \u002F\u002F the div is\n      div.innerHTML = props.innerHTML;\n    });\n    yield \u003Cdiv \u002F\u003E;\n  }\n}","lang":"jsx"};
		</script></div><h3>After: Execute When DOM is Live</h3><p><strong><code class="inline">context.after()</code></strong> - Execute code after DOM is inserted and accessible.
Similar to the <code class="inline">schedule()</code> method, this method fires when rendering has finished. Unlike the <code class="inline">schedule()</code> method, this method fires when a component&#039;s rendered DOM is live. This is useful when you need to do something like calling <code class="inline">focus()</code> on an <code class="inline">&lt;input&gt;</code> element or perform DOM measurement calculations. Callbacks fire once per call and callback function per update.</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1cvb758"><div class="css-1s1lac9"><div class="css-by286k"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>renderer<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@b9g/crank/dom&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">AutoFocusingInput</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  <span class="token comment">// this.schedule does not work because it fires before the input element is</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token comment">// added to the DOM</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>  <span class="token comment">// this.schedule((input) =&gt; input.focus());</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">input</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> input<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>  <span class="token keyword">for</span> <span class="token punctuation">(</span>props <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>    <span class="token keyword">yield</span> <span class="token operator">&lt;</span>input <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>  <span class="token keyword">let</span> initial <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><code>    <span class="token keyword">yield</span> <span class="token punctuation">(</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><code>      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="16"><code>        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="17"><code>          <span class="token punctuation">{</span>initial <span class="token operator">||</span> <span class="token operator">&lt;</span>AutoFocusingInput <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="18"><code>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="19"><code>        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="20"><code>          <span class="token operator">&lt;</span>button onclick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>Refresh<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="21"><code>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="22"><code>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="23"><code>    <span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="24"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="25"><code>    initial <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="26"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="27"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="28"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="29"><code>renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Component <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div><div class="css-nuifz8"><div class="css-1nius9d"><div class="css-q1dxn8"><span>Loading...</span></div><div class="css-j74n8p"><iframe class="
							playground-iframe
							css-hjkbgb
						" style="height: 100px;"></iframe></div></div></div></div></div><script data-name="inline-code-block-props-210" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-210'] = {"code":"import {renderer} from \"@b9g\u002Fcrank\u002Fdom\";\nfunction *AutoFocusingInput(props) {\n  \u002F\u002F this.schedule does not work because it fires before the input element is\n  \u002F\u002F added to the DOM\n  \u002F\u002F this.schedule((input) =\u003E input.focus());\n  this.after((input) =\u003E input.focus());\n  for (props of this) {\n    yield \u003Cinput {...props}\u002F\u003E;\n  }\n}\n\nfunction *Component() {\n  let initial = true;\n  for ({} of this) {\n    yield (\n      \u003Cdiv\u003E\n        \u003Cdiv\u003E\n          {initial || \u003CAutoFocusingInput \u002F\u003E}\n        \u003C\u002Fdiv\u003E\n        \u003Cdiv\u003E\n          \u003Cbutton onclick={() =\u003E this.refresh()}\u003ERefresh\u003C\u002Fbutton\u003E\n        \u003C\u002Fdiv\u003E\n      \u003C\u002Fdiv\u003E\n    );\n\n    initial = false;\n  }\n}\n\nrenderer.render(\u003CComponent \u002F\u003E, document.body);","lang":"jsx live"};
		</script></div><h3>Cleanup: Execute on Unmount</h3><p><strong><code class="inline">context.cleanup()</code></strong> - Execute code when component is unmounted.
Similarly, you can pass a callback to the <code class="inline">cleanup</code> method to listen for when the component unmounts. Callbacks passed to <code class="inline">cleanup</code> fire synchronously when the component is unmounted. Each registered callback fires only once. The callback is called with the last rendered value of the component as its only argument.</p><h2>Strategies for Reusing Logic</h2><p>The following are various patterns you can use to write and reuse logic between components, as well as a description of their tradeoffs. We will be wrapping the global <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setInterval"><code class="inline">window.setInterval</code></a> function in examples to demonstrate each design pattern.</p><h3>Global Context Extensions</h3><p>You can import and extend the Context class’s prototype to globally extend all contexts in your application.</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Context<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@b9g/crank&quot;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code><span class="token keyword">const</span> ContextIntervalSymbol <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">&quot;ContextIntervalSymbol&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code><span class="token class-name">Context</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">setInterval</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> delay<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>`</code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>  <span class="token keyword">const</span> interval <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> delay<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span><span class="token punctuation">[</span>ContextIntervalSymbol<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>    <span class="token keyword">this</span><span class="token punctuation">[</span>ContextIntervalSymbol<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> interval <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">[</span>ContextIntervalSymbol<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>        window<span class="token punctuation">.</span><span class="token function">clearInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>      <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><code>  <span class="token keyword">this</span><span class="token punctuation">[</span>ContextIntervalSymbol<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="16"><code><span class="token punctuation">}</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="17"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="18"><code><span class="token class-name">Context</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">clearInterval</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">interval</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="19"><code>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span><span class="token punctuation">[</span>ContextIntervalSymbol<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="20"><code>    <span class="token keyword">this</span><span class="token punctuation">[</span>ContextIntervalSymbol<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="21"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="22"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="23"><code>  window<span class="token punctuation">.</span><span class="token function">clearInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="24"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="25"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="26"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="27"><code>  <span class="token keyword">let</span> seconds <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="28"><code>  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> seconds<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="29"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="30"><code>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="31"><code>    <span class="token keyword">yield</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Seconds<span class="token operator">:</span> <span class="token punctuation">{</span>seconds<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="32"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="33"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-211" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-211'] = {"code":"import {Context} from \"@b9g\u002Fcrank\";\n\nconst ContextIntervalSymbol = Symbol.for(\"ContextIntervalSymbol\");\n\nContext.prototype.setInterval = function(callback, delay, ...args) {`\n  const interval = window.setInterval(callback, delay, ...args);\n  if (typeof this[ContextIntervalSymbol] === \"undefined\") {\n    this[ContextIntervalSymbol] = new Set();\n    this.cleanup(() =\u003E {\n      for (const interval of this[ContextIntervalSymbol]) {\n        window.clearInterval(interval);\n      }\n    });\n  }\n\n  this[ContextIntervalSymbol].add(interval);\n};\n\nContext.prototype.clearInterval = function(interval) {\n  if (typeof this[ContextIntervalSymbol] !== \"undefined\") {\n    this[ContextIntervalSymbol].delete(interval);\n  }\n\n  window.clearInterval(interval);\n}\n\nfunction *Counter() {\n  let seconds = 0;\n  this.setInterval(() =\u003E this.refresh(() =\u003E seconds++), 1000);\n\n  for ({} of this) {\n    yield \u003Cdiv\u003ESeconds: {seconds}\u003C\u002Fdiv\u003E;\n  }\n}","lang":"ts"};
		</script></div><p>In this example, we define the methods <code class="inline">setInterval</code> and <code class="inline">clearInterval</code> directly the <code class="inline">Context</code> prototype. The <code class="inline">setInterval</code> and <code class="inline">clearInterval</code> methods will now be available to all components.</p><p><strong>Pros:</strong></p><ul><li>Methods are available to every component automatically.</li></ul><p><strong>Cons:</strong></p><ul><li>Globally scoped.</li><li>No way to write setup logic.</li><li>No way to respond to props updates.</li></ul><p>Global context extensions are useful for creating Crank-specific wrappers around already global or otherwise well-known APIs like <code class="inline">setInterval</code>, <code class="inline">requestAnimationFrame</code> or <code class="inline">fetch</code>.</p><h3>Context Helper Utilities</h3><p>As an alternative to global context extensions, you can write utility functions which are passed contexts to scope reusable logic per component. In the following example, instead of defining the <code class="inline">setInterval</code> method globally, we define it locally by passing the context of the component into the <code class="inline">createSetInterval</code> function.</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">function</span> <span class="token function">createSetInterval</span><span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> delay<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">const</span> interval <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span>callback<span class="token punctuation">,</span> delay<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  ctx<span class="token punctuation">.</span><span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> window<span class="token punctuation">.</span><span class="token function">clearInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token keyword">return</span> interval<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>  <span class="token keyword">let</span> seconds <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>  <span class="token keyword">const</span> setInterval <span class="token operator">=</span> <span class="token function">createSetInterval</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> seconds<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>    <span class="token keyword">yield</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Seconds<span class="token operator">:</span> <span class="token punctuation">{</span>seconds<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-212" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-212'] = {"code":"function createSetInterval(ctx, callback, delay, ...args) {\n  const interval = window.setInterval(callback, delay, ...args);\n  ctx.cleanup(() =\u003E window.clearInterval(interval));\n  return interval;\n}\n\nfunction *Counter() {\n  let seconds = 0;\n  const setInterval = createSetInterval(this);\n  setInterval(() =\u003E this.refresh(() =\u003E seconds++), 1000);\n\n  for ({} of this) {\n    yield \u003Cdiv\u003ESeconds: {seconds}\u003C\u002Fdiv\u003E;\n  }\n\n}","lang":"ts"};
		</script></div><p><strong>Pros:</strong></p><ul><li>Locally scoped.</li><li>Explicitly imported and referenced.</li><li>Setup logic can be written directly in the function.</li></ul><p><strong>Cons:</strong></p><ul><li>Naming these functions can be difficult.</li><li>No way to respond to props updates.</li></ul><p>Context helper utilities are useful when you want to write locally-scoped utilities, and are especially well-suited for use-cases which requires setup logic. Possible use-cases include wrappers around stateful APIs like <a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver">mutation observers</a> or <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API">HTML drag and drop</a>.</p><h3>Higher-order Components</h3><p>Because Crank components are just functions, we can write functions which both take components as parameters and return wrapped component functions.</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">function</span> <span class="token function">interval</span><span class="token punctuation">(</span><span class="token parameter">Component</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">WrappedComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>    <span class="token keyword">let</span> seconds <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>    <span class="token keyword">const</span> interval <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> seconds<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>    <span class="token keyword">try</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> props <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>        <span class="token keyword">yield</span> <span class="token operator">&lt;</span>Component seconds<span class="token operator">=</span><span class="token punctuation">{</span>seconds<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>      <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>      window<span class="token punctuation">.</span><span class="token function">clearInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><code>  <span class="token punctuation">}</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><code><span class="token keyword">const</span> Counter <span class="token operator">=</span> <span class="token function">interval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Seconds<span class="token operator">:</span> <span class="token punctuation">{</span>props<span class="token punctuation">.</span>seconds<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-213" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-213'] = {"code":"function interval(Component) {\n  return function *WrappedComponent() {\n    let seconds = 0;\n    const interval = window.setInterval(() =\u003E this.refresh(() =\u003E seconds++), 1000)\n    try {\n      for (const props of this) {\n        yield \u003CComponent seconds={seconds} {...props}\u002F\u003E;\n      }\n    } finally {\n      window.clearInterval(interval);\n    }\n  };\n}\n\nconst Counter = interval((props) =\u003E \u003Cdiv\u003ESeconds: {props.seconds}\u003C\u002Fdiv\u003E);","lang":"ts"};
		</script></div><p>The interval function takes a component function and returns a component which passes the number of seconds as a prop. Additionally, it refreshes the returned component whenever the interval is fired.</p><p><strong>Pros:</strong></p><ul><li>Locally scoped.</li><li>Explicitly imported and referenced.</li><li>Able to respond to new props within the returned component.</li></ul><p><strong>Cons:</strong></p><ul><li>Naming higher-order functions can be difficult.</li><li>JavaScript doesn’t provide an easy syntax for decorating functions.</li><li>Props passed into the component by the wrapper may clash with the component’s own expected props.</li></ul><p>The main advantage of higher-order components is that you can respond to props in your utilities just like you would with a component. Higher-order components are most useful when you need reusable logic which responds to prop updates or sets only well-known props. Possible use-cases include styled component or animation libraries.</p><h3>Async Iterators</h3><p>Because components can be written as async generator functions, you can integrate utility functions which return async iterators seamlessly with Crank. Async iterators are a great way to model resources because they define a standard way for releasing resources when they’re no longer needed by returning the iterator.</p><div style="margin: 30px auto;" class="code-block-container"><div class="css-1vm8pxc"><div class="css-1s1lac9"><div class="css-18sfz2f"><div class="css-1m42aok"><div class="css-artqa7"><content-area class="css-84ojsb"><pre autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" class="
							language-
							css-1ashatc
						"><div class="
				prism-line
				css-1flouoi
			" data-index="0"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">createInterval</span><span class="token punctuation">(</span><span class="token parameter">delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="1"><code>  <span class="token keyword">let</span> available <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="2"><code>  <span class="token keyword">let</span> resolve<span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="3"><code>  <span class="token keyword">const</span> interval <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="4"><code>    <span class="token keyword">if</span> <span class="token punctuation">(</span>resolve<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="5"><code>      <span class="token function">resolve</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="6"><code>      resolve <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="7"><code>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="8"><code>      available <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="9"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="10"><code>  <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="11"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="12"><code>  <span class="token keyword">try</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="13"><code>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="14"><code>      <span class="token keyword">if</span> <span class="token punctuation">(</span>available<span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="15"><code>        available <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="16"><code>        <span class="token keyword">yield</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="17"><code>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="18"><code>        <span class="token keyword">yield</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve1</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>resolve <span class="token operator">=</span> resolve1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="19"><code>      <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="20"><code>    <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="21"><code>  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="22"><code>    window<span class="token punctuation">.</span><span class="token function">clearInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="23"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="24"><code><span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="25"><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="26"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">Counter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="27"><code>  <span class="token keyword">let</span> seconds <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="28"><code>  <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">const</span> _ <span class="token keyword">of</span> <span class="token function">createInterval</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="29"><code>    <span class="token keyword">yield</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Seconds<span class="token operator">:</span> <span class="token punctuation">{</span>seconds<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="30"><code>    seconds<span class="token operator">++</span><span class="token punctuation">;</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="31"><code>  <span class="token punctuation">}</span></code><br></div><div class="
				prism-line
				css-1flouoi
			" data-index="32"><code><span class="token punctuation">}</span></code><br></div></pre></content-area></div></div></div></div></div><script data-name="inline-code-block-props-214" class="props">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['inline-code-block-props-214'] = {"code":"async function *createInterval(delay) {\n  let available = true;\n  let resolve;\n  const interval = window.setInterval(() =\u003E {\n    if (resolve) {\n      resolve(Date.now());\n      resolve = undefined;\n    } else {\n      available = true;\n    }\n  }, delay);\n\n  try {\n    while (true) {\n      if (available) {\n        available = false;\n        yield Date.now();\n      } else {\n        yield new Promise((resolve1) =\u003E (resolve = resolve1));\n      }\n    }\n  } finally {\n    window.clearInterval(interval);\n  }\n}\n\nasync function *Counter() {\n  let seconds = 0;\n  for await (const _ of createInterval(1000)) {\n    yield \u003Cdiv\u003ESeconds: {seconds}\u003C\u002Fdiv\u003E;\n    seconds++;\n  }\n}","lang":"ts"};
		</script></div><p><strong>Pros:</strong></p><ul><li>Async iterator utilities are framework-agnostic.</li><li>Uniform way to hold and release resources.</li></ul><p><strong>Cons:</strong></p><ul><li>Promises and async iterators can cause race conditions and deadlocks, without any language-level features to help you debug them.</li></ul><p>If you use async iterators/generators already, Crank is the perfect framework for your application.</p></main><script data-name="static-urls-215" id="static-urls">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['static-urls-215'] = {"@b9g\u002Fcrank":"\u002Fstatic\u002Fcrank-TSN5N23D.js","@b9g\u002Fcrank.js":"\u002Fstatic\u002Fcrank-TSN5N23D.js","@b9g\u002Fcrank\u002Fasync":"\u002Fstatic\u002Fasync-W3LNLUZH.js","@b9g\u002Fcrank\u002Fasync.js":"\u002Fstatic\u002Fasync-W3LNLUZH.js","@b9g\u002Fcrank\u002Fcrank":"\u002Fstatic\u002Fcrank-TSN5N23D.js","@b9g\u002Fcrank\u002Fcrank.js":"\u002Fstatic\u002Fcrank-TSN5N23D.js","@b9g\u002Fcrank\u002Fdom":"\u002Fstatic\u002Fdom-7V3LTQVJ.js","@b9g\u002Fcrank\u002Fdom.js":"\u002Fstatic\u002Fdom-7V3LTQVJ.js","@b9g\u002Fcrank\u002Fevent-target":"\u002Fstatic\u002Fevent-target-5MX2UJ7P.js","@b9g\u002Fcrank\u002Fevent-target.js":"\u002Fstatic\u002Fevent-target-5MX2UJ7P.js","@b9g\u002Fcrank\u002Fhtml":"\u002Fstatic\u002Fhtml-DDEIJD5A.js","@b9g\u002Fcrank\u002Fhtml.js":"\u002Fstatic\u002Fhtml-DDEIJD5A.js","@b9g\u002Fcrank\u002Fjsx-dev-runtime":"\u002Fstatic\u002Fjsx-runtime-63F5RQQ5.js","@b9g\u002Fcrank\u002Fjsx-dev-runtime.js":"\u002Fstatic\u002Fjsx-runtime-63F5RQQ5.js","@b9g\u002Fcrank\u002Fjsx-runtime":"\u002Fstatic\u002Fjsx-runtime-63F5RQQ5.js","@b9g\u002Fcrank\u002Fjsx-runtime.js":"\u002Fstatic\u002Fjsx-runtime-63F5RQQ5.js","@b9g\u002Fcrank\u002Fjsx-tag":"\u002Fstatic\u002Fjsx-tag-R4BGVRYM.js","@b9g\u002Fcrank\u002Fjsx-tag.js":"\u002Fstatic\u002Fjsx-tag-R4BGVRYM.js","@b9g\u002Fcrank\u002Fstandalone":"\u002Fstatic\u002Fstandalone-G5GWZDX2.js","@b9g\u002Fcrank\u002Fstandalone.js":"\u002Fstatic\u002Fstandalone-G5GWZDX2.js","client.css":"\u002Fstatic\u002Fclient-SW6MAMAL.css"};
		</script><script src="/static/navbar-2JSON5VQ.js"></script><script src="/static/code-blocks-FAKPZDHG.js"></script></body></html>