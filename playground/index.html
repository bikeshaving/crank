<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><title>Crank.js</title><link rel="shortcut icon" href="/static/favicon.ico"><style>.css-1l1hcps{position:fixed;top:0;left:0;right:0;height:50px;z-index:999;gap:1em;}.css-1n0j5y9{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;gap:1em;}.css-1xmwt0h{border-bottom:1px solid var(--text-color);overflow-x:auto;background-color:inherit;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;gap:1em;}.css-1xmwt0h a{-webkit-text-decoration:none;text-decoration:none;font-weight:bold;}@media screen and (min-width: 800px){.css-1xmwt0h{padding:0 2em;}}</style><link href="/static/client-PG5TN3NC.css" rel="stylesheet" type="text/css"><meta property="og:title" content="Crank.js"><meta property="og:url" content="https:/crank.js.org/playground"><meta property="og:description" content=""></head><body><script>
	(() => {
		const colorScheme = sessionStorage.getItem("color-scheme") ||
			(window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches
				? "dark" : "light"
			);
		if (colorScheme === "dark") {
			document.body.classList.remove("color-scheme-light");
		} else {
			document.body.classList.add("color-scheme-light");
		}
	})()</script><div id="navbar-root"><nav class="
				blur-background
				css-1l1hcps
				css-1xmwt0h
			"><div class="css-1n0j5y9"><div><a class="css-1n0j5y9" style="gap: 0.3em" href="/"><svg style="flex: none;" fill="none" viewBox="-200 -200 400 400" width="1.9em" height="1.9em" xmlns="http://www.w3.org/2000/svg"><defs><mask id="wedge-mask"><rect x="-200" y="-200" width="400" height="400" fill="white"></rect><path stroke="none" fill="black" d="
							M 0 0
							L 245.74561328669753 172.07293090531383
							L 245.74561328669753 -172.07293090531383
							z
						"></path></mask></defs><g stroke="none" fill="var(--highlight-color)"><path transform="rotate(0)" d="M 149.39 -16.97 M 149.62 -16.98 M 150.29 -17 M 151.42 -16.97 M 153 -16.85 M 155.02 -16.57 M 157.46 -16.1 M 160.32 -15.39 M 163.56 -14.39 M 167.17 -13.06 M 171.11 -11.35 M 175.36 -9.23 M 179.88 -6.66 M 179.88 6.66 M 175.36 9.23 M 171.11 11.35 M 167.17 13.06 M 163.56 14.39 M 160.32 15.39 M 157.46 16.1 M 155.02 16.57 M 153 16.85 M 151.42 16.97 M 150.29 17 M 149.62 16.98 M 149.39 16.97 A 8 8 0 0 0 144.51 41.5 L 144.73 41.57 L 145.36 41.81 L 146.39 42.27 L 147.8 42.99 L 149.56 44.01 L 151.64 45.38 L 154 47.13 L 156.62 49.29 L 159.44 51.9 L 162.43 54.99 L 165.54 58.58 L 168.73 62.69 L 163.64 74.98 L 158.48 75.64 L 153.74 75.97 L 149.44 76.04 L 145.6 75.89 L 142.22 75.57 L 139.31 75.14 L 136.88 74.63 L 134.91 74.11 L 133.4 73.63 L 132.35 73.22 L 131.73 72.95 L 131.53 72.84 A 8 8 0 0 0 117.63 93.64 L 117.8 93.79 L 118.3 94.25 L 119.07 95.07 L 120.1 96.28 L 121.33 97.9 L 122.73 99.96 L 124.24 102.48 L 125.83 105.48 L 127.44 108.97 L 129.02 112.96 L 130.52 117.47 L 131.9 122.49 L 122.49 131.9 L 117.47 130.52 L 112.96 129.02 L 108.97 127.44 L 105.48 125.83 L 102.48 124.24 L 99.96 122.73 L 97.9 121.33 L 96.28 120.1 L 95.07 119.07 L 94.25 118.3 L 93.79 117.8 L 93.64 117.63 A 8 8 0 0 0 72.84 131.53 L 72.95 131.73 L 73.22 132.35 L 73.63 133.4 L 74.11 134.91 L 74.63 136.88 L 75.14 139.31 L 75.57 142.22 L 75.89 145.6 L 76.04 149.44 L 75.97 153.74 L 75.64 158.48 L 74.98 163.64 L 62.69 168.73 L 58.58 165.54 L 54.99 162.43 L 51.9 159.44 L 49.29 156.62 L 47.13 154 L 45.38 151.64 L 44.01 149.56 L 42.99 147.8 L 42.27 146.39 L 41.81 145.36 L 41.57 144.73 L 41.5 144.51 A 8 8 0 0 0 16.97 149.39 L 16.98 149.62 L 17 150.29 L 16.97 151.42 L 16.85 153 L 16.57 155.02 L 16.1 157.46 L 15.39 160.32 L 14.39 163.56 L 13.06 167.17 L 11.35 171.11 L 9.23 175.36 L 6.66 179.88 L -6.66 179.88 L -9.23 175.36 L -11.35 171.11 L -13.06 167.17 L -14.39 163.56 L -15.39 160.32 L -16.1 157.46 L -16.57 155.02 L -16.85 153 L -16.97 151.42 L -17 150.29 L -16.98 149.62 L -16.97 149.39 A 8 8 0 0 0 -41.5 144.51 L -41.57 144.73 L -41.81 145.36 L -42.27 146.39 L -42.99 147.8 L -44.01 149.56 L -45.38 151.64 L -47.13 154 L -49.29 156.62 L -51.9 159.44 L -54.99 162.43 L -58.58 165.54 L -62.69 168.73 L -74.98 163.64 L -75.64 158.48 L -75.97 153.74 L -76.04 149.44 L -75.89 145.6 L -75.57 142.22 L -75.14 139.31 L -74.63 136.88 L -74.11 134.91 L -73.63 133.4 L -73.22 132.35 L -72.95 131.73 L -72.84 131.53 A 8 8 0 0 0 -93.64 117.63 L -93.79 117.8 L -94.25 118.3 L -95.07 119.07 L -96.28 120.1 L -97.9 121.33 L -99.96 122.73 L -102.48 124.24 L -105.48 125.83 L -108.97 127.44 L -112.96 129.02 L -117.47 130.52 L -122.49 131.9 L -131.9 122.49 L -130.52 117.47 L -129.02 112.96 L -127.44 108.97 L -125.83 105.48 L -124.24 102.48 L -122.73 99.96 L -121.33 97.9 L -120.1 96.28 L -119.07 95.07 L -118.3 94.25 L -117.8 93.79 L -117.63 93.64 A 8 8 0 0 0 -131.53 72.84 L -131.73 72.95 L -132.35 73.22 L -133.4 73.63 L -134.91 74.11 L -136.88 74.63 L -139.31 75.14 L -142.22 75.57 L -145.6 75.89 L -149.44 76.04 L -153.74 75.97 L -158.48 75.64 L -163.64 74.98 L -168.73 62.69 L -165.54 58.58 L -162.43 54.99 L -159.44 51.9 L -156.62 49.29 L -154 47.13 L -151.64 45.38 L -149.56 44.01 L -147.8 42.99 L -146.39 42.27 L -145.36 41.81 L -144.73 41.57 L -144.51 41.5 A 8 8 0 0 0 -149.39 16.97 L -149.62 16.98 L -150.29 17 L -151.42 16.97 L -153 16.85 L -155.02 16.57 L -157.46 16.1 L -160.32 15.39 L -163.56 14.39 L -167.17 13.06 L -171.11 11.35 L -175.36 9.23 L -179.88 6.66 L -179.88 -6.66 L -175.36 -9.23 L -171.11 -11.35 L -167.17 -13.06 L -163.56 -14.39 L -160.32 -15.39 L -157.46 -16.1 L -155.02 -16.57 L -153 -16.85 L -151.42 -16.97 L -150.29 -17 L -149.62 -16.98 L -149.39 -16.97 A 8 8 0 0 0 -144.51 -41.5 L -144.73 -41.57 L -145.36 -41.81 L -146.39 -42.27 L -147.8 -42.99 L -149.56 -44.01 L -151.64 -45.38 L -154 -47.13 L -156.62 -49.29 L -159.44 -51.9 L -162.43 -54.99 L -165.54 -58.58 L -168.73 -62.69 L -163.64 -74.98 L -158.48 -75.64 L -153.74 -75.97 L -149.44 -76.04 L -145.6 -75.89 L -142.22 -75.57 L -139.31 -75.14 L -136.88 -74.63 L -134.91 -74.11 L -133.4 -73.63 L -132.35 -73.22 L -131.73 -72.95 L -131.53 -72.84 A 8 8 0 0 0 -117.63 -93.64 L -117.8 -93.79 L -118.3 -94.25 L -119.07 -95.07 L -120.1 -96.28 L -121.33 -97.9 L -122.73 -99.96 L -124.24 -102.48 L -125.83 -105.48 L -127.44 -108.97 L -129.02 -112.96 L -130.52 -117.47 L -131.9 -122.49 L -122.49 -131.9 L -117.47 -130.52 L -112.96 -129.02 L -108.97 -127.44 L -105.48 -125.83 L -102.48 -124.24 L -99.96 -122.73 L -97.9 -121.33 L -96.28 -120.1 L -95.07 -119.07 L -94.25 -118.3 L -93.79 -117.8 L -93.64 -117.63 A 8 8 0 0 0 -72.84 -131.53 L -72.95 -131.73 L -73.22 -132.35 L -73.63 -133.4 L -74.11 -134.91 L -74.63 -136.88 L -75.14 -139.31 L -75.57 -142.22 L -75.89 -145.6 L -76.04 -149.44 L -75.97 -153.74 L -75.64 -158.48 L -74.98 -163.64 L -62.69 -168.73 L -58.58 -165.54 L -54.99 -162.43 L -51.9 -159.44 L -49.29 -156.62 L -47.13 -154 L -45.38 -151.64 L -44.01 -149.56 L -42.99 -147.8 L -42.27 -146.39 L -41.81 -145.36 L -41.57 -144.73 L -41.5 -144.51 A 8 8 0 0 0 -16.97 -149.39 L -16.98 -149.62 L -17 -150.29 L -16.97 -151.42 L -16.85 -153 L -16.57 -155.02 L -16.1 -157.46 L -15.39 -160.32 L -14.39 -163.56 L -13.06 -167.17 L -11.35 -171.11 L -9.23 -175.36 L -6.66 -179.88 L 6.66 -179.88 L 9.23 -175.36 L 11.35 -171.11 L 13.06 -167.17 L 14.39 -163.56 L 15.39 -160.32 L 16.1 -157.46 L 16.57 -155.02 L 16.85 -153 L 16.97 -151.42 L 17 -150.29 L 16.98 -149.62 L 16.97 -149.39 A 8 8 0 0 0 41.5 -144.51 L 41.57 -144.73 L 41.81 -145.36 L 42.27 -146.39 L 42.99 -147.8 L 44.01 -149.56 L 45.38 -151.64 L 47.13 -154 L 49.29 -156.62 L 51.9 -159.44 L 54.99 -162.43 L 58.58 -165.54 L 62.69 -168.73 L 74.98 -163.64 L 75.64 -158.48 L 75.97 -153.74 L 76.04 -149.44 L 75.89 -145.6 L 75.57 -142.22 L 75.14 -139.31 L 74.63 -136.88 L 74.11 -134.91 L 73.63 -133.4 L 73.22 -132.35 L 72.95 -131.73 L 72.84 -131.53 A 8 8 0 0 0 93.64 -117.63 L 93.79 -117.8 L 94.25 -118.3 L 95.07 -119.07 L 96.28 -120.1 L 97.9 -121.33 L 99.96 -122.73 L 102.48 -124.24 L 105.48 -125.83 L 108.97 -127.44 L 112.96 -129.02 L 117.47 -130.52 L 122.49 -131.9 L 131.9 -122.49 L 130.52 -117.47 L 129.02 -112.96 L 127.44 -108.97 L 125.83 -105.48 L 124.24 -102.48 L 122.73 -99.96 L 121.33 -97.9 L 120.1 -96.28 L 119.07 -95.07 L 118.3 -94.25 L 117.8 -93.79 L 117.63 -93.64 A 8 8 0 0 0 131.53 -72.84 L 131.73 -72.95 L 132.35 -73.22 L 133.4 -73.63 L 134.91 -74.11 L 136.88 -74.63 L 139.31 -75.14 L 142.22 -75.57 L 145.6 -75.89 L 149.44 -76.04 L 153.74 -75.97 L 158.48 -75.64 L 163.64 -74.98 L 168.73 -62.69 L 165.54 -58.58 L 162.43 -54.99 L 159.44 -51.9 L 156.62 -49.29 L 154 -47.13 L 151.64 -45.38 L 149.56 -44.01 L 147.8 -42.99 L 146.39 -42.27 L 145.36 -41.81 L 144.73 -41.57 L 144.51 -41.5 A 8 8 0 0 0 149.39 -16.97 L 149.62 -16.98 L 150.29 -17 L 151.42 -16.97 L 153 -16.85 L 155.02 -16.57 L 157.46 -16.1 L 160.32 -15.39 L 163.56 -14.39 L 167.17 -13.06 L 171.11 -11.35 L 175.36 -9.23 L 179.88 -6.66 L 179.88 6.66 L 175.36 9.23 L 171.11 11.35 L 167.17 13.06 L 163.56 14.39 L 160.32 15.39 L 157.46 16.1 L 155.02 16.57 L 153 16.85 L 151.42 16.97 L 150.29 17 L 149.62 16.98 L 149.39 16.97
			  M -110 0
				a 110 110 0 1 0 220 0
				a 110 110 0 1 0 -220 0
			" mask="url(#wedge-mask)" stroke="none" stroke-width="4"></path><circle cx="0" cy="0" r="60" stroke="none"></circle><path d="
						M 0 -28
						L 160 -14
						L 160 14
						L 0 28
						Z
					"></path></g></svg>Crank.js</a></div><div><a href="/guides/getting-started">Guides</a></div><div><a href="/blog/">Blog</a></div><div><a href="/playground/" aria-current="page">Playground</a></div></div><div class="css-1n0j5y9"><div><a href="https://github.com/bikeshaving/crank">GitHub</a></div><div><a href="http://npm.im/@b9g/crank">NPM</a></div><button role="switch" aria-label="set dark mode" aria-checked="false">⬜</button></div></nav></div><div id="playground"></div><script data-name="embedded-json-9" id="examples">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['embedded-json-9'] = [{"name":"timer","label":"Timer","code":"import {renderer} from \"@b9g\u002Fcrank\u002Fdom\";\n\nfunction *Timer() {\n  let seconds = 0;\n  const interval = setInterval(() =\u003E {\n    seconds++;\n    this.refresh();\n  }, 1000);\n\n  for ({} of this) {\n    yield \u003Cdiv\u003E{seconds}\u003C\u002Fdiv\u003E;\n  }\n\n  clearInterval(interval);\n}\n\nrenderer.render(\u003CTimer \u002F\u003E, document.body);"},{"name":"tetris","label":"Tetris","code":"import {jsx} from \"@b9g\u002Fcrank\u002Fstandalone\";\nimport {renderer} from \"@b9g\u002Fcrank\u002Fdom\";\n\n\u002F\u002F tetronimo shapes represented as 2d arrays\ntype Tet = number[][];\nconst tets: Record\u003Cstring, Tet\u003E = {\n\tI: [\n\t\t[0, 0, 0, 0],\n\t\t[1, 1, 1, 1],\n\t\t[0, 0, 0, 0],\n\t\t[0, 0, 0, 0],\n\t],\n\tO: [\n\t\t[1, 1],\n\t\t[1, 1],\n\t],\n\tT: [\n\t\t[0, 1, 0],\n\t\t[1, 1, 1],\n\t\t[0, 0, 0],\n\t],\n\tJ: [\n\t\t[0, 0, 1],\n\t\t[1, 1, 1],\n\t\t[0, 0, 0],\n\t],\n\tL: [\n\t\t[1, 0, 0],\n\t\t[1, 1, 1],\n\t\t[0, 0, 0],\n\t],\n\tS: [\n\t\t[0, 1, 1],\n\t\t[1, 1, 0],\n\t\t[0, 0, 0],\n\t],\n\tZ: [\n\t\t[1, 1, 0],\n\t\t[0, 1, 1],\n\t\t[0, 0, 0],\n\t],\n};\n\nfunction randomTet() {\n\tconst tetValues = Array.from(Object.values(tets));\n\treturn tetValues[Math.floor(Math.random() * tetValues.length)];\n}\n\nfunction transpose(tet: Tet): Tet {\n\treturn tet.map((row, r) =\u003E row.map((cell, c) =\u003E tet[c][r]));\n}\n\nfunction reflectY(tet: Tet): Tet {\n\treturn tet.map((row, r) =\u003E row.map((cell, c) =\u003E tet[tet.length - r - 1][c]));\n}\n\n\u002F\u002F TODO: combine rotate90 and rotate270\nfunction rotate90(tet: Tet): Tet {\n\treturn reflectY(transpose(tet));\n}\n\nfunction rotate270(tet: Tet): Tet {\n\treturn transpose(reflectY(tet));\n}\n\ninterface Piece {\n\ttet: Tet;\n\tx: number;\n\ty: number;\n}\n\n\u002F\u002F SVG coordinates, so top row is 0 and bottom row is field.length - 1;\ntype Field = number[][];\n\nfunction canFit(piece: Piece, field: Field): boolean {\n\tfor (const [c, r] of squaresOf(piece)) {\n\t\tif (r \u003C 0) {\n\t\t\t\u002F\u002F square is above the board\n\t\t\treturn false;\n\t\t} else if (r \u003E= field.length) {\n\t\t\t\u002F\u002F square is below the board\n\t\t\treturn false;\n\t\t} else if (c \u003C 0) {\n\t\t\t\u002F\u002F square is left of board\n\t\t\treturn false;\n\t\t} else if (c \u003E= field[0].length) {\n\t\t\t\u002F\u002F square is right of board\n\t\t\treturn false;\n\t\t} else if (field[r][c]) {\n\t\t\t\u002F\u002F square is occupied\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction squaresOf(piece: Piece): [x: number, y: number][] {\n\tconst squares = [];\n\tfor (let r = 0; r \u003C piece.tet.length; r++) {\n\t\tconst row = piece.tet[r];\n\t\tfor (let c = 0; c \u003C row.length; c++) {\n\t\t\tconst data = row[c];\n\t\t\tif (data) {\n\t\t\t\tsquares.push([c + piece.x, r + piece.y]);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn squares;\n}\n\nfunction createPiece(): Piece {\n\t\u002F\u002F TODO: piece sequences\n\treturn {\n\t\ttet: randomTet(),\n\t\tx: 3,\n\t\ty: 0,\n\t};\n}\n\nfunction placePiece(piece: Piece, field: Field) {\n\tfor (const [c, r] of squaresOf(piece)) {\n\t\tfield[r][c] = true;\n\t}\n\n\tclearFilledRows(field);\n}\n\nfunction clearFilledRows(field: Field) {\n\tfor (let r = 0; r \u003C field.length; r++) {\n\t\tconst row = field[r];\n\t\tif (row.every((d) =\u003E d)) {\n\t\t\t\u002F\u002F copy previous rows into next rows\n\t\t\tfor (let r1 = r; r1 \u003E 0; r1--) {\n\t\t\t\tfield[r1] = field[r1 - 1];\n\t\t\t}\n\n\t\t\t\u002F\u002F clear the top row\n\t\t\tfield[0] = field[0].map(() =\u003E false);\n\t\t}\n\t}\n}\n\nconst UNIT = 20;\nconst WIDTH = 10;\nconst HEIGHT = 24;\n\nfunction Piece({piece}) {\n\t\u002F\u002F TODO: colored pieces\n\treturn jsx`\n    \u003Cg fill=\"red\"\u003E\n      ${squaresOf(piece).map(\n\t\t\t\t([c, r]) =\u003E jsx`\n        \u003Crect\n          width=${UNIT}\n          height=${UNIT}\n          transform=\"translate(${c * UNIT}, ${r * UNIT})\"\n        \u002F\u003E\n      `,\n\t\t\t)}\n    \u003C\u002Fg\u003E\n  `;\n}\n\nfunction Board({field}) {\n\treturn field.map((row, r) =\u003E\n\t\trow.map(\n\t\t\t(data, c) =\u003E jsx`\n      \u003Crect\n        width=${UNIT}\n        height=${UNIT}\n        fill=${data && \"blue\"}\n        x=${c * UNIT}\n        y=${r * UNIT}\n      \u002F\u003E\n    `,\n\t\t),\n\t);\n}\n\nfunction* App() {\n\tlet currentPiece = createPiece();\n\tconst field = Array.from(Array(HEIGHT), () =\u003E\n\t\tArray.from(Array(WIDTH), () =\u003E false),\n\t);\n\n\tconst interval = setInterval(() =\u003E {\n\t\tcurrentPiece.y++;\n\t\tif (!canFit(currentPiece, field)) {\n\t\t\tcurrentPiece.y--;\n\t\t\tplacePiece(currentPiece, field);\n\t\t\t\u002F\u002F TODO: game over check\n\t\t\tcurrentPiece = createPiece();\n\t\t}\n\t\tthis.refresh();\n\t}, 1000);\n\tthis.cleanup(() =\u003E clearInterval(interval));\n\n\tconst keydown = (ev) =\u003E {\n\t\tif (ev.key === \"w\") {\n\t\t\t\u002F\u002F rotate left\n\t\t\t\u002F\u002F TODO: wall kicks to allow rotations at the edge\n\t\t\tcurrentPiece.tet = rotate90(currentPiece.tet);\n\t\t\tif (!canFit(currentPiece, field)) {\n\t\t\t\tcurrentPiece.tet = rotate270(currentPiece.tet);\n\t\t\t}\n\t\t} else if (ev.key === \"e\") {\n\t\t\t\u002F\u002F rotate right\n\t\t\t\u002F\u002F TODO: wall kicks to allow rotations at the edge\n\t\t\tcurrentPiece.tet = rotate270(currentPiece.tet);\n\t\t\tif (!canFit(currentPiece, field)) {\n\t\t\t\tcurrentPiece.tet = rotate90(currentPiece.tet);\n\t\t\t}\n\t\t} else if (ev.key === \"a\") {\n\t\t\t\u002F\u002F move left\n\t\t\tcurrentPiece.x--;\n\t\t\tif (!canFit(currentPiece, field)) {\n\t\t\t\tcurrentPiece.x++;\n\t\t\t}\n\t\t} else if (ev.key === \"s\") {\n\t\t\t\u002F\u002F move down\n\t\t\tcurrentPiece.y++;\n\t\t\tif (!canFit(currentPiece, field)) {\n\t\t\t\tcurrentPiece.y--;\n\t\t\t\tplacePiece(currentPiece, field);\n\t\t\t\tcurrentPiece = createPiece();\n\t\t\t}\n\t\t} else if (ev.key === \"d\") {\n\t\t\t\u002F\u002F move right\n\t\t\tcurrentPiece.x++;\n\t\t\tif (!canFit(currentPiece, field)) {\n\t\t\t\tcurrentPiece.x--;\n\t\t\t}\n\t\t}\n\n\t\t\u002F\u002F TODO: hard drop\n\t\tthis.refresh();\n\t};\n\n\twindow.addEventListener(\"keydown\", keydown);\n\tthis.cleanup(() =\u003E window.removeEventListener(\"keydown\", keydown));\n\n\tfor ({} of this) {\n\t\t\u002F\u002F TODO: game start\u002Fgame over\n\t\t\u002F\u002F TODO: piece placement preview\n\t\t\u002F\u002F TODO: next piece\n\t\tyield jsx`\n      \u003Csvg\n        width=${WIDTH * UNIT}\n        height=${HEIGHT * UNIT}\n        style=\"border: 1px solid currentcolor\"\n        fill=\"transparent\"\n      \u003E\n        \u003C${Board} field=${field} \u002F\u003E\n        \u003C${Piece} piece=${currentPiece} \u002F\u003E\n      \u003C\u002Fsvg\u003E\n    `;\n\t}\n}\n\nrenderer.render(jsx`\u003C${App} \u002F\u003E`, document.body);\n"},{"name":"todomvc","label":"Todo MVC","code":"import {renderer} from \"@b9g\u002Fcrank\u002Fdom\";\n\n\u002F\u002F Custom TodoMVC event that bubbles by default\nclass TodoEvent extends CustomEvent {\n\tconstructor(type, detail = {}) {\n\t\tsuper(type, {\n\t\t\tbubbles: true,\n\t\t\tdetail,\n\t\t});\n\t}\n}\n\nfunction* Header() {\n\tlet title = \"\";\n\n\tconst oninput = (ev) =\u003E {\n\t\ttitle = ev.target.value;\n\t};\n\n\tconst onkeydown = (ev) =\u003E {\n\t\tif (ev.key === \"Enter\" && title.trim()) {\n\t\t\tev.preventDefault();\n\t\t\tthis.dispatchEvent(new TodoEvent(\"todocreate\", {title: title.trim()}));\n\t\t\tthis.refresh(() =\u003E (title = \"\"));\n\t\t}\n\t};\n\n\tfor ({} of this) {\n\t\tyield (\n\t\t\t\u003Cheader class=\"header\"\u003E\n\t\t\t\t\u003Ch1\u003Etodos\u003C\u002Fh1\u003E\n\t\t\t\t\u003Cinput\n\t\t\t\t\tclass=\"new-todo\"\n\t\t\t\t\tplaceholder=\"What needs to be done?\"\n\t\t\t\t\tvalue={title}\n\t\t\t\t\toninput={oninput}\n\t\t\t\t\tonkeydown={onkeydown}\n\t\t\t\t\tautofocus\n\t\t\t\t\u002F\u003E\n\t\t\t\u003C\u002Fheader\u003E\n\t\t);\n\t}\n}\n\nfunction* TodoItem({todo}) {\n\tlet editing = false;\n\tlet editTitle = todo.title;\n\n\tconst ontoggle = () =\u003E {\n\t\tthis.dispatchEvent(\n\t\t\tnew TodoEvent(\"todotoggle\", {\n\t\t\t\tid: todo.id,\n\t\t\t\tcompleted: !todo.completed,\n\t\t\t}),\n\t\t);\n\t};\n\n\tconst ondelete = () =\u003E {\n\t\tthis.dispatchEvent(new TodoEvent(\"tododelete\", {id: todo.id}));\n\t};\n\n\tconst onedit = () =\u003E {\n\t\tthis.refresh(() =\u003E {\n\t\t\tediting = true;\n\t\t\teditTitle = todo.title;\n\t\t});\n\t};\n\n\tconst onsave = () =\u003E {\n\t\tif (editTitle.trim()) {\n\t\t\tthis.dispatchEvent(\n\t\t\t\tnew TodoEvent(\"todoedit\", {\n\t\t\t\t\tid: todo.id,\n\t\t\t\t\ttitle: editTitle.trim(),\n\t\t\t\t}),\n\t\t\t);\n\t\t}\n\t\tthis.refresh(() =\u003E (editing = false));\n\t};\n\n\tconst oncancel = () =\u003E {\n\t\tthis.refresh(() =\u003E {\n\t\t\tediting = false;\n\t\t\teditTitle = todo.title;\n\t\t});\n\t};\n\n\tconst onkeydown = (ev) =\u003E {\n\t\tif (ev.key === \"Enter\") {\n\t\t\tonsave();\n\t\t} else if (ev.key === \"Escape\") {\n\t\t\toncancel();\n\t\t}\n\t};\n\n\tfor ({todo} of this) {\n\t\tyield (\n\t\t\t\u003Cli class={{completed: todo.completed, editing}}\u003E\n\t\t\t\t\u003Cdiv class=\"view\"\u003E\n\t\t\t\t\t\u003Cinput\n\t\t\t\t\t\tclass=\"toggle\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tchecked={todo.completed}\n\t\t\t\t\t\tonchange={ontoggle}\n\t\t\t\t\t\u002F\u003E\n\t\t\t\t\t\u003Clabel ondblclick={onedit}\u003E{todo.title}\u003C\u002Flabel\u003E\n\t\t\t\t\t\u003Cbutton class=\"destroy\" onclick={ondelete}\u003E\u003C\u002Fbutton\u003E\n\t\t\t\t\u003C\u002Fdiv\u003E\n\t\t\t\t{editing && (\n\t\t\t\t\t\u003Cinput\n\t\t\t\t\t\tclass=\"edit\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tvalue={editTitle}\n\t\t\t\t\t\toninput={(ev) =\u003E (editTitle = ev.target.value)}\n\t\t\t\t\t\tonkeydown={onkeydown}\n\t\t\t\t\t\tonblur={onsave}\n\t\t\t\t\t\tautofocus\n\t\t\t\t\t\u002F\u003E\n\t\t\t\t)}\n\t\t\t\u003C\u002Fli\u003E\n\t\t);\n\t}\n}\n\nfunction* TodoList({todos, filter}) {\n\tfor ({todos, filter} of this) {\n\t\tconst filteredTodos = todos.filter((todo) =\u003E {\n\t\t\tif (filter === \"active\") return !todo.completed;\n\t\t\tif (filter === \"completed\") return todo.completed;\n\t\t\treturn true;\n\t\t});\n\n\t\tyield (\n\t\t\t\u003Cul class=\"todo-list\"\u003E\n\t\t\t\t{filteredTodos.map((todo) =\u003E (\n\t\t\t\t\t\u003CTodoItem key={todo.id} todo={todo} \u002F\u003E\n\t\t\t\t))}\n\t\t\t\u003C\u002Ful\u003E\n\t\t);\n\t}\n}\n\nfunction* Footer({todos, filter}) {\n\tconst setFilter = (newFilter) =\u003E {\n\t\tthis.dispatchEvent(new TodoEvent(\"filterchange\", {filter: newFilter}));\n\t};\n\n\tconst clearCompleted = () =\u003E {\n\t\tthis.dispatchEvent(new TodoEvent(\"todoclearcompleted\"));\n\t};\n\n\tfor ({todos, filter} of this) {\n\t\tconst activeCount = todos.filter((t) =\u003E !t.completed).length;\n\t\tconst completedCount = todos.filter((t) =\u003E t.completed).length;\n\n\t\tyield (\n\t\t\t\u003Cfooter class=\"footer\"\u003E\n\t\t\t\t\u003Cspan class=\"todo-count\"\u003E\n\t\t\t\t\t\u003Cstrong\u003E{activeCount}\u003C\u002Fstrong\u003E item{activeCount !== 1 ? \"s\" : \"\"} left\n\t\t\t\t\u003C\u002Fspan\u003E\n\t\t\t\t\u003Cul class=\"filters\"\u003E\n\t\t\t\t\t{[\"all\", \"active\", \"completed\"].map((f) =\u003E (\n\t\t\t\t\t\t\u003Cli key={f}\u003E\n\t\t\t\t\t\t\t\u003Ca\n\t\t\t\t\t\t\t\thref=\"javascript:void(0)\"\n\t\t\t\t\t\t\t\tonclick={() =\u003E setFilter(f === \"all\" ? \"\" : f)}\n\t\t\t\t\t\t\t\tclass={{selected: filter === (f === \"all\" ? \"\" : f)}}\n\t\t\t\t\t\t\t\u003E\n\t\t\t\t\t\t\t\t{f === \"all\" ? \"All\" : f.charAt(0).toUpperCase() + f.slice(1)}\n\t\t\t\t\t\t\t\u003C\u002Fa\u003E\n\t\t\t\t\t\t\u003C\u002Fli\u003E\n\t\t\t\t\t))}\n\t\t\t\t\u003C\u002Ful\u003E\n\t\t\t\t{completedCount \u003E 0 && (\n\t\t\t\t\t\u003Cbutton class=\"clear-completed\" onclick={clearCompleted}\u003E\n\t\t\t\t\t\tClear completed\n\t\t\t\t\t\u003C\u002Fbutton\u003E\n\t\t\t\t)}\n\t\t\t\u003C\u002Ffooter\u003E\n\t\t);\n\t}\n}\n\nfunction* App() {\n\tlet todos = [];\n\tlet nextId = 1;\n\tlet filter = \"\";\n\n\tthis.addEventListener(\"todocreate\", (ev) =\u003E {\n\t\tthis.refresh(() =\u003E {\n\t\t\ttodos.push({\n\t\t\t\tid: nextId++,\n\t\t\t\ttitle: ev.detail.title,\n\t\t\t\tcompleted: false,\n\t\t\t});\n\t\t});\n\t});\n\n\tthis.addEventListener(\"todotoggle\", (ev) =\u003E {\n\t\tthis.refresh(() =\u003E {\n\t\t\tconst todo = todos.find((t) =\u003E t.id === ev.detail.id);\n\t\t\tif (todo) todo.completed = ev.detail.completed;\n\t\t});\n\t});\n\n\tthis.addEventListener(\"todoedit\", (ev) =\u003E {\n\t\tthis.refresh(() =\u003E {\n\t\t\tconst todo = todos.find((t) =\u003E t.id === ev.detail.id);\n\t\t\tif (todo) todo.title = ev.detail.title;\n\t\t});\n\t});\n\n\tthis.addEventListener(\"tododelete\", (ev) =\u003E {\n\t\tthis.refresh(() =\u003E {\n\t\t\ttodos = todos.filter((t) =\u003E t.id !== ev.detail.id);\n\t\t});\n\t});\n\n\tthis.addEventListener(\"todoclearcompleted\", () =\u003E {\n\t\tthis.refresh(() =\u003E {\n\t\t\ttodos = todos.filter((t) =\u003E !t.completed);\n\t\t});\n\t});\n\n\tthis.addEventListener(\"filterchange\", (ev) =\u003E {\n\t\tthis.refresh(() =\u003E {\n\t\t\tfilter = ev.detail.filter;\n\t\t});\n\t});\n\n\tfor ({} of this) {\n\t\tyield (\n\t\t\t\u003Csection class=\"todoapp\"\u003E\n\t\t\t\t\u003CHeader \u002F\u003E\n\t\t\t\t{todos.length \u003E 0 && (\n\t\t\t\t\t\u003Csection class=\"main\"\u003E\n\t\t\t\t\t\t\u003Cinput\n\t\t\t\t\t\t\tid=\"toggle-all\"\n\t\t\t\t\t\t\tclass=\"toggle-all\"\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\tchecked={todos.every((t) =\u003E t.completed)}\n\t\t\t\t\t\t\tonchange={(e) =\u003E {\n\t\t\t\t\t\t\t\tconst completed = e.target.checked;\n\t\t\t\t\t\t\t\tthis.refresh(() =\u003E {\n\t\t\t\t\t\t\t\t\ttodos.forEach((t) =\u003E (t.completed = completed));\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\u002F\u003E\n\t\t\t\t\t\t\u003Clabel for=\"toggle-all\"\u003EMark all as complete\u003C\u002Flabel\u003E\n\t\t\t\t\t\t\u003CTodoList todos={todos} filter={filter} \u002F\u003E\n\t\t\t\t\t\t\u003CFooter todos={todos} filter={filter} \u002F\u003E\n\t\t\t\t\t\u003C\u002Fsection\u003E\n\t\t\t\t)}\n\t\t\t\u003C\u002Fsection\u003E\n\t\t);\n\t}\n}\n\n\u002F\u002F Add TodoMVC CSS\nconst link = document.createElement(\"link\");\nlink.rel = \"stylesheet\";\nlink.href = \"https:\u002F\u002Funpkg.com\u002Ftodomvc-app-css@2.4.2\u002Findex.css\";\n\u002F\u002F remove default stylesheet for playground\ndocument.head.querySelector(\"link\").remove();\ndocument.head.appendChild(link);\n\nrenderer.render(\u003CApp \u002F\u003E, document.body);\n"},{"name":"greeting","label":"Hello World","code":"import {renderer} from \"@b9g\u002Fcrank\u002Fdom\";\n\nfunction Greeting({name = \"World\"}) {\n\treturn \u003Cdiv\u003EHello {name}\u003C\u002Fdiv\u003E;\n}\n\nrenderer.render(\u003CGreeting name=\"Crank\" \u002F\u003E, document.body);\n"},{"name":"hexagonal-minesweeper","label":"Hexagonal Minesweeper","code":"import {jsx} from \"@b9g\u002Fcrank\u002Fstandalone\";\nimport {renderer} from \"@b9g\u002Fcrank\u002Fdom\";\n\nfunction Hexagon({cx = 0, cy = 0, r, ...props}) {\n\tif (!r) {\n\t\treturn null;\n\t}\n\n\tconst points = [];\n\tfor (let i = 0, a = 0; i \u003C 6; i++, a += Math.PI \u002F 3) {\n\t\tpoints.push([cx + Math.cos(a) * r, cy + Math.sin(a) * r]);\n\t}\n\n\treturn jsx`\n    \u003Cpath\n      ...${props}\n      d=\"M ${points.map(([x, y], i) =\u003E `${i \u003E 0 ? \"L\" : \"\"} ${x} ${y}`)} Z\"\n    \u002F\u003E\n  `;\n}\n\nfunction centerCoordsFor(cell, size, rows, cols) {\n\tconst colSpacing = (size * 3) \u002F 2;\n\tconst rowSpacing = Math.sqrt(3) * size;\n\n\t\u002F\u002F Calculate grid bounds\n\tconst gridWidth = (cols - 1) * colSpacing;\n\tconst gridHeight = rows * rowSpacing;\n\n\t\u002F\u002F Center offset\n\tconst offsetX = -gridWidth \u002F 2;\n\tconst offsetY = -gridHeight \u002F 2;\n\n\treturn {\n\t\tcx: cell.col * colSpacing + offsetX,\n\t\tcy:\n\t\t\tcell.row * rowSpacing +\n\t\t\t(cell.col % 2 === 0 ? 0 : rowSpacing \u002F 2) +\n\t\t\toffsetY,\n\t};\n}\n\nfunction axialCoordsFor(cell) {\n\treturn {q: cell.col, r: cell.row - Math.floor(cell.col \u002F 2)};\n}\n\nfunction HexagonalGrid({\n\tradius = 20,\n\tcells,\n\tonCellClick,\n\tonCellRightClick,\n\trows,\n\tcols,\n}) {\n\treturn cells.map((cell, i) =\u003E {\n\t\tconst onclick = (event) =\u003E {\n\t\t\tevent.preventDefault();\n\t\t\tonCellClick(cell);\n\t\t};\n\t\tconst oncontextmenu = (event) =\u003E {\n\t\t\tevent.preventDefault();\n\t\t\tonCellRightClick(cell);\n\t\t};\n\t\tconst {cx, cy} = centerCoordsFor(cell, radius, rows, cols);\n\n\t\tlet fill = \"lightgray\";\n\t\tlet stroke = \"gray\";\n\t\tif (cell.revealed) {\n\t\t\tfill = cell.bomb ? \"red\" : \"white\";\n\t\t\tstroke = cell.bomb ? \"darkred\" : \"dodgerblue\";\n\t\t} else if (cell.flagged) {\n\t\t\tfill = \"yellow\";\n\t\t\tstroke = \"orange\";\n\t\t}\n\n\t\treturn jsx`\n      \u003C${Hexagon}\n        key=${i}\n        r=${radius}\n        cx=${cx} cy=${cy}\n        fill=${fill} stroke=${stroke}\n        onclick=${onclick}\n        oncontextmenu=${oncontextmenu}\n        style=\"cursor: pointer\"\n      \u002F\u003E\n      \u003Ctext\n        x=${cx} y=${cy}\n        text-anchor=\"middle\" dominant-baseline=\"middle\"\n        fill=\"dodgerblue\"\n        font-size=\"10\"\n        style=\"pointer-events: none\"\n      \u003E${cell.revealed && cell.bombCount && !cell.bomb ? cell.bombCount : \"\"}\u003C\u002Ftext\u003E\n      \u003Ctext\n        x=${cx} y=${cy}\n        text-anchor=\"middle\" dominant-baseline=\"middle\"\n        fill=\"red\"\n        font-size=\"12\"\n        style=\"pointer-events: none\"\n      \u003E${cell.revealed && cell.bomb ? \"💣\" : \"\"}\u003C\u002Ftext\u003E\n      \u003Ctext\n        x=${cx} y=${cy}\n        text-anchor=\"middle\" dominant-baseline=\"middle\"\n        fill=\"red\"\n        font-size=\"12\"\n        style=\"pointer-events: none\"\n      \u003E${!cell.revealed && cell.flagged ? \"🚩\" : \"\"}\u003C\u002Ftext\u003E\n    `;\n\t});\n}\n\nfunction shuffle(arr) {\n\tfor (let i = arr.length - 1; i \u003E 0; i--) {\n\t\tconst j = Math.floor(Math.random() * (i + 1));\n\t\t[arr[i], arr[j]] = [arr[j], arr[i]];\n\t}\n\n\treturn arr;\n}\n\nfunction neighborsOf(cell, cells) {\n\tconst {q, r} = axialCoordsFor(cell);\n\tconst vectors = [\n\t\t[1, 0],\n\t\t[0, 1],\n\t\t[-1, 1],\n\t\t[-1, 0],\n\t\t[0, -1],\n\t\t[1, -1],\n\t];\n\tconst axialSet = new Set(vectors.map(([q1, r1]) =\u003E `${q + q1},${r + r1}`));\n\treturn cells.filter((cell1) =\u003E {\n\t\tconst {q, r} = axialCoordsFor(cell1);\n\t\treturn axialSet.has(`${q},${r}`);\n\t});\n}\n\nfunction* Minesweeper() {\n\tconst rows = 10;\n\tconst cols = 15;\n\tconst bombCount = 25;\n\n\tlet gameState = \"playing\"; \u002F\u002F \"playing\", \"won\", \"lost\"\n\tlet firstClick = true;\n\tlet mouseDown = false;\n\n\tconst initializeCells = () =\u003E {\n\t\tconst cells = [];\n\t\tfor (let row = 0; row \u003C rows; row++) {\n\t\t\tfor (let col = 0; col \u003C cols; col++) {\n\t\t\t\tcells.push({\n\t\t\t\t\trow,\n\t\t\t\t\tcol,\n\t\t\t\t\tbomb: false,\n\t\t\t\t\tbombCount: 0,\n\t\t\t\t\trevealed: false,\n\t\t\t\t\tflagged: false,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn cells;\n\t};\n\n\tlet cells = initializeCells();\n\n\tconst placeBombs = (firstClickCell) =\u003E {\n\t\t\u002F\u002F Don't place bombs on first click or its neighbors\n\t\tconst forbidden = new Set([\n\t\t\tfirstClickCell,\n\t\t\t...neighborsOf(firstClickCell, cells),\n\t\t]);\n\t\tconst availableCells = cells.filter((cell) =\u003E !forbidden.has(cell));\n\n\t\tfor (const cell of shuffle(availableCells.slice()).slice(0, bombCount)) {\n\t\t\tcell.bomb = true;\n\t\t}\n\n\t\t\u002F\u002F Calculate bomb counts\n\t\tfor (const cell of cells) {\n\t\t\tif (!cell.bomb) {\n\t\t\t\tcell.bombCount = neighborsOf(cell, cells).reduce(\n\t\t\t\t\t(count, neighbor) =\u003E count + (neighbor.bomb ? 1 : 0),\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst revealCell = (cell) =\u003E {\n\t\tif (cell.revealed || cell.flagged || gameState !== \"playing\") {\n\t\t\treturn;\n\t\t}\n\n\t\tif (firstClick) {\n\t\t\tplaceBombs(cell);\n\t\t\tfirstClick = false;\n\t\t}\n\n\t\tcell.revealed = true;\n\n\t\tif (cell.bomb) {\n\t\t\tgameState = \"lost\";\n\t\t\t\u002F\u002F Reveal all bombs\n\t\t\tcells.filter((c) =\u003E c.bomb).forEach((c) =\u003E (c.revealed = true));\n\t\t\treturn;\n\t\t}\n\n\t\t\u002F\u002F Auto-reveal empty neighbors\n\t\tif (cell.bombCount === 0) {\n\t\t\tneighborsOf(cell, cells).forEach((neighbor) =\u003E {\n\t\t\t\tif (!neighbor.revealed && !neighbor.flagged) {\n\t\t\t\t\trevealCell(neighbor);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t\u002F\u002F Check win condition\n\t\tconst unrevealedNonBombs = cells.filter(\n\t\t\t(c) =\u003E !c.bomb && !c.revealed,\n\t\t).length;\n\t\tif (unrevealedNonBombs === 0) {\n\t\t\tgameState = \"won\";\n\t\t}\n\t};\n\n\tconst toggleFlag = (cell) =\u003E {\n\t\tif (cell.revealed || gameState !== \"playing\") {\n\t\t\treturn;\n\t\t}\n\t\tcell.flagged = !cell.flagged;\n\t};\n\n\tconst resetGame = () =\u003E {\n\t\tcells = initializeCells();\n\t\tgameState = \"playing\";\n\t\tfirstClick = true;\n\t};\n\n\tconst handleCellClick = (cell) =\u003E {\n\t\tthis.refresh(() =\u003E {\n\t\t\trevealCell(cell);\n\t\t});\n\t};\n\n\tconst handleCellRightClick = (cell) =\u003E {\n\t\tthis.refresh(() =\u003E {\n\t\t\ttoggleFlag(cell);\n\t\t});\n\t};\n\n\tconst handleMouseDown = () =\u003E {\n\t\tif (gameState === \"playing\") {\n\t\t\tthis.refresh(() =\u003E (mouseDown = true));\n\t\t}\n\t};\n\n\tconst handleMouseUp = () =\u003E {\n\t\tthis.refresh(() =\u003E (mouseDown = false));\n\t};\n\n\tconst flagCount = () =\u003E cells.filter((c) =\u003E c.flagged).length;\n\tconst remainingBombs = bombCount - flagCount();\n\n\tfor ({} of this) {\n\t\tconst statusEmoji =\n\t\t\tgameState === \"won\"\n\t\t\t\t? \"😎\"\n\t\t\t\t: gameState === \"lost\"\n\t\t\t\t\t? \"😵\"\n\t\t\t\t\t: mouseDown\n\t\t\t\t\t\t? \"😳\"\n\t\t\t\t\t\t: \"🙂\";\n\n\t\tconst statusText =\n\t\t\tgameState === \"won\"\n\t\t\t\t? \"You Won!\"\n\t\t\t\t: gameState === \"lost\"\n\t\t\t\t\t? \"Game Over!\"\n\t\t\t\t\t: `${remainingBombs} mines`;\n\n\t\t\u002F\u002F Calculate grid bounds for centering\n\t\tconst radius = 18;\n\t\tconst colSpacing = (radius * 3) \u002F 2;\n\t\tconst rowSpacing = Math.sqrt(3) * radius;\n\n\t\tconst gridWidth = (cols - 1) * colSpacing + radius * 2;\n\t\tconst gridHeight = rows * rowSpacing + radius * 2;\n\n\t\tconst padding = 30;\n\t\tconst viewBoxWidth = gridWidth + padding * 2;\n\t\tconst viewBoxHeight = gridHeight + padding * 2;\n\t\tconst viewBoxX = -viewBoxWidth \u002F 2;\n\t\tconst viewBoxY = -viewBoxHeight \u002F 2;\n\n\t\tyield jsx`\n      \u003Cdiv style=\"text-align: center; font-family: Arial, sans-serif; height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; background: #f0f0f0; margin: 0; padding: 20px; box-sizing: border-box\"\u003E\n        \u003Cdiv style=\"margin-bottom: 20px; font-size: 24px; font-weight: bold; color: #333\"\u003E\n          Hexagonal Minesweeper\n        \u003C\u002Fdiv\u003E\n        \u003Cdiv style=\"margin-bottom: 10px; font-size: 32px\"\u003E\n          ${statusEmoji}\n        \u003C\u002Fdiv\u003E\n        \u003Cdiv style=\"margin-bottom: 15px; font-size: 16px; color: #666\"\u003E\n          ${statusText}\n        \u003C\u002Fdiv\u003E\n        \u003Cbutton\n          onclick=${() =\u003E this.refresh(() =\u003E resetGame())}\n          style=\"margin-bottom: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer; border: 2px solid #333; background: white; border-radius: 4px\"\n          onmousedown=${handleMouseDown}\n          onmouseup=${handleMouseUp}\n          onmouseleave=${handleMouseUp}\n        \u003E\n          New Game\n        \u003C\u002Fbutton\u003E\n        \u003Cdiv style=\"display: flex; align-items: center; justify-content: center; max-width: 100%\"\u003E\n          \u003Csvg\n            width=\"100%\"\n            height=\"100%\"\n            viewBox=\"${viewBoxX} ${viewBoxY} ${viewBoxWidth} ${viewBoxHeight}\"\n            xmlns=\"http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg\"\n            style=\"border: 3px solid #333; background: white; border-radius: 8px; max-width: 600px; height: 400px\"\n            onmousedown=${handleMouseDown}\n            onmouseup=${handleMouseUp}\n            onmouseleave=${handleMouseUp}\n          \u003E\n            \u003C${HexagonalGrid}\n              cells=${cells}\n              radius=${radius}\n              rows=${rows}\n              cols=${cols}\n              onCellClick=${handleCellClick}\n              onCellRightClick=${handleCellRightClick}\n            \u002F\u003E\n          \u003C\u002Fsvg\u003E\n        \u003C\u002Fdiv\u003E\n        \u003Cdiv style=\"margin-top: 15px; font-size: 14px; color: #888\"\u003E\n          Left click to reveal • Right click to flag\n        \u003C\u002Fdiv\u003E\n      \u003C\u002Fdiv\u003E\n    `;\n\t}\n}\n\nrenderer.render(jsx`\u003C${Minesweeper} \u002F\u003E`, document.body);\n"},{"name":"hackernews","label":"Hacker News","code":"import {Fragment, Raw} from \"@b9g\u002Fcrank\";\nimport {renderer} from \"@b9g\u002Fcrank\u002Fdom\";\n\nfunction* Comment() {\n\tlet expanded = true;\n\tthis.addEventListener(\"click\", (ev) =\u003E {\n\t\tif (ev.target.className === \"expand\") {\n\t\t\tthis.refresh(() =\u003E (expanded = !expanded));\n\t\t\tev.stopPropagation();\n\t\t}\n\t});\n\n\tfor (const {comment} of this) {\n\t\tyield (\n\t\t\t\u003Cdiv style=\"margin-left: 20px; border-left: 2px solid #ccc; padding-left: 10px; margin-bottom: 10px;\"\u003E\n\t\t\t\t\u003Cp\u003E\n\t\t\t\t\t\u003Cbutton\n\t\t\t\t\t\tclass=\"expand\"\n\t\t\t\t\t\tstyle=\"background: none; border: none; cursor: pointer; color: #666;\"\n\t\t\t\t\t\u003E\n\t\t\t\t\t\t{expanded ? \"[-]\" : \"[+]\"}\n\t\t\t\t\t\u003C\u002Fbutton\u003E{\" \"}\n\t\t\t\t\t\u003Cstrong\u003E{comment.user}\u003C\u002Fstrong\u003E {comment.time_ago}\n\t\t\t\t\u003C\u002Fp\u003E\n\t\t\t\t\u003Cdiv style={{display: expanded ? \"block\" : \"none\"}}\u003E\n\t\t\t\t\t\u003Cdiv style=\"margin: 10px 0;\"\u003E\n\t\t\t\t\t\t\u003CRaw value={comment.content} \u002F\u003E\n\t\t\t\t\t\u003C\u002Fdiv\u003E\n\t\t\t\t\t\u003Cdiv\u003E\n\t\t\t\t\t\t{comment.comments.map((reply) =\u003E (\n\t\t\t\t\t\t\t\u003CComment crank-key={reply.id} comment={reply} \u002F\u003E\n\t\t\t\t\t\t))}\n\t\t\t\t\t\u003C\u002Fdiv\u003E\n\t\t\t\t\u003C\u002Fdiv\u003E\n\t\t\t\u003C\u002Fdiv\u003E\n\t\t);\n\t}\n}\n\nasync function Item({id}) {\n\tconst result = await fetch(`https:\u002F\u002Fapi.hnpwa.com\u002Fv0\u002Fitem\u002F${id}.json`);\n\tconst item = await result.json();\n\treturn (\n\t\t\u003Cdiv style=\"max-width: 800px; margin: 0 auto; padding: 20px;\"\u003E\n\t\t\t\u003Ca href={item.url} style=\"text-decoration: none; color: #000;\"\u003E\n\t\t\t\t\u003Ch1 style=\"margin-bottom: 5px;\"\u003E{item.title}\u003C\u002Fh1\u003E\n\t\t\t\u003C\u002Fa\u003E\n\t\t\t\u003Cp style=\"color: #666; margin-bottom: 5px;\"\u003E{item.domain}\u003C\u002Fp\u003E\n\t\t\t\u003Cp style=\"color: #666; margin-bottom: 20px;\"\u003E\n\t\t\t\tsubmitted by \u003Cstrong\u003E{item.user}\u003C\u002Fstrong\u003E {item.time_ago}\n\t\t\t\u003C\u002Fp\u003E\n\t\t\t{item.comments.map((comment) =\u003E (\n\t\t\t\t\u003CComment comment={comment} crank-key={comment.id} \u002F\u003E\n\t\t\t))}\n\t\t\u003C\u002Fdiv\u003E\n\t);\n}\n\nfunction Story({story}) {\n\treturn (\n\t\t\u003Cli style=\"margin-bottom: 15px; list-style: none;\"\u003E\n\t\t\t\u003Ca\n\t\t\t\thref={story.url}\n\t\t\t\tstyle=\"text-decoration: none; color: #000; font-weight: bold;\"\n\t\t\t\u003E\n\t\t\t\t{story.title}\n\t\t\t\u003C\u002Fa\u003E{\" \"}\n\t\t\t\u003Cspan style=\"color: #666;\"\u003E({story.domain})\u003C\u002Fspan\u003E\n\t\t\t\u003Cp style=\"color: #666; margin: 5px 0 0 0; font-size: 14px;\"\u003E\n\t\t\t\t{story.points} points by \u003Cstrong\u003E{story.user}\u003C\u002Fstrong\u003E |{\" \"}\n\t\t\t\t{story.time_ago} |\n\t\t\t\t\u003Ca\n\t\t\t\t\thref={`#\u002Fitem\u002F${story.id}`}\n\t\t\t\t\tstyle=\"color: #666; text-decoration: none;\"\n\t\t\t\t\u003E\n\t\t\t\t\t{\" \"}\n\t\t\t\t\t{story.comments_count} comments\n\t\t\t\t\u003C\u002Fa\u003E\n\t\t\t\u003C\u002Fp\u003E\n\t\t\u003C\u002Fli\u003E\n\t);\n}\n\nfunction Pager({page}) {\n\tconst prevDisabled = page \u003C= 1;\n\tconst nextDisabled = page \u003E= 5;\n\n\treturn (\n\t\t\u003Cdiv style=\"text-align: center; margin: 20px 0; padding: 10px;\"\u003E\n\t\t\t\u003Ca\n\t\t\t\thref={prevDisabled ? \"#\" : `#\u002Ftop\u002F${page - 1}`}\n\t\t\t\tstyle={{\n\t\t\t\t\tcolor: prevDisabled ? \"#ccc\" : \"#666\",\n\t\t\t\t\t\"text-decoration\": \"none\",\n\t\t\t\t\t\"margin-right\": \"10px\",\n\t\t\t\t\tcursor: prevDisabled ? \"default\" : \"pointer\",\n\t\t\t\t}}\n\t\t\t\u003E\n\t\t\t\tPrevious\n\t\t\t\u003C\u002Fa\u003E\n\t\t\t\u003Cspan\u003E{page}\u002F5\u003C\u002Fspan\u003E\n\t\t\t\u003Ca\n\t\t\t\thref={nextDisabled ? \"#\" : `#\u002Ftop\u002F${page + 1}`}\n\t\t\t\tstyle={{\n\t\t\t\t\tcolor: nextDisabled ? \"#ccc\" : \"#666\",\n\t\t\t\t\t\"text-decoration\": \"none\",\n\t\t\t\t\t\"margin-left\": \"10px\",\n\t\t\t\t\tcursor: nextDisabled ? \"default\" : \"pointer\",\n\t\t\t\t}}\n\t\t\t\u003E\n\t\t\t\tNext\n\t\t\t\u003C\u002Fa\u003E\n\t\t\u003C\u002Fdiv\u003E\n\t);\n}\n\nasync function List({page, start = (page - 1) * 30 + 1}) {\n\tconst result = await fetch(`https:\u002F\u002Fapi.hnpwa.com\u002Fv0\u002Fnews\u002F${page}.json`);\n\tconst stories = await result.json();\n\tconst items = stories.map((story) =\u003E (\n\t\t\u003CStory story={story} crank-key={story.id} \u002F\u003E\n\t));\n\treturn (\n\t\t\u003CFragment\u003E\n\t\t\t\u003CPager page={page} \u002F\u003E\n\t\t\t\u003Col\n\t\t\t\tstart={start}\n\t\t\t\tstyle=\"max-width: 800px; margin: 0 auto; padding: 0 20px;\"\n\t\t\t\u003E\n\t\t\t\t{items}\n\t\t\t\u003C\u002Fol\u003E\n\t\t\t\u003CPager page={page} \u002F\u003E\n\t\t\u003C\u002FFragment\u003E\n\t);\n}\n\nfunction parseHash(hash) {\n\tif (hash.startsWith(\"#\u002Fitem\u002F\")) {\n\t\tconst id = hash.slice(7);\n\t\tif (id) {\n\t\t\treturn {route: \"item\", id};\n\t\t}\n\t} else if (hash.startsWith(\"#\u002Ftop\u002F\")) {\n\t\tconst page = parseInt(hash.slice(6)) || 1;\n\t\tif (!Number.isNaN(page)) {\n\t\t\treturn {route: \"top\", page};\n\t\t}\n\t}\n}\n\nasync function Loading({wait = 1000}) {\n\tawait new Promise((resolve) =\u003E setTimeout(resolve, wait));\n\treturn (\n\t\t\u003Cdiv style=\"text-align: center; padding: 40px; color: #666;\"\u003E\n\t\t\tLoading...\n\t\t\u003C\u002Fdiv\u003E\n\t);\n}\n\nasync function* App() {\n\tlet data;\n\tconst route = (ev) =\u003E {\n\t\tconst hash = window.location.hash;\n\t\tdata = parseHash(hash);\n\t\tif (data == null) {\n\t\t\tdata = {route: \"top\", page: 1};\n\t\t\twindow.location.hash = \"#\u002Ftop\u002F1\";\n\t\t}\n\n\t\tif (ev) {\n\t\t\tthis.refresh();\n\t\t}\n\t};\n\n\twindow.addEventListener(\"hashchange\", route);\n\troute();\n\n\tfor await (const _ of this) {\n\t\tyield \u003CLoading \u002F\u003E;\n\t\tswitch (data.route) {\n\t\t\tcase \"item\": {\n\t\t\t\tawait (yield \u003CItem {...data} \u002F\u003E);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"top\": {\n\t\t\t\tawait (yield \u003CList {...data} \u002F\u003E);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\twindow.scrollTo(0, 0);\n\t}\n\n\twindow.removeEventListener(\"hashchange\", route);\n}\n\nfunction Navbar() {\n\treturn (\n\t\t\u003Cnav style=\"background: #ff6600; padding: 10px; margin-bottom: 20px;\"\u003E\n\t\t\t\u003Cdiv style=\"max-width: 800px; margin: 0 auto; color: white; font-weight: bold;\"\u003E\n\t\t\t\t\u003Cspan style=\"color: #ffcc99; margin-right: 10px;\"\u003ECrank News\u003C\u002Fspan\u003E\n\t\t\t\t\u003Ca href=\"#\u002Ftop\u002F1\" style=\"color: white; text-decoration: none;\"\u003E\n\t\t\t\t\tTop\n\t\t\t\t\u003C\u002Fa\u003E\n\t\t\t\u003C\u002Fdiv\u003E\n\t\t\u003C\u002Fnav\u003E\n\t);\n}\n\nfunction Root() {\n\treturn (\n\t\t\u003Cdiv style=\"font-family: Arial, sans-serif; line-height: 1.4; background: #f6f6f0; min-height: 100vh;\"\u003E\n\t\t\t\u003CNavbar \u002F\u003E\n\t\t\t\u003CApp \u002F\u003E\n\t\t\u003C\u002Fdiv\u003E\n\t);\n}\n\nrenderer.render(\u003CRoot \u002F\u003E, document.body);\n"},{"name":"animated-letters","label":"Animated Letters","code":"import {renderer} from \"@b9g\u002Fcrank\u002Fdom\";\n\nfunction shuffle(arr) {\n\tfor (let i = arr.length - 1; i \u003E 0; i--) {\n\t\tconst j = Math.floor(Math.random() * (i + 1));\n\t\t[arr[i], arr[j]] = [arr[j], arr[i]];\n\t}\n\treturn arr;\n}\n\nfunction getRandomLetters() {\n\tconst alphabet = [...\"abcdefghijklmnopqrstuvwxyz\"];\n\treturn shuffle(alphabet)\n\t\t.slice(0, Math.floor(Math.random() * alphabet.length))\n\t\t.sort();\n}\n\nconst style = {\n\tposition: \"absolute\",\n\ttop: \"20px\",\n\ttransition: \"transform 750ms, opacity 750ms\",\n};\n\nfunction deferTransitionStyles(callback) {\n\trequestAnimationFrame(() =\u003E {\n\t\trequestAnimationFrame(callback);\n\t});\n}\n\nfunction* Letter({letter, index}) {\n\tthis.after((node) =\u003E {\n\t\tnode.style.transform = `translate(${index * 1.1}em, -20px)`;\n\t\tnode.style.opacity = 0;\n\t\tdeferTransitionStyles(() =\u003E {\n\t\t\tnode.style.transform = `translate(${index * 1.1}em, 0)`;\n\t\t\tnode.style.opacity = 1;\n\t\t});\n\t});\n\n\tthis.cleanup((node) =\u003E {\n\t\tdeferTransitionStyles(() =\u003E {\n\t\t\tnode.style.color = \"red\";\n\t\t\tnode.style.transform = `translate(${index * 1.1}em, 20px)`;\n\t\t\tnode.style.opacity = 0;\n\t\t});\n\t\treturn new Promise((resolve) =\u003E setTimeout(resolve, 750));\n\t});\n\n\tyield (\n\t\t\u003Cspan\n\t\t\tstyle={{\n\t\t\t\t...style,\n\t\t\t\tcolor: \"green\",\n\t\t\t}}\n\t\t\u003E\n\t\t\t{letter}\n\t\t\u003C\u002Fspan\u003E\n\t);\n\n\tfor ({letter, index} of this) {\n\t\tthis.after((node) =\u003E {\n\t\t\tdeferTransitionStyles(() =\u003E {\n\t\t\t\tnode.style.transform = `translate(${index * 1.1}em, 0)`;\n\t\t\t});\n\t\t});\n\n\t\tyield \u003Cspan style={{...style, color: \"black\"}}\u003E{letter}\u003C\u002Fspan\u003E;\n\t}\n}\n\nfunction* Letters() {\n\tconst interval = setInterval(() =\u003E this.refresh(), 1500);\n\n\tfor ({} of this) {\n\t\tyield (\n\t\t\t\u003Cdiv style=\"height: 40px\"\u003E\n\t\t\t\t{getRandomLetters().map((l, i) =\u003E (\n\t\t\t\t\t\u003CLetter crank-key={l} letter={l} index={i} \u002F\u003E\n\t\t\t\t))}\n\t\t\t\u003C\u002Fdiv\u003E\n\t\t);\n\t}\n\n\tclearInterval(interval);\n}\n\nrenderer.render(\u003CLetters \u002F\u003E, document.body);\n"},{"name":"xstate-calculator","label":"XState Calculator","code":"\u002F\u002F Based on xstate-vue-calculator:\n\u002F\u002F https:\u002F\u002Fgithub.com\u002FGlutnix\u002Fxstate-vue-calculator\n\u002F\u002F Can't import from \"xstate\":\n\u002F\u002F https:\u002F\u002Fgithub.com\u002Fstatelyai\u002Fxstate\u002Fpull\u002F2318#issuecomment-864795216\nimport {Machine, assign} from \"xstate@4\u002Fdist\u002Fxstate.web.js\";\nimport {Context, createElement} from \"@b9g\u002Fcrank\";\nimport {renderer} from \"@b9g\u002Fcrank\u002Fdom\";\n\nconst not =\n\t(fn) =\u003E\n\t(...args) =\u003E\n\t\t!fn.apply(null, args);\nconst isZero = (context, event) =\u003E event.key === 0;\nconst isNotZero = not(isZero);\nconst isMinus = (context, event) =\u003E event.operator === \"-\";\nconst isNotMinus = not(isMinus);\nconst divideByZero = (context) =\u003E\n\tcontext.operand2 === \"0.\" && context.operator === \"\u002F\";\nconst notDivideByZero = not(divideByZero);\n\nfunction doMath(operand1, operand2, operator) {\n\tswitch (operator) {\n\t\tcase \"+\":\n\t\t\treturn +operand1 + +operand2;\n\t\tcase \"-\":\n\t\t\treturn +operand1 - +operand2;\n\t\tcase \"\u002F\":\n\t\t\treturn +operand1 \u002F +operand2;\n\t\tcase \"x\":\n\t\t\treturn +operand1 * +operand2;\n\t\tdefault:\n\t\t\treturn Infinity;\n\t}\n}\n\nexport const calcMachine = Machine(\n\t{\n\t\tid: \"calcMachine\",\n\t\tcontext: {\n\t\t\tdisplay: \"0.\",\n\t\t\toperand1: null,\n\t\t\toperand2: null,\n\t\t\toperator: null,\n\t\t},\n\t\t\u002F\u002F strict: true,\n\t\ton: {\n\t\t\tCLEAR_EVERYTHING: {\n\t\t\t\ttarget: \".start\",\n\t\t\t\tactions: [\"reset\"],\n\t\t\t},\n\t\t},\n\t\tinitial: \"start\",\n\t\tstates: {\n\t\t\tstart: {\n\t\t\t\ton: {\n\t\t\t\t\tNUMBER: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isZero\",\n\t\t\t\t\t\t\ttarget: \"operand1.zero\",\n\t\t\t\t\t\t\tactions: [\"defaultReadout\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isNotZero\",\n\t\t\t\t\t\t\ttarget: \"operand1.before_decimal_point\",\n\t\t\t\t\t\t\tactions: [\"setReadoutNum\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tOPERATOR: {\n\t\t\t\t\t\tcond: \"isMinus\",\n\t\t\t\t\t\ttarget: \"negative_number\",\n\t\t\t\t\t\tactions: [\"startNegativeNumber\"],\n\t\t\t\t\t},\n\t\t\t\t\tDECIMAL_POINT: {\n\t\t\t\t\t\ttarget: \"operand1.after_decimal_point\",\n\t\t\t\t\t\tactions: [\"defaultReadout\"],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\toperand1: {\n\t\t\t\ton: {\n\t\t\t\t\tOPERATOR: {\n\t\t\t\t\t\ttarget: \"operator_entered\",\n\t\t\t\t\t\tactions: [\"recordOperator\"],\n\t\t\t\t\t},\n\t\t\t\t\tPERCENTAGE: {\n\t\t\t\t\t\ttarget: \"result\",\n\t\t\t\t\t\tactions: [\"storeResultAsOperand2\", \"computePercentage\"],\n\t\t\t\t\t},\n\t\t\t\t\tCLEAR_ENTRY: {\n\t\t\t\t\t\ttarget: \"operand1\",\n\t\t\t\t\t\tactions: [\"defaultReadout\"],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tinitial: \"zero\",\n\t\t\t\tstates: {\n\t\t\t\t\tzero: {\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tNUMBER: {\n\t\t\t\t\t\t\t\ttarget: \"before_decimal_point\",\n\t\t\t\t\t\t\t\tactions: [\"setReadoutNum\"],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tDECIMAL_POINT: \"after_decimal_point\",\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tbefore_decimal_point: {\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tNUMBER: {\n\t\t\t\t\t\t\t\ttarget: \"before_decimal_point\",\n\t\t\t\t\t\t\t\tactions: [\"appendNumBeforeDecimal\"],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tDECIMAL_POINT: \"after_decimal_point\",\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tafter_decimal_point: {\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tNUMBER: {\n\t\t\t\t\t\t\t\ttarget: \"after_decimal_point\",\n\t\t\t\t\t\t\t\tactions: [\"appendNumAfterDecimal\"],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\tnegative_number: {\n\t\t\t\ton: {\n\t\t\t\t\tNUMBER: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isZero\",\n\t\t\t\t\t\t\ttarget: \"operand1.zero\",\n\t\t\t\t\t\t\tactions: [\"defaultNegativeReadout\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isNotZero\",\n\t\t\t\t\t\t\ttarget: \"operand1.before_decimal_point\",\n\t\t\t\t\t\t\tactions: [\"setNegativeReadoutNum\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tDECIMAL_POINT: {\n\t\t\t\t\t\ttarget: \"operand1.after_decimal_point\",\n\t\t\t\t\t\tactions: [\"defaultNegativeReadout\"],\n\t\t\t\t\t},\n\t\t\t\t\tCLEAR_ENTRY: {\n\t\t\t\t\t\ttarget: \"start\",\n\t\t\t\t\t\tactions: [\"defaultReadout\"],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\toperator_entered: {\n\t\t\t\ton: {\n\t\t\t\t\tOPERATOR: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isNotMinus\",\n\t\t\t\t\t\t\ttarget: \"operator_entered\",\n\t\t\t\t\t\t\tactions: [\"setOperator\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isMinus\",\n\t\t\t\t\t\t\ttarget: \"negative_number_2\",\n\t\t\t\t\t\t\tactions: [\"startNegativeNumber\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tNUMBER: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isZero\",\n\t\t\t\t\t\t\ttarget: \"operand2.zero\",\n\t\t\t\t\t\t\tactions: [\"defaultReadout\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isNotZero\",\n\t\t\t\t\t\t\ttarget: \"operand2.before_decimal_point\",\n\t\t\t\t\t\t\tactions: [\"setReadoutNum\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tDECIMAL_POINT: {\n\t\t\t\t\t\ttarget: \"operand2.after_decimal_point\",\n\t\t\t\t\t\tactions: [\"defaultReadout\"],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\toperand2: {\n\t\t\t\ton: {\n\t\t\t\t\tOPERATOR: {\n\t\t\t\t\t\ttarget: \"operator_entered\",\n\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\"storeResultAsOperand2\",\n\t\t\t\t\t\t\t\"compute\",\n\t\t\t\t\t\t\t\"storeResultAsOperand1\",\n\t\t\t\t\t\t\t\"setOperator\",\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\tEQUALS: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"notDivideByZero\",\n\t\t\t\t\t\t\ttarget: \"result\",\n\t\t\t\t\t\t\tactions: [\"storeResultAsOperand2\", \"compute\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{target: \"alert\", actions: [\"divideByZeroAlert\"]},\n\t\t\t\t\t],\n\t\t\t\t\tCLEAR_ENTRY: {\n\t\t\t\t\t\ttarget: \"operand2\",\n\t\t\t\t\t\tactions: [\"defaultReadout\"],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tinitial: \"hist\",\n\t\t\t\tstates: {\n\t\t\t\t\thist: {\n\t\t\t\t\t\ttype: \"history\",\n\t\t\t\t\t\ttarget: \"zero\",\n\t\t\t\t\t},\n\t\t\t\t\tzero: {\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tNUMBER: {\n\t\t\t\t\t\t\t\ttarget: \"before_decimal_point\",\n\t\t\t\t\t\t\t\tactions: [\"setReadoutNum\"],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tDECIMAL_POINT: \"after_decimal_point\",\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tbefore_decimal_point: {\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tNUMBER: {\n\t\t\t\t\t\t\t\ttarget: \"before_decimal_point\",\n\t\t\t\t\t\t\t\tactions: [\"appendNumBeforeDecimal\"],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tDECIMAL_POINT: \"after_decimal_point\",\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tafter_decimal_point: {\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tNUMBER: {\n\t\t\t\t\t\t\t\ttarget: \"after_decimal_point\",\n\t\t\t\t\t\t\t\tactions: [\"appendNumAfterDecimal\"],\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\tnegative_number_2: {\n\t\t\t\ton: {\n\t\t\t\t\tNUMBER: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isZero\",\n\t\t\t\t\t\t\ttarget: \"operand2.zero\",\n\t\t\t\t\t\t\tactions: [\"defaultNegativeReadout\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isNotZero\",\n\t\t\t\t\t\t\ttarget: \"operand2.before_decimal_point\",\n\t\t\t\t\t\t\tactions: [\"setNegativeReadoutNum\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tDECIMAL_POINT: {\n\t\t\t\t\t\ttarget: \"operand2.after_decimal_point\",\n\t\t\t\t\t\tactions: [\"defaultNegativeReadout\"],\n\t\t\t\t\t},\n\t\t\t\t\tCLEAR_ENTRY: {\n\t\t\t\t\t\ttarget: \"operator_entered\",\n\t\t\t\t\t\tactions: [\"defaultReadout\"],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\tresult: {\n\t\t\t\ton: {\n\t\t\t\t\tNUMBER: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isZero\",\n\t\t\t\t\t\t\ttarget: \"operand1\",\n\t\t\t\t\t\t\tactions: [\"defaultReadout\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcond: \"isNotZero\",\n\t\t\t\t\t\t\ttarget: \"operand1.before_decimal_point\",\n\t\t\t\t\t\t\tactions: [\"setReadoutNum\"],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tPERCENTAGE: {\n\t\t\t\t\t\ttarget: \"result\",\n\t\t\t\t\t\tactions: [\"storeResultAsOperand2\", \"computePercentage\"],\n\t\t\t\t\t},\n\t\t\t\t\tOPERATOR: {\n\t\t\t\t\t\ttarget: \"operator_entered\",\n\t\t\t\t\t\tactions: [\"storeResultAsOperand1\", \"recordOperator\"],\n\t\t\t\t\t},\n\t\t\t\t\tCLEAR_ENTRY: {\n\t\t\t\t\t\ttarget: \"start\",\n\t\t\t\t\t\tactions: [\"defaultReadout\"],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\talert: {\n\t\t\t\ton: {\n\t\t\t\t\tOK: \"operand2.hist\",\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t},\n\t{\n\t\tguards: {\n\t\t\tisMinus,\n\t\t\tisNotMinus,\n\t\t\tisZero,\n\t\t\tisNotZero,\n\t\t\tnotDivideByZero,\n\t\t},\n\t\tactions: {\n\t\t\tdefaultReadout: assign({\n\t\t\t\tdisplay: () =\u003E \"0.\",\n\t\t\t}),\n\n\t\t\tdefaultNegativeReadout: assign({\n\t\t\t\tdisplay: () =\u003E \"-0.\",\n\t\t\t}),\n\n\t\t\tappendNumBeforeDecimal: assign({\n\t\t\t\tdisplay: (context, event) =\u003E\n\t\t\t\t\tcontext.display.slice(0, -1) + event.key + \".\",\n\t\t\t}),\n\n\t\t\tappendNumAfterDecimal: assign({\n\t\t\t\tdisplay: (context, event) =\u003E context.display + event.key,\n\t\t\t}),\n\n\t\t\tsetReadoutNum: assign({\n\t\t\t\tdisplay: (context, event) =\u003E event.key + \".\",\n\t\t\t}),\n\n\t\t\tsetNegativeReadoutNum: assign({\n\t\t\t\tdisplay: (context, event) =\u003E \"-\" + event.key + \".\",\n\t\t\t}),\n\n\t\t\tstartNegativeNumber: assign({\n\t\t\t\tdisplay: () =\u003E \"-\",\n\t\t\t}),\n\n\t\t\trecordOperator: assign({\n\t\t\t\toperand1: (context) =\u003E context.display,\n\t\t\t\toperator: (_, event) =\u003E event.operator,\n\t\t\t}),\n\n\t\t\tsetOperator: assign({\n\t\t\t\toperator: ({operator}) =\u003E operator,\n\t\t\t}),\n\n\t\t\tcomputePercentage: assign({\n\t\t\t\tdisplay: (context) =\u003E context.display \u002F 100,\n\t\t\t}),\n\n\t\t\tcompute: assign({\n\t\t\t\tdisplay: ({operand1, operand2, operator}) =\u003E\n\t\t\t\t\tdoMath(operand1, operand2, operator),\n\t\t\t}),\n\n\t\t\tstoreResultAsOperand1: assign({\n\t\t\t\toperand1: (context) =\u003E context.display,\n\t\t\t}),\n\n\t\t\tstoreResultAsOperand2: assign({\n\t\t\t\toperand2: (context) =\u003E context.display,\n\t\t\t}),\n\n\t\t\tdivideByZeroAlert() {\n\t\t\t\t\u002F\u002F have to put the alert in setTimeout because action is executed on event, before the transition to next state happens\n\t\t\t\t\u002F\u002F this alert is supposed to happend on transition\n\t\t\t\t\u002F\u002F setTimeout allows time for other state transition (to 'alert' state) to happen before showing the alert\n\t\t\t\t\u002F\u002F probably a better way to do it. like entry or exit actions\n\t\t\t\tsetTimeout(() =\u003E {\n\t\t\t\t\talert(\"Cannot divide by zero!\");\n\t\t\t\t\tthis.transition(\"OK\");\n\t\t\t\t}, 0);\n\t\t\t},\n\n\t\t\treset: assign({\n\t\t\t\tdisplay: () =\u003E \"0.\",\n\t\t\t\toperand1: () =\u003E null,\n\t\t\t\toperand2: () =\u003E null,\n\t\t\t\toperator: () =\u003E null,\n\t\t\t}),\n\t\t},\n\t},\n);\n\nconst buttonLabels = [\n\t\"C\",\n\t\"CE\",\n\t\"\u002F\",\n\t\"7\",\n\t\"8\",\n\t\"9\",\n\t\"x\",\n\t\"4\",\n\t\"5\",\n\t\"6\",\n\t\"-\",\n\t\"1\",\n\t\"2\",\n\t\"3\",\n\t\"+\",\n\t\"0\",\n\t\".\",\n\t\"=\",\n\t\"%\",\n];\n\nfunction isOperator(label: string): boolean {\n\treturn \"+-x\u002F\".indexOf(label) \u003E -1;\n}\n\nfunction buttonDescription(label: string): string {\n\tif (Number.isInteger(+label)) return `NUMBER ${label}`;\n\tif (isOperator(label)) return `OPERATOR ${label}`;\n\tif (label === \"C\") return \"CLEAR_EVERYTHING\";\n\tif (label === \"CE\") return \"CLEAR_ENTRY\";\n\tif (label === \".\") return \"DECIMAL_POINT\";\n\tif (label === \"%\") return \"PERCENTAGE\";\n\tif (label === \"=\") return \"EQUALS\";\n\treturn \"\";\n}\n\nfunction* Calculator(this: Context) {\n\tlet state = calcMachine.initialState;\n\tthis.addEventListener(\"click\", (el) =\u003E {\n\t\tif ((el.target as Element).tagName === \"BUTTON\") {\n\t\t\t\u002F\u002F TODO: could this be abstracted somehow :-)\n\t\t\tconst label = (el.target as Element).textContent!;\n\t\t\tif (Number.isInteger(+label)) {\n\t\t\t\tstate = calcMachine.transition(state, {type: \"NUMBER\", key: +label});\n\t\t\t} else if (isOperator(label)) {\n\t\t\t\tstate = calcMachine.transition(state, {\n\t\t\t\t\ttype: \"OPERATOR\",\n\t\t\t\t\toperator: label,\n\t\t\t\t});\n\t\t\t} else if (label === \"C\") {\n\t\t\t\tstate = calcMachine.transition(state, {type: \"CLEAR_EVERYTHING\"});\n\t\t\t} else if (label === \".\") {\n\t\t\t\tstate = calcMachine.transition(state, {type: \"DECIMAL_POINT\"});\n\t\t\t} else if (label === \"=\") {\n\t\t\t\tstate = calcMachine.transition(state, {type: \"EQUALS\"});\n\t\t\t} else if (label === \"%\") {\n\t\t\t\tstate = calcMachine.transition(state, {type: \"PERCENTAGE\"});\n\t\t\t} else if (label === \"CE\") {\n\t\t\t\tstate = calcMachine.transition(state, {type: \"CLEAR_ENTRY\"});\n\t\t\t}\n\t\t\tthis.refresh();\n\t\t}\n\t});\n\n\tfor ({} of this) {\n\t\tyield (\n\t\t\t\u003Cdiv id=\"app\"\u003E\n\t\t\t\t\u003Cdiv class=\"container\"\u003E\n\t\t\t\t\t\u003Cinput class=\"readout\" disabled value={state.context.display} \u002F\u003E\n\t\t\t\t\t\u003Cdiv class=\"button-grid\"\u003E\n\t\t\t\t\t\t{buttonLabels.map((b) =\u003E (\n\t\t\t\t\t\t\t\u003Cbutton\n\t\t\t\t\t\t\t\tclass={\"calc-button\" + (b === \"C\" ? \" two-span\" : \"\")}\n\t\t\t\t\t\t\t\ttitle={buttonDescription(b)}\n\t\t\t\t\t\t\t\u003E\n\t\t\t\t\t\t\t\t{b}\n\t\t\t\t\t\t\t\u003C\u002Fbutton\u003E\n\t\t\t\t\t\t))}\n\t\t\t\t\t\u003C\u002Fdiv\u003E\n\t\t\t\t\u003C\u002Fdiv\u003E\n\t\t\t\t{\u002F* Uncomment to debug\n        \u003Cdiv class=\"debug\"\u003E\n          \u003Clabel\u003EState:\u003C\u002Flabel\u003E\n          \u003Cpre\u003E\n            \u003Ccode\u003E{JSON.stringify(state.value, null, 2)}\u003C\u002Fcode\u003E\n          \u003C\u002Fpre\u003E\n          \u003Clabel\u003EContext:\u003C\u002Flabel\u003E\n          \u003Cpre\u003E\n            \u003Ccode\u003E{JSON.stringify(state.context, null, 2)}\u003C\u002Fcode\u003E\n          \u003C\u002Fpre\u003E\n        \u003C\u002Fdiv\u003E\n        *\u002F}\n\t\t\t\u003C\u002Fdiv\u003E\n\t\t);\n\t}\n}\n\nconst style = document.createElement(\"style\");\nstyle.textContent = `\n.container {\n  max-width: 300px;\n  margin: 0 auto;\n  border: 2px solid gray;\n  border-radius: 4px;\n  box-sizing: border-box;\n}\n.readout {\n  font-size: 32px;\n  color: #333;\n  text-align: right;\n  padding: 5px 13px;\n  width: 100%;\n  border: none;\n  border-bottom: 1px solid gray;\n  box-sizing: border-box;\n}\n.button-grid {\n  display: grid;\n  padding: 20px;\n  grid-template-columns: repeat(4, 1fr);\n  grid-gap: 15px;\n}\n.calc-button {\n  padding: 10px;\n  font-size: 22px;\n  color: #eee;\n  background: rgba(0, 0, 0, 0.5);\n  cursor: pointer;\n  border-radius: 2px;\n  border: 0;\n  outline: none;\n  opacity: 0.8;\n  transition: opacity 0.2s ease-in-out;\n}\n.calc-button:hover {\n  opacity: 1;\n}\n.calc-button:active {\n  background: #999;\n  box-shadow: inset 0 1px 4px rgba(0, 0, 0, 0.6);\n}\n.two-span {\n  grid-column: span 2;\n  background-color: #3572db;\n}\n`;\ndocument.head.appendChild(style);\n\nrenderer.render(\u003CCalculator \u002F\u003E, document.body);\n"},{"name":"wizard","label":"Form Wizard","code":"import {renderer} from \"@b9g\u002Fcrank\u002Fdom\";\n\nfunction* Wizard() {\n\tlet step = 0;\n\tconst formData = new FormData();\n\tthis.addEventListener(\"submit\", (ev) =\u003E {\n\t\tconst isValid = ev.target.reportValidity();\n\t\tif (isValid) {\n\t\t\tev.preventDefault();\n\t\t\tconst data = new FormData(ev.target);\n\t\t\tfor (const [key, value] of data) {\n\t\t\t\tformData.append(key, value);\n\t\t\t}\n\n\t\t\t\u002F\u002F Code to handle form submission\n\t\t\tthis.refresh(() =\u003E step++);\n\t\t}\n\t});\n\n\tfor ({} of this) {\n\t\tyield (\n\t\t\t\u003Cform key={step}\u003E\n\t\t\t\t{step === 0 ? (\n\t\t\t\t\t\u003C\u003E\n\t\t\t\t\t\t\u003Clabel for=\"name\"\u003EName:\u003C\u002Flabel\u003E\n\t\t\t\t\t\t\u003Cbr \u002F\u003E\n\t\t\t\t\t\t\u003Cinput name=\"name\" type=\"text\" required \u002F\u003E\n\t\t\t\t\t\t\u003Cbr \u002F\u003E\n\t\t\t\t\t\t\u003Clabel for=\"email\"\u003EEmail:\u003C\u002Flabel\u003E\n\t\t\t\t\t\t\u003Cbr \u002F\u003E\n\t\t\t\t\t\t\u003Cinput name=\"email\" type=\"email\" required \u002F\u003E\n\t\t\t\t\t\t\u003Cbr \u002F\u003E\n\t\t\t\t\t\t\u003Cbr \u002F\u003E\n\t\t\t\t\t\t\u003Cbutton type=\"submit\"\u003ENext\u003C\u002Fbutton\u003E\n\t\t\t\t\t\u003C\u002F\u003E\n\t\t\t\t) : step === 1 ? (\n\t\t\t\t\t\u003C\u003E\n\t\t\t\t\t\t\u003Clabel for=\"profile\"\u003EProfile:\u003C\u002Flabel\u003E\n\t\t\t\t\t\t\u003Cbr \u002F\u003E\n\t\t\t\t\t\t\u003Ctextarea name=\"profile\" required \u002F\u003E\n\t\t\t\t\t\t\u003Cbr \u002F\u003E\n\t\t\t\t\t\t\u003Clabel for=\"avatar\"\u003EAvatar:\u003C\u002Flabel\u003E\n\t\t\t\t\t\t\u003Cbr \u002F\u003E\n\t\t\t\t\t\t\u003Cinput name=\"avatar\" type=\"file\" \u002F\u003E\n\t\t\t\t\t\t\u003Cbr \u002F\u003E\n\t\t\t\t\t\t\u003Cbr \u002F\u003E\n\t\t\t\t\t\t\u003Cbutton type=\"submit\"\u003ESubmit\u003C\u002Fbutton\u003E\n\t\t\t\t\t\u003C\u002F\u003E\n\t\t\t\t) : (\n\t\t\t\t\t\u003Cpre\u003E{JSON.stringify(Object.fromEntries(formData), null, 2)}\u003C\u002Fpre\u003E\n\t\t\t\t)}\n\t\t\t\u003C\u002Fform\u003E\n\t\t);\n\t}\n}\n\nrenderer.render(\u003CWizard \u002F\u003E, document.body);\n"}];
		</script><script src="/static/playground-AHR4TP2W.js" type="module"></script><script data-name="static-urls-10" id="static-urls">
			if (window.__embeddedJSON__ == null) {
				window.__embeddedJSON__ = {};
			}
			window.__embeddedJSON__['static-urls-10'] = {"@b9g\u002Fcrank":"\u002Fstatic\u002Fcrank-ESBVX7GV.js","@b9g\u002Fcrank.js":"\u002Fstatic\u002Fcrank-ESBVX7GV.js","@b9g\u002Fcrank\u002Fasync":"\u002Fstatic\u002Fasync-CGDMGMUQ.js","@b9g\u002Fcrank\u002Fasync.js":"\u002Fstatic\u002Fasync-CGDMGMUQ.js","@b9g\u002Fcrank\u002Fcrank":"\u002Fstatic\u002Fcrank-ESBVX7GV.js","@b9g\u002Fcrank\u002Fcrank.js":"\u002Fstatic\u002Fcrank-ESBVX7GV.js","@b9g\u002Fcrank\u002Fdom":"\u002Fstatic\u002Fdom-2ZE6YNF6.js","@b9g\u002Fcrank\u002Fdom.js":"\u002Fstatic\u002Fdom-2ZE6YNF6.js","@b9g\u002Fcrank\u002Fevent-target":"\u002Fstatic\u002Fevent-target-K6L2AQDD.js","@b9g\u002Fcrank\u002Fevent-target.js":"\u002Fstatic\u002Fevent-target-K6L2AQDD.js","@b9g\u002Fcrank\u002Fhtml":"\u002Fstatic\u002Fhtml-4XAEMDNI.js","@b9g\u002Fcrank\u002Fhtml.js":"\u002Fstatic\u002Fhtml-4XAEMDNI.js","@b9g\u002Fcrank\u002Fjsx-dev-runtime":"\u002Fstatic\u002Fjsx-runtime-VTCZGTQU.js","@b9g\u002Fcrank\u002Fjsx-dev-runtime.js":"\u002Fstatic\u002Fjsx-runtime-VTCZGTQU.js","@b9g\u002Fcrank\u002Fjsx-runtime":"\u002Fstatic\u002Fjsx-runtime-VTCZGTQU.js","@b9g\u002Fcrank\u002Fjsx-runtime.js":"\u002Fstatic\u002Fjsx-runtime-VTCZGTQU.js","@b9g\u002Fcrank\u002Fjsx-tag":"\u002Fstatic\u002Fjsx-tag-VPNOE4JP.js","@b9g\u002Fcrank\u002Fjsx-tag.js":"\u002Fstatic\u002Fjsx-tag-VPNOE4JP.js","@b9g\u002Fcrank\u002Fstandalone":"\u002Fstatic\u002Fstandalone-FJ3E2LNJ.js","@b9g\u002Fcrank\u002Fstandalone.js":"\u002Fstatic\u002Fstandalone-FJ3E2LNJ.js","client.css":"\u002Fstatic\u002Fclient-PG5TN3NC.css"};
		</script><script src="/static/navbar-MBN6NLBG.js"></script><script src="/static/code-blocks-VAVPFCJ2.js"></script></body></html>